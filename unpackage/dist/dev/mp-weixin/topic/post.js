(global["webpackJsonp"] = global["webpackJsonp"] || []).push([["topic/post"],{

/***/ 665:
/*!***********************************************************************!*\
  !*** E:/wamp/www/hi-hupai-wechat-pro/main.js?{"page":"topic%2Fpost"} ***!
  \***********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(createPage) {__webpack_require__(/*! uni-pages */ 4);
var _vue = _interopRequireDefault(__webpack_require__(/*! vue */ 2));
var _post = _interopRequireDefault(__webpack_require__(/*! ./topic/post.vue */ 666));function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}
createPage(_post.default);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 1)["createPage"]))

/***/ }),

/***/ 666:
/*!******************************************************!*\
  !*** E:/wamp/www/hi-hupai-wechat-pro/topic/post.vue ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _post_vue_vue_type_template_id_24ed4ce4_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./post.vue?vue&type=template&id=24ed4ce4&scoped=true& */ 667);
/* harmony import */ var _post_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./post.vue?vue&type=script&lang=js& */ 669);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _post_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _post_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _post_vue_vue_type_style_index_0_id_24ed4ce4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./post.vue?vue&type=style&index=0&id=24ed4ce4&lang=scss&scoped=true& */ 671);
/* harmony import */ var _G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */ 15);

var renderjs





/* normalize component */

var component = Object(_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__["default"])(
  _post_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _post_vue_vue_type_template_id_24ed4ce4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"],
  _post_vue_vue_type_template_id_24ed4ce4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  "24ed4ce4",
  null,
  false,
  _post_vue_vue_type_template_id_24ed4ce4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["components"],
  renderjs
)

component.options.__file = "topic/post.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ 667:
/*!*************************************************************************************************!*\
  !*** E:/wamp/www/hi-hupai-wechat-pro/topic/post.vue?vue&type=template&id=24ed4ce4&scoped=true& ***!
  \*************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_template_id_24ed4ce4_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./post.vue?vue&type=template&id=24ed4ce4&scoped=true& */ 668);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_template_id_24ed4ce4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_template_id_24ed4ce4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return _G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_template_id_24ed4ce4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["recyclableRender"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "components", function() { return _G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_template_id_24ed4ce4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["components"]; });



/***/ }),

/***/ 668:
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/wamp/www/hi-hupai-wechat-pro/topic/post.vue?vue&type=template&id=24ed4ce4&scoped=true& ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return recyclableRender; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "components", function() { return components; });
var components
try {
  components = {
    quiPage: function() {
      return Promise.all(/*! import() | components/qui-page/qui-page */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-page/qui-page")]).then(__webpack_require__.bind(null, /*! @/components/qui-page/qui-page.vue */ 682))
    },
    quiCellItem: function() {
      return __webpack_require__.e(/*! import() | components/qui-cell-item/qui-cell-item */ "components/qui-cell-item/qui-cell-item").then(__webpack_require__.bind(null, /*! @/components/qui-cell-item/qui-cell-item.vue */ 738))
    },
    quiAvatar: function() {
      return Promise.all(/*! import() | components/qui-avatar/qui-avatar */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-avatar/qui-avatar")]).then(__webpack_require__.bind(null, /*! @/components/qui-avatar/qui-avatar.vue */ 840))
    },
    quiIcon: function() {
      return __webpack_require__.e(/*! import() | components/qui-icon/qui-icon */ "components/qui-icon/qui-icon").then(__webpack_require__.bind(null, /*! @/components/qui-icon/qui-icon.vue */ 766))
    },
    quiEmoji: function() {
      return __webpack_require__.e(/*! import() | components/qui-emoji/qui-emoji */ "components/qui-emoji/qui-emoji").then(__webpack_require__.bind(null, /*! @/components/qui-emoji/qui-emoji.vue */ 869))
    },
    quiUploader: function() {
      return Promise.all(/*! import() | components/qui-uploader/qui-uploader */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-uploader/qui-uploader")]).then(__webpack_require__.bind(null, /*! @/components/qui-uploader/qui-uploader.vue */ 876))
    },
    quiUploadFile: function() {
      return __webpack_require__.e(/*! import() | components/qui-upload-file/qui-upload-file */ "components/qui-upload-file/qui-upload-file").then(__webpack_require__.bind(null, /*! @/components/qui-upload-file/qui-upload-file.vue */ 1002))
    },
    quiUploadVideo: function() {
      return Promise.all(/*! import() | components/qui-upload-video/qui-upload-video */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-upload-video/qui-upload-video")]).then(__webpack_require__.bind(null, /*! @/components/qui-upload-video/qui-upload-video.vue */ 1009))
    },
    quiUploadAudio: function() {
      return Promise.all(/*! import() | components/qui-upload-audio/qui-upload-audio */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-upload-audio/qui-upload-audio")]).then(__webpack_require__.bind(null, /*! @/components/qui-upload-audio/qui-upload-audio.vue */ 1017))
    },
    uSwitch: function() {
      return __webpack_require__.e(/*! import() | components/u-switch/u-switch */ "components/u-switch/u-switch").then(__webpack_require__.bind(null, /*! @/components/u-switch/u-switch.vue */ 1026))
    },
    quiButton: function() {
      return __webpack_require__.e(/*! import() | components/qui-button/qui-button */ "components/qui-button/qui-button").then(__webpack_require__.bind(null, /*! @/components/qui-button/qui-button.vue */ 812))
    },
    quiPay: function() {
      return Promise.all(/*! import() | components/qui-pay/qui-pay */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-pay/qui-pay")]).then(__webpack_require__.bind(null, /*! @/components/qui-pay/qui-pay.vue */ 752))
    },
    uniPopup: function() {
      return __webpack_require__.e(/*! import() | components/uni-popup/uni-popup */ "components/uni-popup/uni-popup").then(__webpack_require__.bind(null, /*! @/components/uni-popup/uni-popup.vue */ 724))
    },
    quiToast: function() {
      return __webpack_require__.e(/*! import() | components/qui-toast/qui-toast */ "components/qui-toast/qui-toast").then(__webpack_require__.bind(null, /*! @/components/qui-toast/qui-toast.vue */ 745))
    },
    quiLoadingCover: function() {
      return __webpack_require__.e(/*! import() | components/qui-loading-cover/qui-loading-cover */ "components/qui-loading-cover/qui-loading-cover").then(__webpack_require__.bind(null, /*! @/components/qui-loading-cover/qui-loading-cover.vue */ 759))
    }
  }
} catch (e) {
  if (
    e.message.indexOf("Cannot find module") !== -1 &&
    e.message.indexOf(".vue") !== -1
  ) {
    console.error(e.message)
    console.error("1. 排查组件名称拼写是否正确")
    console.error(
      "2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"
    )
    console.error(
      "3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件"
    )
  } else {
    throw e
  }
}
var render = function() {
  var _vm = this
  var _h = _vm.$createElement
  var _c = _vm._self._c || _h
  var g0 =
    _vm.loadStatus && _vm.type === 1 && _vm.type === 1
      ? _vm.i18n.t("discuzq.post.pleaseEnterAPostTitle")
      : null
  var g1 =
    _vm.loadStatus && _vm.type === 5 && _vm.type === 5
      ? _vm.i18n.t("discuzq.post.askedUsers")
      : null
  var g2 =
    _vm.loadStatus &&
    _vm.type !== 5 &&
    _vm.textAreaValue.length <= _vm.textAreaLength
      ? _vm.i18n.t("discuzq.post.note", {
          num: _vm.textAreaLength - _vm.textAreaValue.length
        })
      : null
  var g3 =
    _vm.loadStatus &&
    _vm.type !== 5 &&
    !(_vm.textAreaValue.length <= _vm.textAreaLength)
      ? _vm.i18n.t("discuzq.post.exceed", {
          num: _vm.textAreaValue.length - _vm.textAreaLength
        })
      : null
  var g4 =
    _vm.loadStatus &&
    _vm.type === 5 &&
    _vm.textAreaValue.length <= _vm.textAreaLength
      ? _vm.i18n.t("discuzq.post.note", {
          num: _vm.textAreaLength - _vm.textAreaValue.length
        })
      : null
  var g5 =
    _vm.loadStatus &&
    _vm.type === 5 &&
    !(_vm.textAreaValue.length <= _vm.textAreaLength)
      ? _vm.i18n.t("discuzq.post.exceed", {
          num: _vm.textAreaValue.length - _vm.textAreaLength
        })
      : null
  var g6 =
    _vm.loadStatus && _vm.type !== 5
      ? _vm.i18n.t("discuzq.post.placeholder")
      : null
  var g7 =
    _vm.loadStatus && !(_vm.type !== 5)
      ? _vm.i18n.t("discuzq.post.placeholderQuestion")
      : null
  var g8 =
    _vm.loadStatus &&
    _vm.type === 1 &&
    _vm.forums.other &&
    _vm.forums.other.can_create_thread_paid &&
    _vm.ioshide
      ? _vm.i18n.t("discuzq.post.lookPay")
      : null
  var g9 =
    _vm.loadStatus &&
    _vm.type === 1 &&
    _vm.type !== 0 &&
    _vm.showHidden &&
    _vm.forums.paycenter &&
    _vm.forums.paycenter.wxpay_close &&
    _vm.payType !== 0 &&
    _vm.forums.other.can_create_thread_paid &&
    _vm.ioshide
      ? _vm.i18n.t("discuzq.post.paymentAmount")
      : null
  var g10 =
    _vm.loadStatus &&
    !(_vm.type === 1) &&
    _vm.type !== 0 &&
    _vm.type !== 5 &&
    _vm.type !== 6 &&
    _vm.forums.other.can_create_thread_paid &&
    _vm.ioshide &&
    _vm.type !== 0 &&
    _vm.showHidden &&
    _vm.forums.paycenter.wxpay_close &&
    _vm.forums.other.can_create_thread_paid &&
    _vm.ioshide &&
    _vm.type === 4
      ? _vm.i18n.t("discuzq.post.payByListeningToAudio")
      : null
  var g11 =
    _vm.loadStatus &&
    !(_vm.type === 1) &&
    _vm.type !== 0 &&
    _vm.type !== 5 &&
    _vm.type !== 6 &&
    _vm.forums.other.can_create_thread_paid &&
    _vm.ioshide &&
    _vm.type !== 0 &&
    _vm.showHidden &&
    _vm.forums.paycenter.wxpay_close &&
    _vm.forums.other.can_create_thread_paid &&
    _vm.ioshide &&
    !(_vm.type === 4)
      ? _vm.i18n.t("discuzq.post.paymentAmount")
      : null
  var g12 =
    _vm.loadStatus && _vm.type === 5
      ? _vm.i18n.t("discuzq.post.anonymousQuestions")
      : null
  var g13 =
    _vm.loadStatus &&
    _vm.type === 5 &&
    _vm.forums.other &&
    _vm.forums.other.can_be_onlooker
      ? _vm.i18n.t("discuzq.post.otherPay")
      : null
  var g14 =
    _vm.loadStatus &&
    _vm.type === 5 &&
    _vm.forums.other &&
    _vm.forums.other.can_be_onlooker
      ? _vm.i18n.t("discuzq.post.youHaveTo")
      : null
  var g15 =
    _vm.loadStatus &&
    _vm.type === 5 &&
    _vm.forums.other &&
    _vm.forums.other.can_be_onlooker
      ? _vm.i18n.t("discuzq.post.yuan")
      : null
  var g16 =
    _vm.loadStatus &&
    _vm.type === 5 &&
    _vm.forums.other &&
    _vm.forums.other.can_be_onlooker
      ? _vm.i18n.t("discuzq.post.theAnswerIs")
      : null
  var g17 =
    _vm.loadStatus &&
    _vm.type === 5 &&
    _vm.forums.other &&
    _vm.forums.other.can_be_onlooker
      ? _vm.i18n.t("discuzq.post.yuan")
      : null
  var g18 =
    _vm.loadStatus &&
    _vm.type === 5 &&
    _vm.forums.other &&
    _vm.forums.other.can_be_onlooker
      ? _vm.i18n.t("discuzq.post.platform")
      : null
  var g19 =
    _vm.loadStatus &&
    _vm.type === 5 &&
    _vm.forums.other &&
    _vm.forums.other.can_be_onlooker
      ? _vm.i18n.t("discuzq.post.yuan")
      : null
  var g20 =
    _vm.loadStatus &&
    _vm.price > 0 &&
    _vm.type !== 3 &&
    _vm.type !== 2 &&
    _vm.type !== 0 &&
    _vm.type !== 4 &&
    _vm.type !== 5 &&
    _vm.payType !== 1 &&
    _vm.payType !== 0
      ? _vm.i18n.t("discuzq.post.freeWordCount")
      : null
  var g21 =
    _vm.loadStatus &&
    _vm.price > 0 &&
    _vm.type !== 3 &&
    _vm.type !== 2 &&
    _vm.type !== 0 &&
    _vm.type !== 4 &&
    _vm.type !== 5 &&
    _vm.payType !== 1 &&
    _vm.payType !== 0
      ? _vm.i18n.t("discuzq.post.word", {
          num: _vm.percentagedisplay
        })
      : null
  var g22 =
    _vm.loadStatus &&
    _vm.forums.lbs &&
    _vm.forums.lbs.lbs &&
    !(_vm.currentPosition && _vm.currentPosition.location)
      ? _vm.i18n.t("discuzq.post.addPosition")
      : null
  var g23 = _vm.loadStatus ? _vm.i18n.t("discuzq.post.chooseCategory") : null
  var m1 = Number(_vm.categoryId)
  var m3 = Number(_vm.categoryId)
  var m5 = Number(_vm.categoryId)
  var l0 = _vm.loadStatus
    ? _vm.__map(_vm.allCategories, function(item, index) {
        var $orig = _vm.__get_orig(item)

        var m0 = Number(item._jv.id)
        var m2 = Number(item._jv.id)
        var m4 = Number(item._jv.id)
        return {
          $orig: $orig,
          m0: m0,
          m2: m2,
          m4: m4
        }
      })
    : null
  var g24 =
    _vm.loadStatus &&
    (_vm.type !== 5 ||
      (_vm.type === 5 &&
        _vm.forums.other &&
        _vm.forums.other.can_create_thread_paid === false))
      ? _vm.i18n.t("discuzq.post.post")
      : null
  var g25 =
    _vm.loadStatus &&
    _vm.type === 5 &&
    _vm.forums.other &&
    _vm.forums.other.can_create_thread_paid
      ? _vm.i18n.t("discuzq.post.nextPay")
      : null
  var m6 =
    _vm.loadStatus && _vm.payShowStatus ? Number(_vm.user.walletBalance) : null
  var g26 = _vm.loadStatus
    ? _vm.i18n.t("discuzq.post.TheContentAndTheAccessoriesIsFree")
    : null
  var g27 =
    _vm.loadStatus && _vm.type === 1 && _vm.canUploadAttachment
      ? _vm.i18n.t("discuzq.post.TheContentIsFreeAndTheAccessoriesArePaid")
      : null
  var g28 = _vm.loadStatus
    ? _vm.i18n.t("discuzq.post.TheContentAndTheAccessoriesIsPaid")
    : null
  var g29 = _vm.loadStatus ? _vm.i18n.t("discuzq.post.cancel") : null
  var g30 =
    _vm.loadStatus && _vm.type !== 5 && _vm.setType === "pay"
      ? _vm.i18n.t("discuzq.post.selectToViewPaymentAmount")
      : null
  var g31 =
    _vm.loadStatus && _vm.type !== 5 && !(_vm.setType === "pay")
      ? _vm.i18n.t("discuzq.post.selectToViewFreeWordCount")
      : null
  var g32 =
    _vm.loadStatus && _vm.setType === "pay" && _vm.type === 5
      ? _vm.i18n.t("discuzq.post.supportTheAuthorToContinueToCreate")
      : null
  var g33 = _vm.loadStatus ? _vm.i18n.t("discuzq.post.cancel") : null
  var g34 =
    _vm.loadStatus && _vm.popupStatus && _vm.setType === "pay"
      ? _vm.i18n.t("discuzq.post.enterToViewPaymentAmount")
      : null
  var g35 =
    _vm.loadStatus && _vm.popupStatus && !(_vm.setType === "pay")
      ? _vm.i18n.t("discuzq.post.enterTheWordCount")
      : null
  var g36 =
    _vm.loadStatus && _vm.popupStatus && !(_vm.setType === "pay")
      ? _vm.i18n.t("discuzq.post.word", {
          num: ""
        })
      : null
  var g37 =
    _vm.loadStatus && _vm.popupStatus ? _vm.i18n.t("discuzq.close") : null
  var g38 =
    _vm.loadStatus && _vm.popupStatus && _vm.setType === "pay"
      ? _vm.i18n.t("discuzq.ok")
      : null
  var g39 =
    _vm.loadStatus && _vm.popupStatus && !(_vm.setType === "pay")
      ? _vm.i18n.t("discuzq.ok")
      : null
  _vm.$mp.data = Object.assign(
    {},
    {
      $root: {
        g0: g0,
        g1: g1,
        g2: g2,
        g3: g3,
        g4: g4,
        g5: g5,
        g6: g6,
        g7: g7,
        g8: g8,
        g9: g9,
        g10: g10,
        g11: g11,
        g12: g12,
        g13: g13,
        g14: g14,
        g15: g15,
        g16: g16,
        g17: g17,
        g18: g18,
        g19: g19,
        g20: g20,
        g21: g21,
        g22: g22,
        g23: g23,
        m1: m1,
        m3: m3,
        m5: m5,
        l0: l0,
        g24: g24,
        g25: g25,
        m6: m6,
        g26: g26,
        g27: g27,
        g28: g28,
        g29: g29,
        g30: g30,
        g31: g31,
        g32: g32,
        g33: g33,
        g34: g34,
        g35: g35,
        g36: g36,
        g37: g37,
        g38: g38,
        g39: g39
      }
    }
  )
}
var recyclableRender = false
var staticRenderFns = []
render._withStripped = true



/***/ }),

/***/ 669:
/*!*******************************************************************************!*\
  !*** E:/wamp/www/hi-hupai-wechat-pro/topic/post.vue?vue&type=script&lang=js& ***!
  \*******************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _G_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./post.vue?vue&type=script&lang=js& */ 670);
/* harmony import */ var _G_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_G_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _G_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _G_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_G_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 670:
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/wamp/www/hi-hupai-wechat-pro/topic/post.vue?vue&type=script&lang=js& ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(uni) {Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _regenerator = _interopRequireDefault(__webpack_require__(/*! ./node_modules/@babel/runtime/regenerator */ 8));













































































































































































































































































































































































































































































































































































































































































































































var _vuex = __webpack_require__(/*! vuex */ 21);
var _const = __webpack_require__(/*! @/common/const */ 12);

var _forums = _interopRequireDefault(__webpack_require__(/*! @/mixin/forums */ 144));
var _user = _interopRequireDefault(__webpack_require__(/*! @/mixin/user */ 145));
var _loginModule = _interopRequireDefault(__webpack_require__(/*! @/mixin/loginModule */ 147));var _objectSpread2;function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {try {var info = gen[key](arg);var value = info.value;} catch (error) {reject(error);return;}if (info.done) {resolve(value);} else {Promise.resolve(value).then(_next, _throw);}}function _asyncToGenerator(fn) {return function () {var self = this,args = arguments;return new Promise(function (resolve, reject) {var gen = fn.apply(self, args);function _next(value) {asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value);}function _throw(err) {asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err);}_next(undefined);});};}function ownKeys(object, enumerableOnly) {var keys = Object.keys(object);if (Object.getOwnPropertySymbols) {var symbols = Object.getOwnPropertySymbols(object);if (enumerableOnly) symbols = symbols.filter(function (sym) {return Object.getOwnPropertyDescriptor(object, sym).enumerable;});keys.push.apply(keys, symbols);}return keys;}function _objectSpread(target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i] != null ? arguments[i] : {};if (i % 2) {ownKeys(Object(source), true).forEach(function (key) {_defineProperty(target, key, source[key]);});} else if (Object.getOwnPropertyDescriptors) {Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));} else {ownKeys(Object(source)).forEach(function (key) {Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));});}}return target;}function _defineProperty(obj, key, value) {if (key in obj) {Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });} else {obj[key] = value;}return obj;}var uniPopupDialog = function uniPopupDialog() {__webpack_require__.e(/*! require.ensure | components/uni-popup/uni-popup-dialog */ "components/uni-popup/uni-popup-dialog").then((function () {return resolve(__webpack_require__(/*! @/components/uni-popup/uni-popup-dialog */ 773));}).bind(null, __webpack_require__)).catch(__webpack_require__.oe);};








// 小程序与h5支付setInterval
var payWechat = null;
var payPhone = null;var _default =
{
  name: 'Post',
  components: { uniPopupDialog: uniPopupDialog },
  mixins: [
  _forums.default,
  _user.default,
  _loginModule.default],






  data: function data() {
    return {
      vditor: null,
      navTitle: '发布', // 导航栏标题
      loadStatus: '',
      textAreaValue: '', // 输入框内容
      markdownShow: false, // 是否显示markdown菜单
      barStatus: false, // 是否显示输入框获取焦点时完成的那一栏
      textAreaLength: 5000, // 输入框可输入字
      textAnswerLength: 49999, // 问答输入框可输入字
      postTitle: '', // 标题
      checkClassData: [],
      type: 0, // 帖子类型
      price: 0, // 付费金额
      priceAsk: 0, // 提问价格
      pwdVal: '', // 提问价格的支付密码
      browser: 0, // 是不是浏览器
      inputPrice: '', // 付费金额输入框
      maxLength: 7, // 输入框长度
      inputWord: '', // 查看字数输入框
      operating: '', // 编辑或发布类型
      emojiShow: false, // 表情是否显示
      textShow: true, // 文本域是否显示
      header: {}, // 图片请求头部
      formData: {}, // 图片请求data
      captcha: null, // 腾讯云验证码实例
      captcha_ticket: '', // 腾讯云验证码返回票据
      captcha_rand_str: '', // 腾讯云验证码返回随机字符串
      userImage: '', // 被提问用户的头像
      beUserName: '', // 被提问用户的用户名
      checked: false, // 是否匿名
      watchChecked: false, // 他人围观
      watchShow: false, // 是否显示他人围观
      payShowStatus: true, // 是否显示支付
      haveDate: 0, // 你得
      answerIsDate: 0, // 回答者得
      platformDate: 0, // 平台得
      askingPrice: true, // 显示提问价格
      payNum: [
      {
        name: this.i18n.t('discuzq.post.TheContentAndTheAccessoriesIsFree'),
        pay: 0 },

      {
        name: '￥2',
        pay: 2 },

      {
        name: '￥5',
        pay: 5 },

      {
        name: '￥10',
        pay: 10 },

      {
        name: '￥20',
        pay: 20 },

      {
        name: '￥50',
        pay: 50 },

      {
        name: '￥88',
        pay: 88 },

      {
        name: '￥128',
        pay: 128 },

      {
        name: this.i18n.t('discuzq.post.customize'),
        pay: 0 }],

      // 付费金额
      payNumCheck: [
      {
        name: '',
        pay: 0 }],

      // 付费金额选中
      freepercentage: [
      {
        name: '0%',
        pay: 0 },

      {
        name: '10%',
        pay: 0.1 },

      {
        name: '30%',
        pay: 0.3 },

      {
        name: '50%',
        pay: 0.5 },

      {
        name: '70%',
        pay: 0.7 },

      {
        name: '100%',
        pay: 1 }],


      freewords: [], // 免费字数选中
      percentagedisplay: '0%',
      uploadFile: [], // 图片上传列表
      cursor: 0, // 内容输入框光标未知
      wordCountCheck: [
      {
        name: this.i18n.t('discuzq.post.word', { num: 0 }),
        num: 0 }],

      // 查看字数选中
      word: 0, // 可查看字数
      setType: 'pay', // 金额或查看字
      controlsStatus: false, // 是否显示默认播放控件
      videoBeforeList: [], // 视频上传列表
      audioBeforeList: [], // 语音上传列表
      fullscreenStatus: false, // 视频全屏状态
      videoName: '', // 视频名称
      percent: 0, // 视频上传进度
      // videoPercent: 0, // 视频上传进度，用来控制进度条
      fileId: '', // 视频ID
      url: '', // 视频url
      postLoading: false, // 发布按钮loading状态
      allCategories: [], // 所有分类
      categoryIndex: '', // 分类下标
      categoryId: '', // 分类id
      threadId: '', // 编辑时主题id
      firstPostId: '', // 编辑时帖子id
      postDetails: {}, // 编辑时帖子详情
      filePreview: [], // 服务器上传
      uploadStatus: true, // 图片上传状态
      showHidden: true, // 付费金额的显示隐藏
      ticket: '',
      randstr: '',
      captchaResult: {},
      attachmentList: [], // 附件列表
      signatureVal: '',
      deleteType: '', // 删除类型 0为图片，1为附件，2为视频
      deleteId: '', // 当前点击要删除的图片Id
      deleteIndex: '', // 当前点击要删除的图片index
      deleteTip: '确定删除吗？', // 删除提示
      wechatTip: this.i18n.t('discuzq.wechatBind'), // 微信绑定提示
      currentPosition: {},
      watchMoeny: '1', // 他人付费需付费多少元
      beAskId: '', // 被提问人ID
      payTypeText: '', // 支付提问价格文案
      orderSn: '', // 提问支付订单号
      coverLoading: false, // 提问支付遮罩层
      payStatus: false, // 订单支付状态
      payTypeData: [
      {
        name: '微信支付',
        icon: 'icon-wxPay',
        color: '#09bb07',
        value: '0' },

      {
        name: '钱包支付',
        icon: 'icon-walletPay',
        color: '#1878f3',
        value: '1' }],

      // 支付方式
      chooseType: 1, // 视频是从首页上传的还是从发布页上传的
      payType: 0, //  查看付费的方式，  0均免费， 1内容免费，附件付费，  2内容和附件都付费
      showPayType: '', // 选择的支付方式
      ioshide: false, // ios下付费隐藏
      isShowGoods: true,
      dataGoodInfo: {},
      dataGoodInfoPrice: 0, // 商品价格
      goodsId: '', // 商品ID
      categoryid: 0,
      categoryindex: 0,
      postShow: false,
      popupStatus: false, // 这是自定义金额或者自定义字数弹框显示状态
      canUploadAttachment: false // 用户上传附件权限
    };
  },
  computed: _objectSpread(_objectSpread({},
  (0, _vuex.mapState)({
    getAtMemberData: function getAtMemberData(state) {return state.atMember.atMemberData;} })), {}, {

    showPrice: function showPrice() {
      var pay = '';
      // let pay = this.i18n.t('discuzq.post.free');
      if (this.type === 1) {
        pay = this.i18n.t('discuzq.post.pleaseChoice');
      } else {
        pay = this.i18n.t('discuzq.post.free');
      }

      if (this.price <= 0) {
        if (this.type === 1) {
          pay = this.i18n.t('discuzq.post.pleaseChoice');
        } else {
          pay = this.i18n.t('discuzq.post.free');
        }
        // pay = this.i18n.t('discuzq.post.free');
      } else {
        pay = "\uFFE5".concat(this.price + this.i18n.t('discuzq.post.yuan'));
      }
      return pay;
    },
    showAskPrice: function showAskPrice() {
      var payAsk = this.i18n.t('discuzq.post.free');
      if (this.priceAsk <= 0) {
        payAsk = this.i18n.t('discuzq.post.free');
      } else {
        payAsk = "\uFFE5".concat(this.priceAsk + this.i18n.t('discuzq.post.yuan'));
      }
      return payAsk;
    },
    currentLoginId: function currentLoginId() {
      var userId = this.$store.getters['session/get']('userId');
      return parseInt(userId, 10);
    }
    // goodInfo() {
    //   const data = this.$store.getters['session/get']('good');
    //   // this.dataGoodInfo = data;
    //   console.log('取商品信息', data);
    //   if (data && data._jv) {
    //     return data;
    //   }
    //   return {};
    // },
  }),
  updated: function updated() {var _this2 = this;
    if (this.forums && this.type === 5) {
      this.platformDate = (
      this.forums.set_site.site_onlooker_price * (
      this.forums.set_site.site_master_scale / 10)).
      toFixed(2);
      this.haveDate = ((this.forums.set_site.site_onlooker_price - this.platformDate) / 2).toFixed(
      2);

      this.answerIsDate = (
      this.forums.set_site.site_onlooker_price -
      this.platformDate -
      this.haveDate).
      toFixed(2);
    }








    uni.$on('uploadVideoOver', function (data) {
      // console.log('这是计算周期里获取到的上传后的数据', data);
      _this2.percent = 1;
      if (data.doneResult) {
        _this2.fileId = data.doneResult.fileId;
      }
      if (data.result) {
        _this2.fileId = data.result.fileId;
      }
    });
  },
  methods: _objectSpread(_objectSpread({
    addGoods: function addGoods() {
      if (this.operating === 'edit') {
        uni.redirectTo({
          url: "/pages/topic/parse-goods?type=".concat(this.type, "&operating=edit&threadId=").concat(this.threadId) });

      } else {
        uni.redirectTo({
          url: "/pages/topic/parse-goods?type=".concat(this.type) });

      }
    },
    deleteGoods: function deleteGoods() {
      this.dataGoodInfo = [];
      this.isShowGoods = false;
    },
    // 允许围观
    changeCheck: function changeCheck() {
      // this.checked !== this.checked;
    },
    choosePosition: function choosePosition() {
      var that = this;
      if (that.currentPosition.location) {
        return;
      }





      uni.getSetting({
        success: function success(res) {
          if (!res.authSetting['scope.userLocation']) {
            uni.authorize({
              scope: 'scope.userLocation',
              success: function success() {
                uni.chooseLocation({
                  success: function success(res1) {
                    var positionData = res1;
                    positionData.location = res1.name;
                    that.currentPosition = positionData;
                  } });

              } });

          } else {
            uni.chooseLocation({
              success: function success(res1) {
                var positionData = res1;
                positionData.location = res1.name;
                that.currentPosition = positionData;
              } });

          }
        } });


    },
    clearPosition: function clearPosition() {
      this.currentPosition = {};
    },
    // 暂存帖子信息，以防选完地址回来页面刷新后丢失
    saveThread: function saveThread() {var _this3 = this;
      uni.removeStorageSync('current_thread');
      if (this.type === 1) {
        this.textAreaValue = this.vditor.getValue();
      }
      var thread = {};
      var items = [
      'postTitle',
      'price',
      'word',
      'fileId',
      'videoName',
      'textAreaValue',
      'categoryIndex',
      'categoryId',
      'checkClassData',
      'uploadFile',
      'videoBeforeList',
      'audioBeforeList',
      'checked',
      'watchChecked',
      'askingPrice',
      'watchShow',
      'priceAsk',
      'beAskId',
      'userImage',
      'beUserName',
      'type',
      'showHidden',
      'payType',
      'showPayType',
      'ioshide',
      'dataGoodInfo'];

      items.forEach(function (key) {
        if (_this3[key]) {
          thread[key] = _this3[key];
        }
      });
      if (this.$refs.uploadFiles) {
        var fileList = this.$refs.uploadFiles.getValue();
        var attachmentList = [];
        fileList.forEach(function (v) {
          attachmentList.push({
            fileName: v.attributes.fileName,
            url: v.attributes.url,
            _jv: {
              id: v.id } });


        });
        thread.attachmentList = attachmentList;
      }
      if (this.$refs.upload) {
        var imgList = this.$refs.upload.getValue();
        imgList.forEach(function (value, index) {
          if (value.attributes) {
            imgList[index] = {
              path: value.attributes.thumbUrl,
              id: value.id,
              order: value.attributes.order,
              name: value.attributes.fileName,
              url: value.attributes.url };

          }
        });
        thread.imgList = imgList;
      }
      uni.setStorageSync('current_thread', JSON.stringify(thread));
    },
    setThread: function setThread() {var _this4 = this;
      var thread = uni.getStorageSync('current_thread');
      if (!thread) {
        return;
      }

      thread = JSON.parse(thread);
      // console.log(thread, '设置');
      this.dataGoodInfo = thread.dataGoodInfo;
      // console.log('这是商品信息', this.dataGoodInfo);
      Object.getOwnPropertyNames(thread).forEach(function (key) {
        if (key === 'imgList') {
          var threadImgList = thread[key];
          threadImgList.forEach(function (v, index) {
            threadImgList[index] = {
              thumbUrl: v.path,
              _jv: {
                id: v.id },

              order: v.order,
              fileName: v.name,
              url: v.url };

          });
          var image = { firstPost: { images: [] } };
          image.firstPost.images = thread[key];
          _this4.setAnnex('img', image);
        } else {
          _this4[key] = thread[key];
        }
      });
      if (this.videoBeforeList.length > 0) {
        // this.videoPercent = 1;
        this.percent = 1;
      }

      uni.removeStorageSync('current_thread');
    },
    focusEvent: function focusEvent() {
      // 这是获取焦点
    },
    toolBarClick: function toolBarClick(type) {
      var text = '';
      if (type === 'bold') {
        text = "".concat("".concat(this.textAreaValue.slice(
        0,
        this.cursor), "**\u7C97\u4F53\u6587\u5B57**").concat(
        this.textAreaValue.slice(this.cursor)));
        this.cursor += 2;
        this.focusEvent(this.cursor);
      } else if (type === 'italic') {
        // this.textareaValue += '*斜体* ';
        text = "".concat("".concat(this.textAreaValue.slice(0, this.cursor), "__").concat(this.textAreaValue.slice(
        this.cursor)));

        this.cursor += 1;
        this.focusEvent(this.cursor);
      } else if (type === 'title') {
        text = "".concat("".concat(this.textAreaValue.slice(0, this.cursor), "\n### ").concat(this.textAreaValue.slice(
        this.cursor)));

        this.cursor += 4;
        this.focusEvent(this.cursor);
      } else if (type === 'quote') {
        text = "".concat("".concat(this.textAreaValue.slice(0, this.cursor), "\n> ").concat(this.textAreaValue.slice(
        this.cursor)));

        this.cursor += 1;
        this.focusEvent(this.cursor);
      } else if (type === 'link') {
        text = "".concat("".concat(this.textAreaValue.slice(0, this.cursor), "[](url)").concat(this.textAreaValue.slice(
        this.cursor)));

        this.cursor += 1;
        this.focusEvent(this.cursor);
      } else if (type === 'code') {
        text = "".concat("".concat(this.textAreaValue.slice(0, this.cursor), "``").concat(this.textAreaValue.slice(
        this.cursor)));

        this.cursor += 1;
        this.focusEvent(this.cursor);
      } else if (type === 'strikethrough') {
        text = "".concat("".concat(this.textAreaValue.slice(0, this.cursor), "~~~~").concat(this.textAreaValue.slice(
        this.cursor)));

        this.cursor += 2;
        this.focusEvent(this.cursor);
      }
      this.textAreaValue = text;
    } },
  (0, _vuex.mapMutations)({
    setAtMember: 'atMember/SET_ATMEMBER' })), {}, (_objectSpread2 = {

    // 文章类型（0:文字  1:帖子  2:视频  3:图片）
    // 处理金额
    /* eslint-disable */
    checkNum: function checkNum(e) {
      var that = this;
      var price = e.target.value;
      var maxLength = price.indexOf('.');
      if (price.indexOf('.') < 0 && price != '') {
        // '超过4位则大于1万元';
        if (price.length > 6) {
          price = price.substring(0, price.length - 1);
          uni.showToast({
            title: that.c.TheAmountCannotExceedOneMillion,
            icon: 'none' });

        } else {
          price = parseFloat(price);
        }
      } else if (price.indexOf('.') == 0) {
        //'首位小数点情况'
        price = price.replace(/[^$#$]/g, '0.');
        price = price.replace(/\.{2,}/g, '.');
      } else if (!/^(\d?)+(\.\d{0,2})?$/.test(price)) {
        //去掉最后一位
        price = price.substring(0, price.length - 1);
      }
      that.$nextTick(function () {
        //'有小数点时，最大长度为9位，没有则是7位'
        that.maxLength = maxLength == -1 ? 7 : 10;
        that.inputPrice = price;
      });
    },
    // video相关方法
    videoDel: function videoDel() {
      this.deleteType = 2;
      // this.deleteId = id;
      // this.deleteIndex = del;
      this.$refs.deletePopup.open();
      this.deleteTip = this.i18n.t('core.deleteVideoSure');
    },
    playVideo: function playVideo(video) {








    },
    fullscreenchange: function fullscreenchange(e) {
      this.fullscreenStatus = e.detail.fullScreen;
      if (!e.detail.fullScreen) {
        this.controlsStatus = false;
        this.videoContext.pause();
      }
    },
    // 点击表情
    emojiclick: function emojiclick() {
      this.emojiShow = !this.emojiShow;
      this.textShow = !this.textShow;
    },
    // 弹框相关方法
    contBlur: function contBlur(e) {
      this.cursor = e.detail.cursor;
    },
    diaLogClose: function diaLogClose() {
      this.$refs.popup.close();
      this.popupStatus = false;
      this.textShow = true;
    },
    diaLogOk: function diaLogOk() {
      if (this.forums.set_site.site_minimum_amount === '') {
        if (this.inputPrice < '0.1') {
          uni.showToast({
            title: this.i18n.t('core.TheAmountCannotBeLessThanOneYuan'),
            icon: 'none' });

          return;
        }
      } else {
        if (this.inputPrice < this.forums.set_site.site_minimum_amount) {
          uni.showToast({
            title:
            this.i18n.t('core.TheAmountCannotBeLessThanMinMoney') +
            this.forums.set_site.site_minimum_amount +
            this.i18n.t('discuzq.post.yuan'),
            icon: 'none' });

          return;
        }
      }
      if (this.type === 5) {
        // if (this.inputPrice < '1.0') {
        //   uni.showToast({
        //     title: this.i18n.t('core.TheAmountCannotBeLessThanOneYuan'),
        //     icon: 'none',
        //   });
        //   return;
        // }
        this.priceAsk = this.inputPrice;
        this.$refs.popup.close();
        this.popupStatus = false;
        this.textShow = true;
        this.postClick();
        return;
      }

      if (this.setType === 'pay') {
        this.price = this.inputPrice;
      } else {
        this.word = this.inputWord;
      }
      this.$refs.popup.close();
      this.popupStatus = false;
      this.textShow = true;
    },
    percentageClick: function percentageClick(index) {
      this.word = this.freepercentage[index].pay;
      this.percentagedisplay = this.freepercentage[index].name;
      this.setType = 'word';
      this.freewords = [];
      this.freewords.push(this.freepercentage[index]);
      this.$refs.popupBtm.close();
    },
    moneyClick: function moneyClick(index) {var _this5 = this;
      // if (this.forums.set_site.site_onlooker_price === 0) {
      //   this.watchShow = false;
      // } else if (index === 0) {
      //   console.log('免费')
      //   this.payType = 0;
      //   // this.postClick();
      //   if (this.payType === 0) {
      //     this.showPayType = this.i18n.t('discuzq.post.TheContentAndTheAccessoriesIsFree');
      //   }
      //   this.watchShow = false;
      // } else {
      //   this.watchShow = true;
      // }
      if (this.forums.set_site.site_onlooker_price === 0) {
        this.watchShow = false;
      }
      if (index === 0) {
        if (this.type === 5) {
          this.postClick();
          this.watchShow = false;
          return;
        }
        if (this.type !== 1 && this.type !== 5) {
          this.payType = 0;
          if (this.payType === 0) {
            this.showPayType = this.i18n.t('discuzq.post.TheContentAndTheAccessoriesIsFree');
          }
        }
      } else {
        this.watchShow = true;
      }
      this.setType = 'pay';
      this.payNumCheck = [];
      this.payNumCheck.push(this.payNum[index]);
      console.log(this.payNum);
      // 自定义金额
      if (this.payNumCheck[0].name === this.i18n.t('discuzq.post.customize')) {
        console.log('自定义金额');
        this.textShow = false;
        this.$refs.popupBtm.close();
        this.popupStatus = true;
        this.$nextTick(function () {
          _this5.inputPrice = '';
          _this5.$refs.popup.open();
          _this5.textShow = false;
        });
      } else {
        if (this.type === 5 && index !== 0) {
          // console.log('选择金额')
          this.priceAsk = this.payNumCheck[0].pay;
          this.$refs.popupBtm.close();
          this.postClick();
          this.textShow = true;
          return;
        }
        this.price = this.payNumCheck[0].pay;
        this.$refs.popupBtm.close();
        this.textShow = true;
      }
    },
    // 点击显示查看支付的抽屉
    lookPay: function lookPay() {
      this.$refs.lookPayPopup.open();
    },
    // 取消查看支付选择
    cancelLookPay: function cancelLookPay() {
      this.$refs.lookPayPopup.close();
    },
    // 选择支付查看的方式 0均免费， 1内容免费，附件付费，  2内容和附件都付费
    choicePayType: function choicePayType(type) {
      // console.log(type, '类型');
      if (type === 0) {
        this.payNumCheck = [];
        this.price = '';
        this.showPayType = this.i18n.t('discuzq.post.TheContentAndTheAccessoriesIsFree');
      } else if (type === 1) {
        this.payNumCheck = [];
        this.showPayType = this.i18n.t('discuzq.post.TheContentIsFreeAndTheAccessoriesArePaid');
        this.payNum[0].name = '￥1';
        this.payNum[0].pay = 1;
      } else {
        this.payNumCheck = [];
        this.payNum[0].name = '￥1';
        this.showPayType = this.i18n.t('discuzq.post.TheContentAndTheAccessoriesIsPaid');
        this.payNum[0].pay = 1;
      }
      this.payType = type;
      this.$refs.lookPayPopup.close();
    },
    cellClick: function cellClick(type) {
      this.setType = type;
      this.$refs.popupBtm.open();
      this.textShow = false;
    },
    // 提问价格
    postAnswerClick: function postAnswerClick(type) {
      this.$refs.popupBtm.open();
      this.textShow = false;
    },
    cancel: function cancel() {
      this.$refs.popupBtm.close();
      this.textShow = true;
    },
    // 图片上传相关方法
    uploadClick: function uploadClick(e) {
      this.uploadStatus = e;
    },
    uploadChange: function uploadChange(e, status) {
      this.uploadFile = e;
      this.uploadStatus = status;
    },
    uploadClear: function uploadClear(list, del) {
      var id = list.id;
      this.deleteType = 0;
      this.deleteId = id;
      this.deleteIndex = del;
      this.$refs.deletePopup.open();
      this.deleteTip = this.i18n.t('core.deleteImgSure');
    },
    // 音频上传改变
    uploadAudioChange: function uploadAudioChange(e) {
      this.audioBeforeList = e;
    },
    audioDel: function audioDel() {
      this.deleteType = 3;
      this.$refs.deletePopup.open();
      this.deleteTip = this.i18n.t('core.deleteAudioSure');
    },
    // 表情点击事件
    getEmojiClick: function getEmojiClick(code) {
      var text = '';
      text = "".concat(this.textAreaValue.slice(0, this.cursor) +
      code +
      this.textAreaValue.slice(this.cursor));
      this.cursor = text.length;
      this.textAreaValue = text;
      this.emojiShow = false;
      this.textShow = true;
    },
    // @人员跳转
    callClick: function callClick() {
      uni.navigateTo({ url: '/pages/user/at-member' });
    },
    topicPage: function topicPage() {
      uni.navigateTo({ url: '/pages/topic/topic' });
    },
    // 分类点击
    checkClass: function checkClass(e, index) {
      // 单选功能
      this.categoryIndex = index;
      this.categoryId = e._jv.id;
      this.checkClassData = [];
      this.checkClassData.push(this.allCategories[index]);
    },
    // 主题提问价格
    payClickShow: function payClickShow() {var _this6 = this;
      console.log('payClickshow');
      if (!this.$store.getters['session/get']('isLogin')) {

        this.mpLoginMode();





      }
      this.payStatus = false;
      if (!this.forums.paycenter.wxpay_close) {
        this.payShowStatus = false;
        return;
      } else if (this.forums.paycenter.wxpay_close && this.forums.other.can_create_thread_paid) {

        if (this.system === 'ios') {
          this.postShow = true;
          this.payShowStatus = false;
          this.ioshide = false;
          return;
        } else {
          this.ioshide = true;
          this.payShowStatus = true;
        }





      } else {
        this.ioshide = false;
        this.payShowStatus = false;
        return;
      }
      this.payTypeText = this.t.pay + this.t.payAskingPrice;
      this.priceAsk = parseFloat(this.thread.price);
      this.$nextTick(function () {
        _this6.$refs.payShow.payClickShow(_this6.payTypeVal);
      });
    },
    // 支付方式选择完成点击确定时
    paysureShow: function paysureShow(payType) {
      uni.setStorage({
        key: 'page',
        data: "/topic/post?type=5&categoryId=".concat(this.categoryid, "&categoryIndex=").concat(this.categoryindex) });

      if (payType === 0) {












        if (
        this.user.wechat === undefined ||
        this.user.wechat && this.user.wechat.min_openid === '')
        {
          this.$refs.wechatPopup.open();
          return;
        }

        this.creatOrder(this.priceAsk, 5, '', payType);
      } else if (payType === 1) {
        // 这是详情页获取到的支付方式---钱包
      }
    },
    // 输入密码完成时
    onInput: function onInput(val) {
      this.value = val;
      this.creatOrder(this.priceAsk, 5, val, 1);
    },
    creatOrder: function creatOrder(amount, type, value, payType) {var _this7 = this;
      var params = {
        _jv: {
          type: 'orders' },

        type: type,
        payee_id: this.beAskId,
        amount: amount,
        is_anonymous: this.checked ? '0' : '1' };

      this.$store.
      dispatch('jv/post', params).
      then(function (res) {
        _this7.orderSn = res.order_sn;
        if (payType === 0) {
          // 微信支付
          if (_this7.browser == 0) {
            // 这是微信小程序内的支付
            _this7.orderPay(13, value, _this7.orderSn, payType, '0');
          } else {
            // 这是除微信小程序之外, this.isWeixin, this.isPhone
            if (_this7.isWeixin && _this7.isPhone) {
              // 这是微信浏览器
              _this7.orderPay(12, value, _this7.orderSn, payType, '1');
            } else if (_this7.isPhone) {
              _this7.orderPay(20, value, _this7.orderSn, 1, '2');
            } else {
              // 这是pc，没调接口之前
              _this7.orderPay(10, value, _this7.orderSn, payType, '3');
            }
          }
        } else if (payType === 1) {
          // 钱包支付
          _this7.orderPay(20, value, _this7.orderSn, payType);
        }
      }).
      catch(function (err) {
        console.log(err);
      });
    },
    // 订单支付       broswerType: 0是小程序，微信1是浏览器，2是h5，3是pc
    orderPay: function orderPay(type, value, orderSn, payType, broswerType) {var _this8 = this;
      var params = {};
      if (payType === 0) {
        params = {
          _jv: {
            type: "trade/pay/order/".concat(orderSn) },

          payment_type: type };

      } else if (payType === 1) {
        params = {
          _jv: {
            type: "trade/pay/order/".concat(orderSn) },

          payment_type: type,
          pay_password: value };

      }
      this.$store.
      dispatch('jv/post', params).
      then(function (res) {
        _this8.wxRes = res;
        if (payType === 0) {
          if (broswerType === '0') {
            _this8.wechatPay(
            res.wechat_js.timeStamp,
            res.wechat_js.nonceStr,
            res.wechat_js.package,
            res.wechat_js.signType,
            res.wechat_js.paySign);

          } else if (broswerType === '1') {
            if (typeof WeixinJSBridge === 'undefined') {
              if (document.addEventListener) {
                document.addEventListener('WeixinJSBridgeReady', _this8.onBridgeReady(res), false);
              } else if (document.attachEvent) {
                document.attachEvent('WeixinJSBridgeReady', _this8.onBridgeReady(res));
                document.attachEvent('onWeixinJSBridgeReady', _this8.onBridgeReady(res));
              }
            } else {
              _this8.onBridgeReady(res);
            }
          } else if (broswerType === '2') {
            _this8.postThread().then(function (data) {
              // window.location.href = `${res.wechat_h5_link}&redirect_url=${encodeURIComponent(window.location.origin /topic/indexdex?id='+ data._jv.id)}`;
              _this8.postLoading = false;
              uni.hideLoading();
              if (res && res.isApproved === 1) {
                // 因为设置了虚拟滚动，所以将会去除所有对列表数据的操作，只会刷新才会更新现有数据
                // this.$u.event.$emit('addThread', res);
              }
              if (res && res._jv && res._jv.json.data.id) {
                uni.redirectTo({
                  url: "/topic/index?id=".concat(res._jv.json.data.id) });

              }
            });
          } else if (broswerType === '3') {
            if (res) {
              _this8.codeUrl = res.wechat_qrcode;
              _this8.payShowStatus = false;
              _this8.$refs.codePopup.open();
              _this8.qrcodeShow = true;
              payWechat = setInterval(function () {
                if (_this8.payStatus === 1) {
                  clearInterval(payWechat);
                  return;
                }
                _this8.getOrderStatus(_this8.orderSn, broswerType);
                uni.hideLoading();
              }, 3000);
            }
          }
        } else if (payType === 1) {
          if (res.wallet_pay.result === 'success') {
            _this8.$store.dispatch('jv/get', ["users/".concat(_this8.currentLoginId), {}]);
            _this8.coverLoading = false;
            _this8.postThread().then(function (res) {
              _this8.postLoading = false;
              uni.hideLoading();
              if (res && res.isApproved === 1) {
                // 因为设置了虚拟滚动，所以将会去除所有对列表数据的操作，只会刷新才会更新现有数据
                // this.$u.event.$emit('addThread', res);
              }
              if (res && res._jv.json.data.id) {
                uni.redirectTo({
                  url: "/topic/index?id=".concat(res._jv.json.data.id) });

              }
            });
          }
          _this8.coverLoading = false;
        }
      }).
      catch(function (err) {
        // 清空支付的密码
        console.log(err);
        _this8.$refs.payShow.clearPassword();
      });
    },
    getOrderStatus: function getOrderStatus(orderSn, broswerType) {var _this9 = this;
      this.$store.
      dispatch('jv/get', ["orders/".concat(orderSn), { custom: { loading: false } }]).
      then(function (res) {
        _this9.payStatus = res.status;
        if (_this9.payStatus === 1) {
          if (broswerType === '2') {
            // return false;
          } else if (broswerType === '3') {
            // 这是pc扫码支付完成
            _this9.$refs.codePopup.close();
            _this9.qrcodeShow = false;
            _this9.postThread();
          } else if (broswerType === '0') {
            _this9.postThread().then(function (res) {
              _this9.postLoading = false;
              uni.hideLoading();
              if (res && res.isApproved === 1) {
                // 因为设置了虚拟滚动，所以将会去除所有对列表数据的操作，只会刷新才会更新现有数据
                // this.$u.event.$emit('addThread', res);
              }
              if (res && res._jv.json.data.id) {
                uni.redirectTo({
                  url: "/topic/index?id=".concat(res._jv.json.data.id) });

              }
            });
          } else if (broswerType === '1') {
            _this9.postThread().then(function (res) {
              _this9.postLoading = false;
              uni.hideLoading();
              if (res && res.isApproved === 1) {
                // 因为设置了虚拟滚动，所以将会去除所有对列表数据的操作，只会刷新才会更新现有数据
                // this.$u.event.$emit('addThread', res);
              }
              if (res && res._jv.json.data.id) {
                uni.redirectTo({
                  url: "/topic/index?id=".concat(res._jv.json.data.id) });

              }
            });
          }
          _this9.$refs.toast.show({ message: _this9.i18n.t('pay.paySuccess') });
        }
      }).
      catch(function (err) {
        console.log(err);
        _this9.coverLoading = false;
        _this9.$refs.toast.show({ message: _this9.i18n.t('pay.payFail') });
      });
    },
    wechatPay: function wechatPay(timeStamp, nonceStr, packageVal, signType, paySign) {
      // 小程序支付。
      var _this = this;
      uni.requestPayment({
        provider: 'wxpay',
        timeStamp: timeStamp,
        nonceStr: nonceStr,
        package: packageVal,
        signType: signType,
        paySign: paySign,
        success: function success(res) {
          _this.coverLoading = true;
          payWechat = setInterval(function () {
            if (_this.payStatus === 1) {
              clearInterval(payWechat);
              return;
            }
            _this.getOrderStatus(_this.orderSn, '0');
          }, 3000);
        },
        fail: function fail(err) {
          _this.payShowStatus = false;
          _this.coverLoading = false;
          _this.$refs.toast.show({ message: _this.p.payFail });
        } });

    },
    // 非小程序内微信支付
    onBridgeReady: function onBridgeReady(data) {var _this10 = this;
      // const that = this;
      WeixinJSBridge.invoke(
      'getBrandWCPayRequest',
      {
        appId: data.wechat_js.appId, // 公众号名称，由商户传入
        timeStamp: data.wechat_js.timeStamp, // 时间戳，自1970年以来的秒数
        nonceStr: data.wechat_js.nonceStr, // 随机串
        package: data.wechat_js.package,
        signType: 'MD5', // 微信签名方式：
        paySign: data.wechat_js.paySign // 微信签名
      },
      function (data) {
        // alert('支付唤醒');
        if (data.err_msg == 'get_brand_wcpay_request:ok') {
          //微信支付成功，进行支付成功处理
        } else if (data.err_msg == 'get_brand_wcpay_request:cancel') {
          // 取消支付
          clearInterval(payWechat);
          resolve;
        } else if (data.err_msg == 'get_brand_wcpay_request:fail') {
          // 支付失败
          clearInterval(payWechat);
          resolve;
        }
      });

      payWechat = setInterval(function () {
        if (_this10.payStatus === 1) {
          clearInterval(payWechat);
          return;
        }
        _this10.getOrderStatus(_this10.orderSn, '1');
      }, 3000);
    },
    // 选择支付方式，获取值
    radioChange: function radioChange(val) {
      // console.log(val, '支付方式')
    },
    // 发布按钮点击，检测条件是否符合，符合的话调用接口
    postClick: function postClick() {var _this11 = this;
      this.payTypeText = this.i18n.t('topic.pay') + this.i18n.t('discuzq.post.payAskingPrice');








      if (!this.categoryId) {
        this.$refs.toast.show({ message: this.i18n.t('discuzq.post.theclassifyCanNotBeBlank') });
        return false;
      }
      var status = true;
      switch (this.type) {
        case 0:
          if (this.textAreaValue.length < 1) {
            this.$refs.toast.show({ message: this.i18n.t('discuzq.post.theContentCanNotBeBlank') });
            status = false;
          } else {
            status = true;
          }
          break;
        case 1:
          if (this.postTitle.length < 1) {
            this.$refs.toast.show({ message: this.i18n.t('discuzq.post.theTitleCanNotBeBlank') });
            status = false;
          } else if (this.textAreaValue.length < 1) {
            this.$refs.toast.show({ message: this.i18n.t('discuzq.post.theContentCanNotBeBlank') });
            status = false;
          } else if (!this.uploadStatus) {
            this.$refs.toast.show({
              message: this.i18n.t('discuzq.post.pleaseWaitForTheImageUploadToComplete') });

            status = false;
          } else if (this.payType === 1) {
            // 内容免费，附件付费
            if (this.$refs.uploadFiles.getValue().length === 0) {
              // 附件不能为空
              this.$refs.toast.show({
                message: this.i18n.t('discuzq.post.attachmentCannotBeEmpty') });

              status = false;
            } else if (this.price === 0) {
              // 选择付费后，价格不能为空
              // console.log('选择付费后，价格不能为空');
              this.$refs.toast.show({
                message: this.i18n.t('discuzq.post.priceCannotBeFree') });

              status = false;
            } else {
              status = true;
            }
          } else if (this.payType === 2) {
            // 内容附件均付费
            if (this.price === 0) {
              this.$refs.toast.show({
                message: this.i18n.t('discuzq.post.priceCannotBeFree') });

              status = false;
            } else {
              status = true;
            }
          } else {
            status = true;
          }
          break;
        case 2:
          if (this.videoBeforeList.length < 1) {
            this.$refs.toast.show({ message: this.i18n.t('discuzq.post.videoCannotBeEmpty') });
            status = false;
          } else if (this.percent !== 1) {
            this.$refs.toast.show({
              message: this.i18n.t('discuzq.post.pleaseWaitForTheVideoUploadToComplete') });

            status = false;
          } else if (this.payType === 2) {
            // 内容附件均付费
            if (this.price === 0) {
              this.$refs.toast.show({
                message: this.i18n.t('discuzq.post.priceCannotBeFree') });

              status = false;
            } else {
              status = true;
            }
          } else {
            status = true;
          }
          break;
        case 3:
          if (this.operating !== 'edit') {
            if (!this.uploadStatus) {
              this.$refs.toast.show({
                message: this.i18n.t('discuzq.post.pleaseWaitForTheImageUploadToComplete') });

              status = false;
            } else if (this.uploadFile.length < 1) {
              this.$refs.toast.show({
                message: this.i18n.t('discuzq.post.imageCannotBeEmpty') });

              status = false;
            } else if (this.payType === 2) {
              // 内容附件均付费
              if (this.price === 0) {
                this.$refs.toast.show({
                  message: this.i18n.t('discuzq.post.priceCannotBeFree') });

                status = false;
              } else {
                status = true;
              }
            } else {
              status = true;
            }
          } else {
            if (!this.uploadStatus) {
              this.$refs.toast.show({
                message: this.i18n.t('discuzq.post.pleaseWaitForTheImageUploadToComplete') });

              status = false;
            } else if (this.payType === 2) {
              // 内容附件均付费
              if (this.price === 0) {
                this.$refs.toast.show({
                  message: this.i18n.t('discuzq.post.priceCannotBeFree') });

                status = false;
              } else {
                status = true;
              }
            } else {
              status = true;
            }
          }
          break;
        case 4:
          if (this.audioBeforeList.length < 1) {
            this.$refs.toast.show({
              message: this.i18n.t('discuzq.post.audioCannotBeEmpty') });

            status = false;
          } else {
            status = true;
          }
          break;
        case 5:
          if (this.beAskId === '') {
            this.$refs.toast.show({
              message: this.i18n.t('discuzq.post.pleaseSelectTheUserToBeAsked') });

            status = false;
          } else if (this.textAreaValue.length < 1) {
            this.$refs.toast.show({ message: this.i18n.t('discuzq.post.theContentCanNotBeBlank') });
            status = false;
          } else if (this.watchShow) {
            console.log(this.watchShow, 'this.watchShow');
            this.payShowStatus = true;
            this.$nextTick(function () {
              _this11.$refs.payShow.payClickShow();
            });
          }
          break;
        case 6:
          console.log(this.dataGoodInfo.length, '^^^^~~~~~~~~');
          if (this.dataGoodInfo === '' || this.dataGoodInfo.length === 0) {
            this.$refs.toast.show({ message: this.i18n.t('core.productInformationDoesNotExist') });
            status = false;
          } else {
            status = true;
          }
          break;
        default:
          status = false;
          this.$refs.toast.show({ message: this.i18n.t('core.postTypesDoNotMatch') });}

      if (status) {
        if (this.type !== 5) {
          this.postLoading = true;
          uni.showLoading();
        }
        if (this.operating === 'edit') {
          // if (this.type === 5) {
          //   // this.beUserName =
          // }
          // 因为设置了虚拟滚动，所以将会去除所有对列表数据的操作，只会刷新才会更新现有数据
          // this.$u.event.$emit('updateLocation', this.postDetails._jv.id, this.currentPosition);
          if (this.type === 3) {
            if (this.uploadFile.length < 1) {
              this.$refs.toast.show({
                message: this.i18n.t('discuzq.post.imageCannotBeEmpty') });

              uni.hideLoading();
              this.postLoading = false;
            } else {
              this.editThread().then(function (res) {
                _this11.postLoading = false;
                uni.hideLoading();
                // uni.navigateBack({
                //   delta: 1,
                // });
                if (res && _this11.threadId) {
                  uni.redirectTo({
                    url: "/topic/index?id=".concat(_this11.threadId) });

                }
              });
            }
          } else {
            console.log('!!!!!!!~~~~~~~~~~~~~~~~~');
            this.editThread().then(function (res) {
              _this11.postLoading = false;
              uni.hideLoading();
              // uni.navigateBack({
              //   delta: 1,
              // });
              if (res && _this11.threadId) {
                uni.redirectTo({
                  url: "/topic/index?id=".concat(_this11.threadId) });

              }
            });
          }
        } else {
          if (this.forums.qcloud.qcloud_captcha && this.forums.other.create_thread_with_captcha) {
            if (!this.ticket || !this.randstr) {
              this.toTCaptcha();
              return false;
            }
          }
          if (!this.watchShow || this.type !== 5) {
            this.postThread().then(function (res) {
              _this11.postLoading = false;
              uni.hideLoading();
              if (res && res.isApproved === 1) {
                _this11.$u.event.$emit('addThread', res);
              }
              if (res && res._jv.json.data.id) {
                uni.redirectTo({
                  url: "/topic/index?id=".concat(res._jv.json.data.id) });

              }
            });
          }
        }
      }
    },
    // 编辑回显主题，处理附件
    setAnnex: function setAnnex(type, data) {
      switch (type) {
        case 'img':
          var filePreview = [];
          data.firstPost.images.map(function (item) {
            filePreview.push({
              path: item.thumbUrl,
              id: item._jv.id,
              order: item.order,
              name: item.fileName,
              url: item.url });

            return item;
          });
          this.filePreview = filePreview;
          break;
        case 'video':
          this.videoBeforeList.push({
            path: data.threadVideo.media_url });

          // this.videoPercent = 1;
          break;
        case 'audio':
          this.audioBeforeList.push({
            fileName: data.threadAudio.file_name,
            url: data.threadAudio.media_url,
            id: data.threadAudio.file_id });

          break;
        case 'goods':
          this.dataGoodInfo = data.firstPost.postGoods;
          if (
          data.firstPost.postGoods.price.indexOf('-') !== -1 ||
          Number(data.firstPost.postGoods.price) > 0)
          {
            this.dataGoodInfoPrice = data.firstPost.postGoods.price;
          } else if (Number(data.firstPost.postGoods.price) <= 0) {
            this.dataGoodInfoPrice = '';
          }
          // this.audioBeforeList.push({
          //   fileName: data.threadAudio.file_name,
          //   url: data.threadAudio.media_url,
          //   id: data.threadAudio.file_id,
          // });
          break;
        default:
          console.log('没有匹配模式');
          break;}

    },
    // 发布主题，处理图片
    addImg: function addImg() {
      var attachments = {};
      attachments.data = [];
      this.uploadFile.forEach(function (item) {
        if (item) {
          attachments.data.push({
            type: 'attachments',
            id: item.id });

        }
      });
      return attachments;
    },
    // 发布主题，处理附件
    addFile: function addFile() {
      var attachmentFiles = {};
      attachmentFiles.data = [];
      // if (this.type === 1 && this.$refs.uploadFiles) {
      var newAttachmentList = this.$refs.uploadFiles.getValue();
      newAttachmentList.forEach(function (item) {
        if (item.id) {
          attachmentFiles.data.push({
            type: 'attachments',
            id: item.id });

        }
      });
      // }
      return attachmentFiles;
    },
    // 发布问题
    addQuestion: function addQuestion() {
      var question = {
        data: {
          be_user_id: this.beAskId,
          price: this.priceAsk,
          is_onlooker: this.watchChecked,
          order_id: this.orderSn } };


      // if(!this.watchShow){
      //   delete question.data.order_id
      // }
      return question;
    },
    // 删除附件显示弹框
    deleteFile: function deleteFile(id) {
      this.deleteTip = this.i18n.t('core.deleteEnclosureSure');
      this.$refs.deletePopup.open();
      this.deleteType = 1;
      this.deleteId = id;
    },
    // 删除附件调用删除接口
    deleteFileSure: function deleteFileSure(id) {var _this12 = this;
      var params = {
        _jv: {
          type: 'attachments',
          id: id } };


      this.$store.dispatch('jv/delete', params).then(function (res) {
        _this12.$refs.uploadFiles.deleteSure();
      });
    },
    // 接口请求
    getCategories: function getCategories() {var _this13 = this;
      this.$store.dispatch('jv/get', ['categories?filter[createThread]=1', {}]).then(function (res) {
        _this13.allCategories = res;
        res.map(function (item) {
          // console.log(item, 'itemitemitemitem');
          if (item._jv) {
            if (Number(item._jv.id) === Number(_this13.categoryId)) {
              _this13.checkClassData.push(item);
            }
          }
          return item;
        });
      });
    },
    postThread: function postThread() {var _this14 = this;
      var params = {
        _jv: {
          type: 'threads',
          relationships: {
            category: {
              data: {
                type: 'categories',
                id: this.checkClassData[0]._jv.id } } },



          links: {
            self:
            'threads?include=user,category,firstPost,firstPost.images,firstPost.postGoods,question,question.beUser,question.beUser.groups,question.images' } },


        content: this.textAreaValue,
        type: this.type,
        price: this.price,
        free_words: this.word,
        captcha_ticket: this.ticket,
        captcha_rand_str: this.randstr,
        is_anonymous: this.checked };

      if (this.payType === 1) {
        params.attachment_price = this.price;
        params.price = '';
      } else if (this.payType === 0) {
        params.attachment_price = '';
        params.price = this.price;
      }

      var currentPosition = this.currentPosition;
      params.longitude = currentPosition.longitude || '';
      params.latitude = currentPosition.latitude || '';
      params.location = currentPosition.location || '';
      params.address = currentPosition.address || '';
      var postPromise = new Promise(function (resolve, reject) {
        switch (_this14.type) {
          case 0:
            resolve();
            break;
          case 1:
            params.title = _this14.postTitle;
            params._jv.relationships.attachments = {
              data: _this14.addImg().data.concat(_this14.addFile().data) };

            resolve();
            break;
          case 2:
            params.file_id = _this14.fileId;
            params.file_name = _this14.videoName;
            resolve();
            break;
          case 3:
            params._jv.relationships.attachments = _this14.addImg();
            resolve();
            break;
          case 4:
            params.file_id = _this14.audioBeforeList[0].id;
            params.file_name = _this14.audioBeforeList[0].fileName;
            resolve();
            break;
          case 5:
            params._jv.relationships.attachments = _this14.addImg();
            params._jv.relationships.question = _this14.addQuestion();
            resolve();
            break;
          case 6:
            params.post_goods_id = _this14.dataGoodInfo._jv.id;
            resolve();
            break;
          default:
            reject();
            _this14.$refs.toast.show({ message: _this14.i18n.t('core.postTypesDoNotMatch') });}

      });
      return postPromise.then(function () {
        return _this14.$store.
        dispatch('jv/post', params).
        then(function (res) {
          // console.log(res, '这是发布时接口返回的');
          return res;
        }).
        catch(function (err) {
          console.log(err);
        });
      });
    },
    delAttachments: function delAttachments(id, index) {
      if (this.operating === 'edit') {
        // console.log('这是编辑');
        this.$u.event.$emit('deleteImg', {
          threadId: this.postDetails._jv.id,
          index: index });

        var post = this.$store.getters['jv/get']("posts/".concat(this.postDetails.firstPost._jv.id));
        post.images.splice(index, 1);
        post._jv.relationships.images.data.splice(index, 1);
      }
    },
    handleClickOk: function handleClickOk() {
      this.$refs.deletePopup.close();
      if (this.deleteType === 0) {
        // 删除类型为图片
        this.delAttachments(this.deleteId, this.deleteIndex);
        this.$refs.upload.clear(this.deleteIndex);
        // this.delAttachments(this.deleteId, this.deleteIndex).then(() => {
        //   this.$refs.upload.clear(this.deleteIndex);
        // });
      } else if (this.deleteType === 2) {
        // 删除类型为视频
        this.videoBeforeList = [];
        this.percent = 0;
        // this.videoPercent = 0;
      } else if (this.deleteType === 3) {
        this.audioBeforeList = [];
      }
    },
    handleClickCancel: function handleClickCancel() {
      this.$refs.deletePopup.close();
    },
    // 确认去绑定微信
    handleWechatClickOk: function handleWechatClickOk() {

      this.mpLogin();












    },
    // 取消去绑定微信
    handleWechatClickCancel: function handleWechatClickCancel() {
      this.$refs.wechatPopup.close();
    } }, _defineProperty(_objectSpread2, "delAttachments", function delAttachments(
  id, index) {
    if (this.operating === 'edit') {
      console.log('这是编辑');
      this.$u.event.$emit('deleteImg', {
        threadId: this.postDetails._jv.id,
        index: index });

      var post = this.$store.getters['jv/get']("posts/".concat(this.postDetails.firstPost._jv.id));
      post.images.splice(index, 1);
      post._jv.relationships.images.data.splice(index, 1);
    }
    this.uploadFile.forEach(function (value, key, item) {
      value.id == id && item.splice(key, 1);
    });
  }), _defineProperty(_objectSpread2, "getSignature", function getSignature(
  callBack) {
    this.$store.dispatch('jv/get', ['signature', {}]).then(function (res) {




      callBack(res.signature);

    });
  }), _defineProperty(_objectSpread2, "postVideo", function postVideo(
  fileId) {
    var params = {
      _jv: {
        type: 'thread/video' },

      file_id: fileId,
      type: 0 };

    this.$store.dispatch('jv/post', params);
  }), _defineProperty(_objectSpread2, "getPostThread", function getPostThread(

  option) {var _this15 = this;
    var params = {
      include: [
      'firstPost',
      'firstPost.images',
      'threadVideo',
      'threadAudio',
      'category',
      'firstPost.attachments',
      'question',
      'onlookers',
      'question.beUser',
      'question.images',
      'firstPost.postGoods'] };


    this.$store.dispatch('jv/get', ["threads/".concat(this.threadId), { params: params }]).then(function (res) {
      if (res.question) {
        _this15.beUserName = res.question.beUser.username;
        _this15.beAskId = res.question.beUser.id;
        _this15.userImage = res.question.beUser.avatarUrl;
      }
      _this15.postDetails = res;
      _this15.firstPostId = res.firstPost._jv.id;
      _this15.type = res.type;


      _this15.markdownShow = false;






      _this15.attachmentList = res.firstPost.attachments || [];
      _this15.textAreaValue = res.firstPost.content;
      _this15.categoryId = res.category._jv.id;
      _this15.checkClassData.push(res.category);
      if (res.threadVideo) {
        _this15.fileId = res.threadVideo.file_id;
        _this15.percent = 1;
      }
      // this.uploadFile = res.firstPost.images;
      if (res.firstPost.images) {
        res.firstPost.images.forEach(function (item) {
          if (item) {
            _this15.uploadFile.push({
              type: 'attachments',
              id: item._jv.id,
              order: item.order,
              name: item.fileName,
              url: item.url,
              path: item.thumbUrl ? item.thumbUrl : '' });

          }
        });
      }
      if (_this15.type === 6 && res.firstPost.postGoods) {
        _this15.dataGoodInfo = res.firstPost.postGoods;
        if (
        res.firstPost.postGoods.price.indexOf('-') !== -1 ||
        Number(res.firstPost.postGoods.price) > 0)
        {
          _this15.dataGoodInfoPrice = res.firstPost.postGoods.price;
        } else if (Number(res.firstPost.postGoods.price) <= 0) {
          _this15.dataGoodInfoPrice = '';
        }

        _this15.isShowGoods = true;
        console.log(_this15.dataGoodInfo, _this15.isShowGoods, '这是~~~~~~~~~~~~~~~');
      }
      _this15.loadStatus = true;
      if (Number(res.price) > 0) {
        _this15.price = res.price;
        _this15.word = res.freeWords;
        _this15.freepercentage.forEach(function (item) {
          if (res.freeWords === item.pay) {
            _this15.percentagedisplay = item.name;
          }
        });
        _this15.payType = 2;
        _this15.showPayType = _this15.i18n.t('discuzq.post.TheContentAndTheAccessoriesIsPaid');
        if (_this15.type === 1) {
          _this15.payNum[0].name = '￥1';
          _this15.payNum[0].pay = 1;
        }
      } else if (Number(res.attachmentPrice) > 0) {
        _this15.price = res.attachmentPrice;
        _this15.payType = 1;
        _this15.showPayType = _this15.i18n.t('discuzq.post.TheContentIsFreeAndTheAccessoriesArePaid');
        _this15.payNum[0].name = '￥1';
        _this15.payNum[0].pay = 1;
      } else {
        _this15.showPayType = _this15.i18n.t('discuzq.post.TheContentAndTheAccessoriesIsFree');
      }

      _this15.textAreaLength = _this15.type === 1 ? 49999 : 5000;
      switch (Number(res.type)) {
        case 0:
          break;
        case 1:
          _this15.postTitle = res.title;
          _this15.setAnnex('img', res);
          break;
        case 2:
          _this15.percent = 1;
          _this15.setAnnex('video', res);
          break;
        case 3:
          _this15.setAnnex('img', res);
          break;
        case 4:
          _this15.setAnnex('audio', res);
          break;
        case 6:
          _this15.setAnnex('goods', res);
          break;
        default:
          console.log('未知类型');}

      // 微信里面的定位
      if (option.name) {
        var currentPosition = {};
        var data = option.latng.split(',');
        currentPosition.longitude = data[1];
        currentPosition.latitude = data[0];
        currentPosition.location = option.name;
        currentPosition.address = option.addr;
        _this15.currentPosition = currentPosition;
      } else {
        _this15.currentPosition.longitude = res.longitude || '';
        _this15.currentPosition.latitude = res.latitude || '';
        _this15.currentPosition.location = res.location || '';
        _this15.currentPosition.address = res.address || '';
      }
      if (_this15.operating === 'edit' && _this15.goodsId) {
        _this15.getGoodsInfo();
      }
      _this15.setThread();
    });
  }), _defineProperty(_objectSpread2, "getGoodsInfo", function getGoodsInfo()


  {var _this16 = this;
    console.log('获取');
    this.$store.dispatch('jv/get', "goods/".concat(this.goodsId)).then(function (res) {
      console.log('这是取到的商品信息', res);
      _this16.dataGoodInfo = res;
      if (res.price.indexOf('-') !== -1 || Number(res.price) > 0) {
        _this16.dataGoodInfoPrice = res.price;
      } else if (Number(res.price) <= 0) {
        _this16.dataGoodInfoPrice = '';
      }
      _this16.isShowGoods = true;
    });
  }), _defineProperty(_objectSpread2, "editThread", function editThread()


  {var _this17 = this;return _asyncToGenerator( /*#__PURE__*/_regenerator.default.mark(function _callee() {var state, posts, threads, currentPosition;return _regenerator.default.wrap(function _callee$(_context) {while (1) {switch (_context.prev = _context.next) {case 0:
              console.log('编辑');
              state = 0;
              posts = {
                _jv: {
                  type: 'posts',
                  // id: `${this.firstPostId}?include=user,thread,images`,
                  id: _this17.firstPostId,
                  relationships: {},
                  links: {
                    self: "posts/".concat(_this17.firstPostId, "?include=user,thread,images") } },


                content: _this17.textAreaValue };

              threads = {
                _jv: {
                  type: 'threads',
                  id: _this17.threadId,
                  relationships: {
                    category: {
                      data: {
                        type: 'categories',
                        id: _this17.checkClassData[0]._jv.id } } } } };





              currentPosition = _this17.currentPosition;
              threads.longitude = currentPosition.longitude || '';
              threads.latitude = currentPosition.latitude || '';
              threads.location = currentPosition.location || '';
              threads.address = currentPosition.address || '';_context.t0 =
              _this17.type;_context.next = _context.t0 ===
              0 ? 12 : _context.t0 ===

              1 ? 13 : _context.t0 ===


















              2 ? 18 : _context.t0 ===




              3 ? 22 : _context.t0 ===



              4 ? 25 : _context.t0 ===




              5 ? 29 : _context.t0 ===



              6 ? 31 : 35;break;case 12:return _context.abrupt("break", 36);case 13:threads.title = _this17.postTitle; // threads.price = this.price;
              if (_this17.payType === 1) {// console.log(this.price, '价格');
                threads.attachment_price = _this17.price;threads.price = '';} else if (_this17.payType === 2) {threads.attachment_price = '';threads.price = _this17.price;} else if (_this17.payType === 0) {threads.attachment_price = '';threads.price = '';}threads.free_words = _this17.word;posts._jv.relationships.attachments = { data: _this17.addFile().data };return _context.abrupt("break", 36);case 18:threads.file_id = _this17.fileId;threads.file_name = _this17.videoName;threads.price = _this17.price;return _context.abrupt("break", 36);case 22:threads.price = _this17.price;posts._jv.relationships.attachments = _this17.addImg();return _context.abrupt("break", 36);case 25:threads.price = _this17.price;threads.file_id = _this17.audioBeforeList[0].id;threads.file_name = _this17.audioBeforeList[0].fileName;return _context.abrupt("break", 36);case 29:posts._jv.relationships.attachments = _this17.addImg(); // params._jv.relationships.question = this.addQuestion();
              return _context.abrupt("break", 36);case 31:console.log('666666');posts.post_goods_id = _this17.dataGoodInfo._jv.id;console.log(threads, '666666');return _context.abrupt("break", 36);case 35:return _context.abrupt("break", 36);case 36:_context.next = 38;return (




                _this17.$store.dispatch('jv/patch', posts).then(function (res) {
                  console.log(res, '返回');
                  if (res._jv.json.data.id) state += 1;
                  if (res._jv.json.data.attributes.isApproved === 1) {











                  } // 因为设置了虚拟滚动，所以将会去除所有对列表数据的操作，只会刷新才会更新现有数据
                  // this.$u.event.$emit('refreshImg', {
                  //   id: this.firstPostId,
                  //   threadId: this.threadId,
                  //   images: this.addImg(),
                  // });
                  // this.$u.event.$emit('refreshGoods', {
                  //   id: this.firstPostId,
                  //   threadId: this.threadId,
                  //   goods: this.dataGoodInfo,
                  // });
                  // 更新详情页的信息
                  // this.$u.event.$emit('refreshFiles');
                  return res;}));case 38:_context.next = 40;return _this17.$store.dispatch('jv/patch', threads).then(function (res) {if (res._jv.json.data.id) state += 1;});case 40:if (!(state === 2)) {_context.next = 42;break;}return _context.abrupt("return", state);case 42:throw new Error('出错了');case 43:case "end":return _context.stop();}}}, _callee);}))();}), _defineProperty(_objectSpread2, "toTCaptcha", function toTCaptcha()

  {

    var _this = this;
    wx.navigateToMiniProgram({
      appId: 'wx5a3a7366fd07e119',
      path: '/pages/captcha/index',
      envVersion: 'release',
      extraData: {
        appId: this.forums.qcloud.qcloud_captcha_app_id //您申请的验证码的 appId
      },
      success: function success(res) {
        // 验证码成功打开
      },
      fail: function fail(err) {
        uni.hideLoading();
        _this.postLoading = false;
      } });


    // h5内发布按钮验证码验证
















  }), _defineProperty(_objectSpread2, "changeAvatar", function changeAvatar()

  {
    uni.navigateTo({ url: '/pages/user/at-member?name=select' });
  }), _objectSpread2)),

  onLoad: function onLoad(option) {var _this18 = this;
    console.log(option, 'optionopton');
    if (option.type === '5') {
      this.payNum[0].name = this.i18n.t('discuzq.post.noReward');
    }
    this.categoryid = option.categoryId;
    this.categoryindex = option.categoryIndex;
    uni.$on('radioChange', function (item) {
      _this18.beUserName = item.username;
      _this18.beAskId = item.id;
      _this18.userImage = item.avatarUrl;
    });
    if (this.forums && this.forums.other) {
      this.canUploadAttachment = this.forums.other.can_upload_attachments;
    }
    // 问答编辑不显示提问价格
    if (this.forums && this.forums.paycenter) {
      if (option.operating === 'edit' || !this.forums.paycenter.wxpay_close) {
        this.askingPrice = false;
      } else {
        // 初始化默认内容附件均免费
        this.showPayType = this.i18n.t('discuzq.post.TheContentAndTheAccessoriesIsFree');
      }
    }

    if (option.type) this.type = Number(option.type);

    var data = uni.getSystemInfoSync();
    if (data.platform === 'ios' && this.type === 5) {
      this.askingPrice = false;
      // this.postClick = true;
    }

















    this.url = _const.DISCUZ_REQUEST_HOST;
    var token = uni.getStorageSync('access_token');
    this.header = {
      authorization: "Bearer ".concat(token) };

    this.formData = {
      type: 1 };

    this.getCategories();
    if (option.operating) this.operating = option.operating;
    if (option.threadId) this.threadId = option.threadId;
    if (option.categoryIndex) {
      if (option.categoryIndex === '0') {
        this.categoryIndex = '';
      } else {
        this.categoryIndex = Number(option.categoryIndex);
      }
    }
    if (option.categoryId)
    this.categoryId = Number(option.categoryId) === 0 ? '' : Number(option.categoryId);
    this.textAreaLength = Number(option.type) === 1 ? 49999 : 5000;
    if (this.operating === 'edit') {
      this.loadStatus = false;
      this.getPostThread(option);
    } else {
      this.loadStatus = true;
      if (option.name) {
        var currentPosition = {};
        var _data = option.latng.split(',');
        currentPosition.longitude = _data[1];
        currentPosition.latitude = _data[0];
        currentPosition.location = option.name;
        currentPosition.address = option.addr;
        this.currentPosition = currentPosition;
      }
    }
    try {
      var res = uni.getSystemInfoSync();
      if (
      this.forums &&
      this.forums.paycenter.wxpay_close &&
      this.forums.other.can_create_thread_paid)
      {

        if (res.platform === 'ios') {
          // if (this.forums.paycenter.wxpay_ios === false) {
          //   this.showHidden = false;
          // } else {
          //   this.showHidden = true;
          // }
          this.ioshide = false;
        } else {
          this.ioshide = true;
          this.showHidden = true;
        }





      } else {
        this.ioshide = false;
        this.showHidden = false;
      }
    } catch (e) {
      // error
    }

    this.markdownShow = false;






    // 接受验证码captchaResult
    this.$u.event.$on('captchaResult', function (result) {
      _this18.ticket = result.ticket;
      _this18.randstr = result.randstr;
      _this18.postClick();
    });
    this.$u.event.$on('closeChaReault', function () {
      _this18.postLoading = false;
      uni.hideLoading();
    });
    uni.$on('clickTopic', function (data) {
      if (data.keywords)
      _this18.textAreaValue = "".concat(_this18.textAreaValue.slice(0, _this18.cursor), "  #").concat(data.keywords.replace(
      /\s+/g,
      ''), "#").concat(
      _this18.textAreaValue.slice(_this18.cursor), "  ");
      _this18.cursor = _this18.textAreaValue ? _this18.textAreaValue.length : 0;
    });
    if (this.type === 6) {
      this.goodsId = option.goodsId;
      console.log(option, this.goodsId, '这是参数');
    }
    if (
    this.type === 6 && option.operating !== 'edit' && option.threadId !== '' && this.goodsId ||
    this.type === 6 && this.goodsId)
    {
      this.getGoodsInfo();
    }
    // 接收来自首页的数据，并渲染或者报错时提示
    if (this.type === 2 || this.type === 3) {
      var eventChannel = this.getOpenerEventChannel();
      eventChannel.on('acceptDataFromOpenerPage', function (attachments) {
        if (_this18.type === 3) {
          attachments.map(function (item) {
            // eslint-disable-next-line
            // 当首页上传图片成功时
            _this18.uploadFile.push({
              type: 'attachments',
              id: item.data.id,
              order: item.data.attributes.order,
              name: item.data.attributes.fileName,
              url: item.data.attributes.url,
              path: item.data.attributes.thumbUrl ? item.data.attributes.thumbUrl : '' });

            _this18.filePreview.push({
              path: item.data.attributes.thumbUrl,
              id: item.data.id,
              order: item.data.attributes.order,
              name: item.data.attributes.fileName,
              url: item.data.attributes.url });

          });
          _this18.addImg();
        }
        if (_this18.type === 2) {
          if (attachments.data) {
            if (attachments.data.doneResult) {
              _this18.fileId = attachments.data.doneResult.fileId;
            } else {
              _this18.fileId = attachments.data.result.fileId;
            }
            _this18.videoBeforeList.push({
              path: attachments.data.uploadVideoRes.tempFilePath });

            _this18.chooseType = 0;
            _this18.percent = 1;
            // console.log(this.videoBeforeList, '这是视频列表');
          }
        }
      });
    }
  },
  onShow: function onShow() {
    var atMemberList = '';
    this.getAtMemberData.map(function (item) {
      atMemberList += "@".concat(item.username, " ");
      return atMemberList;
    });
    this.textAreaValue = "".concat(this.textAreaValue.slice(0, this.cursor) +
    atMemberList +
    this.textAreaValue.slice(this.cursor));
    this.setAtMember([]);
    this.cursor = this.textAreaValue ? this.textAreaValue.length : 0;
    if (!this.threadId) {
      this.setThread();
    }
  },
  onReady: function onReady() {
    this.videoContext = uni.createVideoContext('video');
  },
  onUnload: function onUnload() {
    this.$u.event.$off('captchaResult');
    this.$u.event.$off('closeChaReault');
    this.$u.event.$off('radioChange');
    this.$u.event.$off('radioEditChange');





    // 隐藏验证码
    if (this.captcha) {
      this.captcha.destroy();
    }
    clearInterval(payWechat);
    clearInterval(payPhone);
  } };exports.default = _default;
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 1)["default"]))

/***/ }),

/***/ 671:
/*!****************************************************************************************************************!*\
  !*** E:/wamp/www/hi-hupai-wechat-pro/topic/post.vue?vue&type=style&index=0&id=24ed4ce4&lang=scss&scoped=true& ***!
  \****************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _G_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_G_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_G_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_G_HBuilderX_plugins_uniapp_cli_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_style_index_0_id_24ed4ce4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./post.vue?vue&type=style&index=0&id=24ed4ce4&lang=scss&scoped=true& */ 672);
/* harmony import */ var _G_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_G_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_G_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_G_HBuilderX_plugins_uniapp_cli_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_style_index_0_id_24ed4ce4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_G_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_G_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_G_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_G_HBuilderX_plugins_uniapp_cli_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_style_index_0_id_24ed4ce4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _G_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_G_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_G_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_G_HBuilderX_plugins_uniapp_cli_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_style_index_0_id_24ed4ce4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _G_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_G_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_G_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_G_HBuilderX_plugins_uniapp_cli_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_style_index_0_id_24ed4ce4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_G_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_G_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_G_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_G_HBuilderX_plugins_uniapp_cli_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_post_vue_vue_type_style_index_0_id_24ed4ce4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 672:
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/wamp/www/hi-hupai-wechat-pro/topic/post.vue?vue&type=style&index=0&id=24ed4ce4&lang=scss&scoped=true& ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ })

},[[665,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../.sourcemap/mp-weixin/topic/post.js.map