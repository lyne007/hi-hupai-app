(global["webpackJsonp"] = global["webpackJsonp"] || []).push([["topic/index"],{

/***/ 673:
/*!************************************************************************!*\
  !*** E:/wamp/www/hi-hupai-wechat-pro/main.js?{"page":"topic%2Findex"} ***!
  \************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(createPage) {__webpack_require__(/*! uni-pages */ 4);
var _vue = _interopRequireDefault(__webpack_require__(/*! vue */ 2));
var _index = _interopRequireDefault(__webpack_require__(/*! ./topic/index.vue */ 674));function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}
createPage(_index.default);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 1)["createPage"]))

/***/ }),

/***/ 674:
/*!*******************************************************!*\
  !*** E:/wamp/www/hi-hupai-wechat-pro/topic/index.vue ***!
  \*******************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _index_vue_vue_type_template_id_1ebd8ed4_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index.vue?vue&type=template&id=1ebd8ed4&scoped=true& */ 675);
/* harmony import */ var _index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index.vue?vue&type=script&lang=js& */ 677);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _index_vue_vue_type_style_index_0_id_1ebd8ed4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./index.vue?vue&type=style&index=0&id=1ebd8ed4&lang=scss&scoped=true& */ 680);
/* harmony import */ var _G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */ 15);

var renderjs





/* normalize component */

var component = Object(_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__["default"])(
  _index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _index_vue_vue_type_template_id_1ebd8ed4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"],
  _index_vue_vue_type_template_id_1ebd8ed4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  "1ebd8ed4",
  null,
  false,
  _index_vue_vue_type_template_id_1ebd8ed4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["components"],
  renderjs
)

component.options.__file = "topic/index.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ 675:
/*!**************************************************************************************************!*\
  !*** E:/wamp/www/hi-hupai-wechat-pro/topic/index.vue?vue&type=template&id=1ebd8ed4&scoped=true& ***!
  \**************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_template_id_1ebd8ed4_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=1ebd8ed4&scoped=true& */ 676);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_template_id_1ebd8ed4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_template_id_1ebd8ed4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return _G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_template_id_1ebd8ed4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["recyclableRender"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "components", function() { return _G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_16_0_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_template_id_1ebd8ed4_scoped_true___WEBPACK_IMPORTED_MODULE_0__["components"]; });



/***/ }),

/***/ 676:
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/wamp/www/hi-hupai-wechat-pro/topic/index.vue?vue&type=template&id=1ebd8ed4&scoped=true& ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return recyclableRender; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "components", function() { return components; });
var components
try {
  components = {
    quiPage: function() {
      return Promise.all(/*! import() | components/qui-page/qui-page */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-page/qui-page")]).then(__webpack_require__.bind(null, /*! @/components/qui-page/qui-page.vue */ 682))
    },
    quiTopicContent: function() {
      return Promise.all(/*! import() | components/qui-topic-content/qui-topic-content */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-topic-content/qui-topic-content")]).then(__webpack_require__.bind(null, /*! @/components/qui-topic-content/qui-topic-content.vue */ 833))
    },
    quiIcon: function() {
      return __webpack_require__.e(/*! import() | components/qui-icon/qui-icon */ "components/qui-icon/qui-icon").then(__webpack_require__.bind(null, /*! @/components/qui-icon/qui-icon.vue */ 766))
    },
    quiPersonList: function() {
      return __webpack_require__.e(/*! import() | components/qui-person-list/qui-person-list */ "components/qui-person-list/qui-person-list").then(__webpack_require__.bind(null, /*! @/components/qui-person-list/qui-person-list.vue */ 848))
    },
    quiBeAsk: function() {
      return __webpack_require__.e(/*! import() | components/qui-be-ask/qui-be-ask */ "components/qui-be-ask/qui-be-ask").then(__webpack_require__.bind(null, /*! @/components/qui-be-ask/qui-be-ask.vue */ 1033))
    },
    quiAnswer: function() {
      return Promise.all(/*! import() | components/qui-answer/qui-answer */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-answer/qui-answer")]).then(__webpack_require__.bind(null, /*! @/components/qui-answer/qui-answer.vue */ 1040))
    },
    quiPaymentVisible: function() {
      return __webpack_require__.e(/*! import() | components/qui-payment-visible/qui-payment-visible */ "components/qui-payment-visible/qui-payment-visible").then(__webpack_require__.bind(null, /*! @/components/qui-payment-visible/qui-payment-visible.vue */ 1047))
    },
    quiDropDown: function() {
      return __webpack_require__.e(/*! import() | components/qui-drop-down/qui-drop-down */ "components/qui-drop-down/qui-drop-down").then(__webpack_require__.bind(null, /*! @/components/qui-drop-down/qui-drop-down.vue */ 855))
    },
    quiTopicComment: function() {
      return Promise.all(/*! import() | components/qui-topic-comment/qui-topic-comment */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-topic-comment/qui-topic-comment")]).then(__webpack_require__.bind(null, /*! @/components/qui-topic-comment/qui-topic-comment.vue */ 862))
    },
    quiLoadMore: function() {
      return __webpack_require__.e(/*! import() | components/qui-load-more/qui-load-more */ "components/qui-load-more/qui-load-more").then(__webpack_require__.bind(null, /*! @/components/qui-load-more/qui-load-more.vue */ 792))
    },
    uniPopup: function() {
      return __webpack_require__.e(/*! import() | components/uni-popup/uni-popup */ "components/uni-popup/uni-popup").then(__webpack_require__.bind(null, /*! @/components/uni-popup/uni-popup.vue */ 724))
    },
    quiButton: function() {
      return __webpack_require__.e(/*! import() | components/qui-button/qui-button */ "components/qui-button/qui-button").then(__webpack_require__.bind(null, /*! @/components/qui-button/qui-button.vue */ 812))
    },
    quiReport: function() {
      return __webpack_require__.e(/*! import() | components/qui-report/qui-report */ "components/qui-report/qui-report").then(__webpack_require__.bind(null, /*! @/components/qui-report/qui-report.vue */ 883))
    },
    quiPay: function() {
      return Promise.all(/*! import() | components/qui-pay/qui-pay */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-pay/qui-pay")]).then(__webpack_require__.bind(null, /*! @/components/qui-pay/qui-pay.vue */ 752))
    },
    quiLoadingCover: function() {
      return __webpack_require__.e(/*! import() | components/qui-loading-cover/qui-loading-cover */ "components/qui-loading-cover/qui-loading-cover").then(__webpack_require__.bind(null, /*! @/components/qui-loading-cover/qui-loading-cover.vue */ 759))
    },
    quiToast: function() {
      return __webpack_require__.e(/*! import() | components/qui-toast/qui-toast */ "components/qui-toast/qui-toast").then(__webpack_require__.bind(null, /*! @/components/qui-toast/qui-toast.vue */ 745))
    },
    quiEmoji: function() {
      return __webpack_require__.e(/*! import() | components/qui-emoji/qui-emoji */ "components/qui-emoji/qui-emoji").then(__webpack_require__.bind(null, /*! @/components/qui-emoji/qui-emoji.vue */ 869))
    },
    quiUploader: function() {
      return Promise.all(/*! import() | components/qui-uploader/qui-uploader */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-uploader/qui-uploader")]).then(__webpack_require__.bind(null, /*! @/components/qui-uploader/qui-uploader.vue */ 876))
    },
    uLoading: function() {
      return __webpack_require__.e(/*! import() | components/u-loading/u-loading */ "components/u-loading/u-loading").then(__webpack_require__.bind(null, /*! @/components/u-loading/u-loading.vue */ 890))
    },
    quiPageMessage: function() {
      return Promise.all(/*! import() | components/qui-page-message/qui-page-message */[__webpack_require__.e("common/vendor"), __webpack_require__.e("components/qui-page-message/qui-page-message")]).then(__webpack_require__.bind(null, /*! @/components/qui-page-message/qui-page-message.vue */ 780))
    }
  }
} catch (e) {
  if (
    e.message.indexOf("Cannot find module") !== -1 &&
    e.message.indexOf(".vue") !== -1
  ) {
    console.error(e.message)
    console.error("1. 排查组件名称拼写是否正确")
    console.error(
      "2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"
    )
    console.error(
      "3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件"
    )
  } else {
    throw e
  }
}
var render = function() {
  var _vm = this
  var _h = _vm.$createElement
  var _c = _vm._self._c || _h
  var m0 =
    _vm.loaded && _vm.answerPay
      ? _vm.handleGroup(
          _vm.thread.question.beUser.groups && _vm.thread.question.beUser.groups
        )
      : null
  var a0 = _vm.loaded
    ? {
        contentdown: _vm.c.contentdown,
        contentrefresh: _vm.c.contentrefresh,
        contentnomore: _vm.contentnomoreVal
      }
    : null
  var m1 = _vm.loaded && _vm.footerShow ? _vm.detectionModel() : null
  var g0 = _vm.loaded ? _vm.i18n.t("discuzq.post.cancel") : null
  var g1 =
    _vm.loaded && _vm.customAmountStatus ? _vm.i18n.t("discuzq.close") : null
  var g2 =
    _vm.loaded && _vm.customAmountStatus ? _vm.i18n.t("discuzq.ok") : null
  var m2 =
    _vm.loaded && _vm.payShowStatus ? Number(_vm.user.walletBalance) : null

  if (!_vm._isMounted) {
    _vm.e0 = function($event) {
      _vm.emojiShow = !_vm.emojiShow
    }

    _vm.e1 = function($event) {
      _vm.publishClickStatus && _vm.publishClick()
    }
  }

  _vm.$mp.data = Object.assign(
    {},
    {
      $root: {
        m0: m0,
        a0: a0,
        m1: m1,
        g0: g0,
        g1: g1,
        g2: g2,
        m2: m2
      }
    }
  )
}
var recyclableRender = false
var staticRenderFns = []
render._withStripped = true



/***/ }),

/***/ 677:
/*!********************************************************************************!*\
  !*** E:/wamp/www/hi-hupai-wechat-pro/topic/index.vue?vue&type=script&lang=js& ***!
  \********************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _G_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js& */ 678);
/* harmony import */ var _G_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_G_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _G_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _G_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_G_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_12_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 678:
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/wamp/www/hi-hupai-wechat-pro/topic/index.vue?vue&type=script&lang=js& ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(uni) {Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;






























































































































































































































































































































































































































































































































































































































































var _index = __webpack_require__(/*! @/library/jsonapi-vuex/index */ 22);
var _vuex = __webpack_require__(/*! vuex */ 21);
var _const = __webpack_require__(/*! @/common/const */ 12);
var _user = _interopRequireDefault(__webpack_require__(/*! @/mixin/user */ 145));
var _forums = _interopRequireDefault(__webpack_require__(/*! @/mixin/forums */ 144));
var _detectionModel = _interopRequireDefault(__webpack_require__(/*! @/mixin/detectionModel */ 146));
var _loginModule = _interopRequireDefault(__webpack_require__(/*! @/mixin/loginModule */ 147));







var _getCurUrl = __webpack_require__(/*! @/utils/getCurUrl */ 308);
var _uniCopy = _interopRequireDefault(__webpack_require__(/*! @/common/uni-copy */ 679));function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}function _toConsumableArray(arr) {return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();}function _nonIterableSpread() {throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(o, minLen) {if (!o) return;if (typeof o === "string") return _arrayLikeToArray(o, minLen);var n = Object.prototype.toString.call(o).slice(8, -1);if (n === "Object" && o.constructor) n = o.constructor.name;if (n === "Map" || n === "Set") return Array.from(o);if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);}function _iterableToArray(iter) {if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter);}function _arrayWithoutHoles(arr) {if (Array.isArray(arr)) return _arrayLikeToArray(arr);}function _arrayLikeToArray(arr, len) {if (len == null || len > arr.length) len = arr.length;for (var i = 0, arr2 = new Array(len); i < len; i++) {arr2[i] = arr[i];}return arr2;}function ownKeys(object, enumerableOnly) {var keys = Object.keys(object);if (Object.getOwnPropertySymbols) {var symbols = Object.getOwnPropertySymbols(object);if (enumerableOnly) symbols = symbols.filter(function (sym) {return Object.getOwnPropertyDescriptor(object, sym).enumerable;});keys.push.apply(keys, symbols);}return keys;}function _objectSpread(target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i] != null ? arguments[i] : {};if (i % 2) {ownKeys(Object(source), true).forEach(function (key) {_defineProperty(target, key, source[key]);});} else if (Object.getOwnPropertyDescriptors) {Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));} else {ownKeys(Object(source)).forEach(function (key) {Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));});}}return target;}function _defineProperty(obj, key, value) {if (key in obj) {Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });} else {obj[key] = value;}return obj;}var uniPopupDialog = function uniPopupDialog() {__webpack_require__.e(/*! require.ensure | components/uni-popup/uni-popup-dialog */ "components/uni-popup/uni-popup-dialog").then((function () {return resolve(__webpack_require__(/*! @/components/uni-popup/uni-popup-dialog */ 773));}).bind(null, __webpack_require__)).catch(__webpack_require__.oe);};

var payWechat = null;
var payPhone = null;
var isOnPaidAttachment = true;var _default =

{
  components: { uniPopupDialog: uniPopupDialog },
  mixins: [
  _user.default,
  _forums.default,
  _loginModule.default,



  _detectionModel.default],




  data: function data() {
    return {
      imageList: [],
      navTitle: '内容详情页', // 导航栏标题
      threadId: '', // 主题id
      // userId: 57, //当前用户Id
      // userInfo: '', //当前用户信息
      // thread: {}, //主题数据
      loadDetailStatusId: 0, // 主题接口请求状态
      // topicStatus: 1, // 0 是不合法 1 是合法 2 是忽略
      posts: [], // 评论列表数据
      loadingType: 'more', // 上拉加载状态
      scrollTop: 0,
      pageNum: 1, // 这是主题回复当前页数
      pageSize: 20, // 这是主题回复每页数据条数
      payThreadTypeText: '', // 主题支付类型不同，支付按钮文字显示不同的支付提示
      loadDetailCommnetStatusId: 0,
      postIndex: '', // 点击主题评论时的index
      footerShow: true, // 默认显示底部
      commentShow: false, // 显示评论
      commentPopupStatus: false, // 回复弹框内容状态是否显示
      commentWorkTips: true, // 回复弹框是否显示字数
      commentText: true, // 回复弹框默认字
      maxTextLength: 5000, // 默认最多输入5000字
      cursor: 0, // 光标位置
      textAreaValue: '', // 评论输入框
      barStatus: false, // 是否显示输入框获取焦点时完成的那一栏
      uploadFile: [], // 上传的文件
      isLiked: false, // 主题点赞状态
      role: '管理员',
      isActive: true,
      shareShow: false, // h5微信分享
      beAsk: false, // 是否显示回答问题按钮
      answerPay: false, // 支付答案
      payment: false, // 支付可见
      questionId: '', // 回答问题ID
      beAskDate: 0, // 回答即可获得
      beAskBeDate: 0, // 每次回答可获得
      platformDate: 0, // 平台获得
      onLookformDate: 0, // 围观平台获得
      bottomData: [
      {
        text: this.i18n.t('core.generatePoster'),
        icon: 'icon-poster',
        name: 'wx' },

      {
        text: this.i18n.t('core.wxShare'),
        icon: 'icon-wx-friends',
        name: 'wxFriends' }],

      // 分享方式

      seleShow: false, // 默认收起管理菜单
      selectList: [
      { text: this.i18n.t('topic.edit'), type: '0' },
      { text: this.i18n.t('topic.essence'), type: '2' },
      { text: this.i18n.t('topic.sticky'), type: '3' },
      { text: this.i18n.t('topic.delete'), type: '4' }],
      // 管理菜单

      limitShowNum: 12,
      paidStatus: false, // 是否有已支付数据
      paidBtnStatus: false, // 支付按钮是否显示（在ios里不显示，已支付主题后不显示）
      rewardBtnStatus: false, // 打赏按钮是否显示（在ios里不显示，付费主题不显示）
      rewardStatus: false, // 是否已有打赏数据
      likedStatus: false, // 是否已有点赞数据
      commentStatus: {}, // 回复状态
      commentReply: false, // 发布的是否是回复的回复
      commentAnser: false, // 发布是否是回答问题
      emojiShow: false, // 表情组件显示状态
      // uploaderShow: false, //图片上传组件显示状态
      publishClickStatus: true, // 发布按钮点击状态
      focusVal: true, // 默认输入框获取焦点状态
      header: {},
      formData: {}, // 图片请求data
      commentId: '', // 评论id
      isAnonymous: '0', // 支付时是否显示头像，默认不显示
      payTypeText: '',
      payTypeVal: 0, // 点击的支付类型， 0主题支付  1主题打赏 2围观支付

      payNum: [
      {
        name: '￥1',
        pay: 1.0 },

      {
        name: '￥2',
        pay: 2.0 },

      {
        name: '￥5',
        pay: 5.0 },

      {
        name: '￥10',
        pay: 10.0 },

      {
        name: '￥20',
        pay: 20.0 },

      {
        name: '￥50',
        pay: 50.0 },

      {
        name: '￥88',
        pay: 88.0 },

      {
        name: '￥128',
        pay: 128.0 },

      {
        name: this.i18n.t('discuzq.post.customize'),
        pay: '0' }],

      // 打赏金额数组列表
      payNumCheck: [
      {
        name: '',
        pay: '' }],


      price: 0.0, // 需要支付的金额
      inputPrice: 0, // 自定义金额输入框的值
      maxLength: 7, //输入框最大长度
      payShowStatus: true, // 是否显示支付
      pwdVal: '', // 支付密码
      orderSn: '', // 订单编号
      payStatus: false, // 订单支付状态
      coverLoading: false, // loading显示状态
      payTypeData: [
      {
        name: '微信支付',
        icon: 'icon-wxPay',
        color: '#09bb07',
        value: '0' },

      {
        name: '钱包支付',
        icon: 'icon-walletPay',
        color: '#1878f3',
        value: '1' }],

      // 支付方式
      currentReplyPost: {},
      contentnomoreVal: '',
      url: '',
      customAmountStatus: false, // 自定义价格弹框初始化状态
      windowHeight: '', // 设备高度
      system: '', // 设备系统
      detectionmodel: '', // 站点模式
      paymentmodel: false, // 是否付费
      loaded: false,
      loadingStatus: true,
      isWeixin: false,
      isPhone: false,
      qrcodeShow: false, // 二维码弹框
      codeUrl: '', // 二维码支付url，base64
      browser: 0, // 0为小程序，1为除小程序之外的设备
      wxRes: '',
      contentVal: '', // 这是分享需要传的标题
      shareLogo: '', // 这是分享需要传的图片
      desc: '', // 这是分享需要传的描述
      rewardedUsers: [],
      likedUsers: [],
      sortSeleShow: false, // 排序菜单状态
      sortSelectList: [
      { text: this.i18n.t('topic.sortTimeSequence'), type: '0', canOpera: true },
      { text: this.i18n.t('topic.sortTimeReverse'), type: '1', canOpera: true }],
      // 评论排序菜单
      sortVal: 'createdAt', // 排序值
      refreshVal: true, // 是否刷新
      deleteId: '', // 删除时的Id（包括主题id，评论Id，和图片id）
      deleteType: '', // 删除时的类型，3为主题评论删除，4为主题删除
      deletePostType: '', // 删除评论时传给请求接口的类型
      deletePostCanStatus: '', // 是否可以删除该条内容
      deletePostIsStatus: '', // 删除时的状态
      deletePost: '', // 删除时的整个post数据
      deleteIndex: '', // 删除图片时的Index
      deleteTip: '确定删除吗？', // 删除提示
      wechatTip: this.i18n.t('discuzq.wechatBind'), // 微信绑定提示
      deleteImgId: '', // 删除时图片Id
      followStatus: '', // 当前关注状态
      beRewarded: false,
      curUrl: '', // 当前页面的路由
      bottom: '',
      moreData: [
      // 更多操作
      {
        text: this.i18n.t('topic.edit'),
        icon: 'icon-bianji',
        name: 'edit',
        type: '0',
        canOpera: true },

      {
        text: this.i18n.t('topic.delete'),
        icon: 'icon-shanchu',
        name: 'delete',
        type: '4',
        canOpera: true },

      {
        text: this.i18n.t('topic.essence'),
        icon: 'icon-jinghua',
        name: 'essence',
        type: '2',
        canOpera: true },

      {
        text: this.i18n.t('topic.sticky'),
        icon: 'icon-zhiding',
        name: 'sticky',
        type: '3',
        canOpera: true },

      {
        text: this.i18n.t('topic.collection'),
        icon: 'icon-collection',
        name: 'collection',
        type: '5',
        canOpera: true },

      {
        text: this.i18n.t('topic.share'),
        icon: 'icon-share',
        name: 'share',
        type: '6',
        canOpera: true },

      {
        text: this.i18n.t('core.generatePoster'),
        icon: 'icon-poster',
        name: 'poster',
        type: '7',
        canOpera: true },

      {
        text: this.i18n.t('core.wxShare'),
        icon: 'icon-wx-friends',
        name: 'wxFriends',
        type: '8',
        canOpera: true },

      {
        text: this.i18n.t('report.reportTitle'),
        icon: 'icon-jubao',
        name: 'report',
        type: '9',
        canOpera: true }],


      moreDataLength: 0,
      conversationId: '', // 话题id
      attachmentFileList: [], // 附件列表
      refreshStatus: true, // 是否刷新
      threadIsPaidCover: false, // 付费主题显示遮盖层
      token: '', // token
      postGoodsStatus: false };

  },
  onUnload: function onUnload() {
    this.$store.dispatch('forum/setError', { loading: false });
    uni.$off('logind');
  },
  computed: _objectSpread(_objectSpread({},
  (0, _vuex.mapState)({
    getAtMemberData: function getAtMemberData(state) {return state.atMember.atMemberData;} })), {}, {

    thread: function thread() {
      var thread = this.$store.getters['jv/get']("threads/".concat(this.threadId));
      // 只保留一个用户组显示
      var hasFirst = false;
      if (thread.user && thread.user.groups && thread.user.groups.length > 0) {
        thread.user.groups = thread.user.groups.filter(function (group) {
          if (group.isDisplay === true && !hasFirst) {
            hasFirst = true;
            return true;
          }
        });
      }
      if (thread.rewardedUsers) {
        this.rewardedUsers = thread.rewardedUsers;
      }
      if (thread.firstPost) {
        this.likedUsers = thread.firstPost.likedUsers;
        if (thread.firstPost.images) {
          thread.firstPost.images = thread.firstPost.images.filter(function (item) {
            if (thread.firstPost.contentAttachIds.indexOf(item._jv.id) !== -1) {
              return false;
            }
            return true;
          });
        }

        if (thread.firstPost.attachments) {
          thread.firstPost.attachments = thread.firstPost.attachments.filter(function (item) {
            if (thread.firstPost.contentAttachIds.indexOf(item._jv.id) !== -1) {
              return false;
            }
            return true;
          });
        }
      }
      return thread;
    },
    // 语言包
    // topic详情页语言包
    t: function t() {
      return this.i18n.t('topic');
    },
    // pay支付语言包
    p: function p() {
      return this.i18n.t('pay');
    },
    // core公共变量语言包
    c: function c() {
      return this.i18n.t('core');
    },
    status: function status() {
      return _index.status.status;
    },
    themeColor: function themeColor() {
      return this.theme === this.$u.light() ? '#333' : '#fff'; //  用于图标色
    },
    currentLoginId: function currentLoginId() {
      var userId = this.$store.getters['session/get']('userId');
      return parseInt(userId, 10);
    } }),

  onLoad: function onLoad(option) {var _this2 = this;
    var res = uni.getSystemInfoSync();
    this.system = res.platform;
    if (this.forums && this.forums.set_site && this.forums.set_site.site_mode) {
      this.detectionmodel = this.forums.set_site.site_mode;
    }
    if (this.forums && this.forums.paycenter && this.forums.paycenter.wxpay_ios) {
      this.paymentmodel = this.forums.paycenter.wxpay_ios;
    }


    if (this.detectionmodel === 'public' && this.system === 'ios') {
      this.paidStatus = false;
      this.paidBtnStatus = false;
      this.rewardBtnStatus = false;
      this.rewardStatus = false;
    }
    if (this.detectionmodel === 'pay' && this.system === 'ios') {
      this.$store.dispatch('forum/setError', { loading: false, code: 'dataerro' });
      return;
    }

    this.token = uni.getStorageSync('access_token');
    uni.$on('logind', function () {
      _this2.loadThread();
      _this2.loadThreadPosts();
    });
    this.threadId = option.id;
    this.conversationId = option.topicid || '';
    this.loadThread();
    this.loadThreadPosts();
    this.curUrl = (0, _getCurUrl.getCurUrl)();
    this.rewardStatus = false;
    this.paidStatus = false;

    wx.showShareMenu({
      withShareTicket: true,
      menus: ['shareAppMessage', 'shareTimeline'] });







    // 评论详情页新增一条回复，内容详情页给当前评论新增一条回复
    this.$u.event.$on('addComment', function (data) {
      Object.keys(_this2.posts).forEach(function (index) {
        if (_this2.posts[index]._jv.id === data.commentId) {
          if (_this2.posts[index].lastThreeComments.length >= 3) {
            _this2.posts[index].lastThreeComments.pop();
          }
          if (data.data) {
            _this2.posts[index].lastThreeComments.unshift(data.data);
          }
        }
      });
    });
    // 删除评论的回复后清除当前列表评论的这条回复
    this.$u.event.$on('deleteComment', function (data) {
      Object.keys(_this2.posts).forEach(function (index) {
        // for (const index in this.posts) {
        if (_this2.posts[index]._jv.id === data.commentId) {
          _this2.posts[index].lastThreeComments = [];
          if (data.data._jv.json.data.relationships.lastThreeComments.data) {
            data.data._jv.json.data.relationships.lastThreeComments.data.forEach(function (item) {
              _this2.posts[index].lastThreeComments.push(
              _this2.$store.getters['jv/get']("".concat(item.type, "/").concat(item.id)));

            });
          }
          // break;
        }
      });
    });

    this.url = _const.DISCUZ_REQUEST_HOST;
    var token = uni.getStorageSync('access_token');

    this.header = {
      authorization: "Bearer ".concat(token) };

    this.formData = {
      type: 1 // 上传图片类型 1:图片 5: 问答图片
    };

    // 编辑发帖回来后更新信息
    this.$u.event.$on('refreshFiles', function () {
      _this2.loadThread();
    });
  },
  // 下拉刷新
  onPullDownRefresh: function onPullDownRefresh() {
    var _this = this;
    _this.posts = [];
    _this.pageNum = 1;
    _this.attachmentFileList = [];
    setTimeout(function () {
      isOnPaidAttachment = true;
      _this.loadThread();
      _this.loadThreadPosts();
      uni.stopPullDownRefresh();
    }, 1000);
  },
  // 上拉加载
  onReachBottom: function onReachBottom() {
    if (this.loadingType !== 'more') {
      return;
    }
    this.pageNum += 1;
    this.loadThreadPosts();
  },
  // 监听页面滚动，参数为Object
  onPageScroll: function onPageScroll(event) {
    this.scrollTop = event.scrollTop;
  },
  // 唤起小程序原声分享
  onShareAppMessage: function onShareAppMessage(res) {
    // 来自页面内分享按钮
    if (res.from === 'button') {
      var threadShare = this.$store.getters['jv/get']("/threads/".concat(this.threadId));
      return {
        title: threadShare.type === 1 ? this.thread.title : this.thread.firstPost.summaryText };

    }
    return {
      title: this.forums.set_site.site_name };

  },
  // 分享到朋友圈
  onShareTimeline: function onShareTimeline() {
    var threadShare = this.$store.getters['jv/get']("/threads/".concat(this.threadId));
    return {
      title: threadShare.type === 1 ? this.thread.title : this.thread.firstPost.summaryText,
      query: "id=".concat(this.threadId),
      imageUrl: this.shareLogo };

  },
  onShow: function onShow() {
    var res = uni.getSystemInfoSync();
    this.system = res.platform;
    if (this.forums && this.forums.set_site && this.forums.set_site.site_mode) {
      this.detectionmodel = this.forums.set_site.site_mode;
    }
    if (this.forums && this.forums.paycenter && this.forums.paycenter.wxpay_ios) {
      this.paymentmodel = this.forums.paycenter.wxpay_ios;
    }

    if (this.detectionmodel === 'public' && this.system === 'ios') {
      this.paidStatus = false;
      this.paidBtnStatus = false;
      this.rewardBtnStatus = false;
      this.rewardStatus = false;
    }
    if (this.detectionmodel === 'pay' && this.system === 'ios') {
      this.$store.dispatch('forum/setError', { loading: false, code: 'dataerro' });
      return;
    }

    var atMemberList = '';
    this.getAtMemberData.map(function (item) {
      atMemberList += "@".concat(item.username, " ");
      return atMemberList;
    });
    this.textAreaValue = "".concat(this.textAreaValue.slice(0, this.cursor) +
    atMemberList +
    this.textAreaValue.slice(this.cursor));
    this.setAtMember([]);
  },
  methods: _objectSpread(_objectSpread({},
  (0, _vuex.mapMutations)({
    setAtMember: 'atMember/SET_ATMEMBER',
    setCategoryId: 'session/SET_CATEGORYID',
    setCategoryIndex: 'session/SET_CATEGORYINDEX',
    setFooterIndex: 'footerTab/SET_FOOTERINDEX' })), {}, {

    touchStop: function touchStop() {
      return;
    },

    // 加载当前主题数据
    loadThread: function loadThread() {var _this3 = this;
      var params = {
        include: [
        'posts.replyUser',
        'user.groups',
        'user',
        'posts',
        'posts.user',
        'posts.likedUsers',
        'posts.images',
        'firstPost',
        'firstPost.likedUsers',
        'firstPost.images',
        'firstPost.attachments',
        'firstPost.postGoods',
        'rewardedUsers',
        'category',
        'threadVideo',
        'threadAudio',
        'paidUsers',
        'user.groups.permissionWithoutCategories',
        'question',
        'onlookers',
        'question.beUser',
        'question.images'] };


      var threadAction = _index.status.run(function () {return (
          _this3.$store.dispatch('jv/get', ["threads/".concat(_this3.threadId), { params: params }]));});


      this.loadDetailStatusId = threadAction._statusID;

      threadAction.
      then(function (data) {
        _this3.$store.dispatch('session/setThread', data);
        if (data.isDeleted) {
          _this3.$store.dispatch('forum/setError', {
            code: 'thread_deleted',
            status: 500 });


          _this3.loaded = false;
        } else {
          if (data.firstPost.postGoods) {
            _this3.postGoodsStatus = true;
          } else {
            _this3.postGoodsStatus = false;
          }
          if (data.type === 1) {
            if (data.attachmentPrice > 0) {
              _this3.threadIsPaidCover = false;
            } else {
              if (data.price > 0 && data.isPaid || data.price <= 0) {
                _this3.threadIsPaidCover = false;
              } else if (data.price > 0 && !data.isPaid) {
                _this3.threadIsPaidCover = true;
              }
            }
          } else {
            _this3.threadIsPaidCover = false;
          }
          if (isOnPaidAttachment) {
            data.firstPost.attachments.forEach(function (attachment) {
              if (data.firstPost.contentAttachIds.indexOf(attachment._jv.id) === -1) {
                _this3.attachmentFileList.push(attachment);
              }
            });
          }


























          if (data.question) {
            console.log(data, 'xiangqing');
            _this3.platformDate = (
            data.question.price * (
            _this3.forums.set_site.site_master_scale / 10)).
            toFixed(2);
            _this3.onLookformDate = (
            data.question.onlooker_unit_price * (
            _this3.forums.set_site.site_master_scale / 10)).
            toFixed(2);
            _this3.beAskDate = (data.question.price - _this3.platformDate).toFixed(2);
            _this3.beAskBeDate = (
            (data.question.onlooker_unit_price - _this3.onLookformDate) /
            2).
            toFixed(2);
            // 问答免费
            if (data.question.price === '0.00') {
              // 问答免费 当前登录ID == 被提问ID && 未回答
              if (_this3.user.id === data.question.be_user_id && data.question.is_answer === 0) {
                _this3.beAsk = true;
                // 已回答
              } else if (_this3.user.id === data.user.id && data.question.is_answer === 1) {
                _this3.beAsk = false;
                _this3.payment = true;
                _this3.answerPay = false;
                console.log(data, '免费允许围观');
              } else if (
              _this3.user.id === data.question.be_user_id &&
              data.question.is_answer === 1)
              {
                _this3.beAsk = false;
                _this3.payment = true;
                _this3.answerPay = false;
              } else if (
              _this3.user.id !== data.question.be_user_id &&
              _this3.user.id !== data.user.id &&
              data.question.is_answer === 1 &&
              data.question.is_onlooker === true
              // data.onlookerState === true
              ) {
                  _this3.beAsk = false;
                  _this3.payment = false;
                  _this3.answerPay = true;
                  console.log('允许围观可查看答案');
                } else if (
              _this3.user.id !== data.question.be_user_id &&
              _this3.user.id !== data.user.id &&
              data.question.is_answer === 1 &&
              data.question.is_onlooker === false
              // data.onlookerState === false
              ) {
                  _this3.beAsk = false;
                  _this3.payment = false;
                  _this3.answerPay = true;
                  console.log('免费不设置围观也可查看答案');
                }
            } else if (data.question.price > '0.00') {
              if (_this3.user.id === data.question.be_user_id && data.question.is_answer === 0) {
                _this3.beAsk = true;
              } else if (
              _this3.user.id === data.question.be_user_id &&
              data.question.is_answer === 1)
              {
                _this3.beAsk = false;
                _this3.answerPay = true;
                console.log('显示答案');
              } else if (_this3.user.id === data.user.id && data.question.is_answer === 1) {
                _this3.beAsk = false;
                _this3.answerPay = true;
              } else if (
              _this3.user.id === data.question.be_user_id &&
              data.question.is_answer === 1 &&
              data.question.onlooker_number > 0)
              {
                _this3.answerPay = true;
                _this3.beAsk = false;
                console.log('3333344444');
              } else if (
              _this3.user.id === data.user.id &&
              data.question.is_answer === 1 &&
              data.question.onlooker_number > 0)
              {
                _this3.answerPay = true;
                _this3.beAsk = false;
              } else if (
              _this3.user.id !== data.question.be_user_id &&
              _this3.user.id !== data.user.id &&
              data.question.is_answer === 1 &&
              data.question.is_onlooker === false &&
              // this.forums.other.can_be_onlooker === true &&
              data.onlookerState === true)
              {
                _this3.answerPay = true;
                console.log('付费允许围观付费即可查看答案222222');
              } else if (
              _this3.user.id !== data.user.id &&
              data.question.is_answer === 1 &&
              data.question.is_onlooker === true &&
              // this.forums.other.can_be_onlooker === true &&
              data.onlookerState === false)
              {
                _this3.answerPay = true;
                console.log('付费不允许围观');
              } else if (
              _this3.user.id !== data.user.id &&
              _this3.user.id !== data.question.be_user_id &&
              data.question.is_onlooker === true &&
              data.question.is_answer === 1 &&
              // this.forums.other.can_be_onlooker === true &&
              data.onlookerState === true)
              {
                _this3.answerPay = true;
                console.log('付费允许围观');
              }
            }
            _this3.questionId = data.question._jv.id;
          }
          if (data.user.groups && data.user.groups.length > 0) {
            data.user.groups[0].permissionWithoutCategories.forEach(function (value, index) {
              if (value.permission === 'createThreadPaid') {
                _this3.beRewarded = true;
                return;
              }
            });
          }

          if (
          data.user.groups &&
          data.user.groups.length > 0 &&
          data.user.groups[0]._jv.id === '1')
          {
            _this3.beRewarded = true;
          }
          _this3.loaded = true;
          _this3.loadingStatus = false;
          // 分享数据
          switch (data.type) {
            case 0:
              // 文字帖
              _this3.contentVal = data.firstPost.summaryText;
              _this3.desc = data.firstPost.summaryText;
              _this3.shareLogo = '';
              break;
            case 1:
              // 长文帖
              _this3.contentVal = data.title;
              if (data.price > 0) {
                _this3.desc = data.title;
                _this3.shareLogo = '';
              } else {
                _this3.desc = data.firstPost.summaryText;
                _this3.shareLogo =
                data.firstPost.images.length > 0 ? data.firstPost.images[0].thumbUrl : '';
              }
              break;
            case 2:
              // 视频帖
              _this3.contentVal = data.firstPost.summaryText;
              _this3.desc = data.firstPost.summaryText;
              _this3.shareLogo = data.threadVideo.coverUrl;
              break;
            case 3:
              // 图片帖
              _this3.contentVal = data.firstPost.summaryText;
              _this3.desc = data.firstPost.summaryText;
              _this3.shareLogo =
              data.price == 0 && data.firstPost.images.length > 0 ?
              data.firstPost.images[0].thumbUrl :
              '';
              break;
            case 4:
              // 语音帖
              _this3.contentVal = data.firstPost.summaryText;
              _this3.desc = data.firstPost.summaryText;
              _this3.shareLogo = '';
              break;
            case 5:
              // 问答帖
              _this3.contentVal = data.firstPost.summaryText;
              _this3.desc = data.firstPost.summaryText;
              _this3.shareLogo =
              data.firstPost.images.length > 0 ? data.firstPost.images[0].thumbUrl : '';
              break;
            case 6:
              // 商品帖
              _this3.contentVal = data.firstPost.postGoods.title;
              _this3.desc = data.firstPost.summaryText;
              _this3.shareLogo = data.firstPost.postGoods.image_path;
              break;
            default:}

        }







        // 追加管理菜单权限字段
        _this3.selectList[0].canOpera = _this3.thread.firstPost.canEdit;
        _this3.selectList[1].canOpera = _this3.thread.canEssence;
        _this3.selectList[2].canOpera = _this3.thread.canSticky;
        _this3.selectList[3].canOpera = _this3.thread.canHide;

        // this.selectList[0].isStatus = true;
        _this3.selectList[1].isStatus = _this3.thread.isEssence;
        _this3.selectList[2].isStatus = _this3.thread.isSticky;
        _this3.selectList[3].isStatus = false;

        if (data.isEssence) {
          // 如果初始化状态为true
          _this3.selectList[1].text = _this3.t.cancelEssence;
        }
        if (data.isSticky) {
          // 如果初始化状态为true

          _this3.selectList[2].text = _this3.t.cancelSticky;
        }
        // 修改更多弹框权限

        _this3.moreData[5].canOpera = false;
        _this3.moreData[6].canOpera = true;
        _this3.moreData[7].canOpera = true;







        // 追加更多操作权限字段
        if (data.type === 5) {
          _this3.moreData[0].canOpera = false;
        } else {
          _this3.moreData[0].canOpera = _this3.thread.firstPost.canEdit;
        }
        _this3.moreData[2].canOpera = _this3.thread.canEssence;
        _this3.moreData[3].canOpera = _this3.thread.canSticky;
        _this3.moreData[1].canOpera = _this3.thread.canHide;
        _this3.moreData[2].isStatus = _this3.thread.isEssence;
        _this3.moreData[3].isStatus = _this3.thread.isSticky;
        _this3.moreData[1].isStatus = false;
        _this3.moreData.forEach(function (item) {
          if (item.canOpera) {
            _this3.moreDataLength += 1;
          }
        });
        if (data.isFavorite) {
          _this3.moreData[4].text = _this3.t.collectionAlready;
          _this3.moreData[4].icon = 'icon-collectioned';
        }
        if (data.isEssence) {
          // 如果初始化状态为true
          _this3.moreData[2].text = _this3.t.cancelEssence;
          _this3.moreData[2].icon = 'icon-quxiaojinghua';
        }
        if (data.isSticky) {
          // 如果初始化状态为true
          _this3.moreData[3].text = _this3.t.cancelSticky;
          _this3.moreData[3].icon = 'icon-quxiaozhiding';
        }
        _this3.isLiked = data.firstPost.isLiked;
        if (data.type === 5) {
          _this3.rewardStatus = false;
          _this3.paidStatus = false;
          return;
        } else if (!_this3.forums.paycenter.wxpay_close) {
          // 如果关闭了微信支付
          _this3.rewardStatus = false;
          _this3.paidStatus = false;
        } else if (_this3.forums.paycenter.wxpay_close) {
          var res = uni.getSystemInfoSync();
          _this3.system = res.platform;
          // 如果开启了微信支付
          if (!data.paid || data.paidUsers.length > 0) {

            if (_this3.system === 'ios') {
              if (_this3.paymentmodel === false) {
                _this3.paidStatus = false;
                _this3.paidBtnStatus = false;
              } else {
                _this3.paidStatus = true;
                _this3.paidBtnStatus = true;
              }
            } else {
              _this3.paidStatus = true;
              _this3.paidBtnStatus = true;
            }









          }
          if (data.type === 3) {
            _this3.payThreadTypeText = _this3.t.pay + data.price + _this3.t.paymentViewPicture;
          } else if (data.type === 2) {
            _this3.payThreadTypeText = _this3.t.pay + data.price + _this3.t.paymentViewVideo;
          } else if (data.type === 1) {
            if (data.attachmentPrice > 0) {
              _this3.payThreadTypeText =
              _this3.t.pay + data.attachmentPrice + _this3.t.checkTheAttachment;
            } else {
              _this3.payThreadTypeText =
              _this3.t.pay + data.price + _this3.t.paymentViewRemainingContent;
            }
            // this.payThreadTypeText = this.t.pay + data.price + this.t.paymentViewRemainingContent;
          } else if (data.type === 5) {
            _this3.payThreadTypeText = _this3.t.pay + data.price + _this3.t.paymentViewRemainingContent;
          } else if (data.type === 4) {
            _this3.payThreadTypeText = _this3.t.pay + data.price + _this3.t.paymentViewAudio;
          }

          if (data.price <= 0) {

            if (_this3.system === 'ios') {
              if (data.attachmentPrice > 0 && data.isPaidAttachment === false) {
                if (_this3.paymentmodel === false) {
                  _this3.paidStatus = false;
                  _this3.rewardStatus = false;
                } else if (_this3.paymentmodel === true) {
                  _this3.paidStatus = true;
                  _this3.rewardStatus = false;
                }
              } else if (data.attachmentPrice > 0 && data.isPaidAttachment === true) {
                if (_this3.paymentmodel === false) {
                  _this3.paidStatus = false;
                  _this3.rewardStatus = false;
                } else if (_this3.paymentmodel === true) {
                  _this3.paidStatus = true;
                  _this3.paidBtnStatus = false;
                  _this3.rewardStatus = false;
                }
              } else {
                if (_this3.paymentmodel === false) {
                  _this3.paidStatus = false;
                  _this3.rewardStatus = false;
                } else if (_this3.paymentmodel === true) {
                  if (data.canBeReward) {
                    _this3.paidStatus = false;
                    _this3.rewardStatus = true;
                    _this3.rewardBtnStatus = true;
                  } else {
                    _this3.rewardStatus = false;
                    _this3.rewardBtnStatus = false;
                  }
                }
              }
            } else {
              if (data.attachmentPrice > 0 && data.isPaidAttachment === false) {
                _this3.paidStatus = true;
                _this3.paidBtnStatus = true;
                _this3.rewardStatus = false;
                _this3.rewardBtnStatus = false;
              } else if (data.attachmentPrice > 0 && data.isPaidAttachment === true) {
                _this3.paidStatus = true;
                _this3.paidBtnStatus = false;
                _this3.rewardStatus = false;
                _this3.rewardBtnStatus = false;
              } else {
                if (data.canBeReward) {
                  _this3.paidStatus = false;
                  _this3.rewardStatus = true;
                  _this3.rewardBtnStatus = true;
                } else {
                  _this3.paidStatus = false;
                  _this3.rewardStatus = false;
                  _this3.rewardBtnStatus = false;
                }
              }
            }
























          } else {

            if (_this3.system === 'ios') {
              if (_this3.paymentmodel === false) {
                _this3.paidStatus = false;
                _this3.paidBtnStatus = false;
              } else if (_this3.paymentmodel === true && data.paid === false) {
                _this3.paidStatus = true;
                _this3.paidBtnStatus = true;
              } else if (_this3.paymentmodel === true && data.paid === true) {
                _this3.paidStatus = true;
                _this3.paidBtnStatus = false;
              }
            } else {
              if (data.paid === true) {
                _this3.paidBtnStatus = false;
              } else {
                _this3.paidStatus = true;
                _this3.paidBtnStatus = true;
              }
            }

            _this3.rewardStatus = false;
            _this3.rewardBtnStatus = false;







          }
        } else {
          _this3.rewardStatus = false;
          _this3.paidBtnStatus = false;
        }

        if (data.firstPost.likedUsers.length < 1) {
          _this3.likedStatus = false;
        } else {
          _this3.likedStatus = true;
        }
      }).
      catch(function (err) {
        _this3.loaded = false;
        _this3.loadingStatus = false;
        console.log(err);
        if (err.statusCode === 404) {
          _this3.$store.dispatch('forum/setError', {
            code: 'type_404',
            status: 500 });

        }
      });
    },
    // post操作调用接口（包括type 1主题点赞，3删除回复，4回复点赞）
    postOpera: function postOpera(id, type, canStatus, isStatus, post) {var _this4 = this;
      if (type === '1' && !canStatus) {
        // 没有主题点赞权限
        this.$refs.toast.show({ message: this.t.noThreadLikePermission });
        return;
      }
      if (type === '4' && !canStatus) {
        // 没有评论点赞权限
        this.$refs.toast.show({ message: this.t.noReplyLikePermission });
        return;
      }
      var jvObj = {
        type: 'posts',
        id: id };

      var params = {};
      if (type === '1') {
        params = {
          _jv: jvObj,
          isLiked: !isStatus };

      } else if (type === '3') {
        params = {
          _jv: jvObj,
          isDeleted: !isStatus };

      } else if (type === '4') {
        params = {
          _jv: jvObj,
          isLiked: !isStatus };

      }
      this.$store.
      dispatch('jv/patch', params).
      then(function (data) {
        if (type === '1') {
          // 主题点赞
          _this4._updateLikedUsers(data.isLiked);
        } else if (type === '2') {
          if (data.isDeleted) {
            uni.navigateBack({
              delta: 1 });


            // uni.navigateBack({
            //   url: `/pages/home/index`,
            // });
          } else {
              // 主题删除失败
            }
        } else if (type === '3') {
          var postArr = post;
          postArr.isDeleted = data.isDeleted;
          post = postArr;
        } else if (type === '4') {
          var _postArr = post;
          _postArr.isLiked = data.isLiked;
          _postArr.likeCount = data.likeCount;
          post = _postArr;
        }
      }).
      catch(function (err) {
        console.log(err);
      });
    },
    // 主题其他操作调用接口（包括 type 1主题收藏，2主题加精，3主题置顶，else删除主题）
    threadOpera: function threadOpera(id, canStatus, isStatus, type) {var _this5 = this;
      var jvObj = {
        type: 'threads',
        id: id };

      var params = {};
      if (type === '1') {
        // 主题收藏
        params = {
          _jv: jvObj,
          isFavorite: !isStatus };

      } else if (type === '2') {
        // 主题加精
        params = {
          _jv: jvObj,
          isEssence: !isStatus };

      } else if (type === '3') {
        // 主题置顶
        params = {
          _jv: jvObj,
          isSticky: !isStatus };

      } else {
        // 主题删除
        params = {
          _jv: jvObj,
          isDeleted: !isStatus };

      }
      this.$store.
      dispatch('jv/patch', params).
      then(function (data) {
        if (type === '1') {
          // 收藏
          _this5.thread.isFavorite = data.isFavorite;
          if (data.isFavorite) {
            _this5.moreData[4].text = _this5.t.collectionAlready;
            _this5.moreData[4].icon = 'icon-collectioned';
          } else {
            _this5.moreData[4].text = _this5.t.collection;
            _this5.moreData[4].icon = 'icon-collection';
          }
        } else if (type === '2') {
          // 这是精华操作
          _this5.selectList[1].isStatus = data.isEssence;
          _this5.moreData[2].isStatus = data.isEssence;
          if (data.isEssence) {
            _this5.selectList[1].text = _this5.t.cancelEssence;
            _this5.moreData[2].text = _this5.t.cancelEssence;
            _this5.moreData[2].icon = 'icon-quxiaojinghua';
          } else {
            _this5.selectList[1].text = _this5.t.essence;
            _this5.moreData[2].text = _this5.t.essence;
            _this5.moreData[2].icon = 'icon-jinghua';
          }
        } else if (type === '3') {
          _this5.selectList[2].isStatus = data.isSticky;
          _this5.moreData[3].isStatus = data.isSticky;
          if (data.isSticky) {
            _this5.selectList[2].text = _this5.t.cancelSticky;
            _this5.moreData[3].icon = 'icon-quxiaozhiding';
            _this5.moreData[3].text = _this5.t.cancelSticky;
            // 详情页置顶,将首页列表中该帖子移除并添加到置顶列表中
            // 因为设置了虚拟滚动，所以将会去除所有对列表数据的操作，只会刷新才会更新现有数据
            // this.$u.event.$emit('stickyThread', data);
          } else {
            _this5.selectList[2].text = _this5.t.sticky;
            _this5.moreData[3].icon = 'icon-zhiding';
            _this5.moreData[3].text = _this5.t.sticky;
            // 详情页取消置顶,将首页置顶数据移除
            // 因为设置了虚拟滚动，所以将会去除所有对列表数据的操作，只会刷新才会更新现有数据
            // this.$u.event.$emit('cancelSticky', data);
          }
        } else if (type === '4') {
          var _this = _this5;
          if (data.isDeleted) {
            // 删除成功，跳转到首页
            _this5.$refs.toast.show({ message: _this5.t.deleteSuccessAndJumpToBack });
            var pages = getCurrentPages();
            // const delta = pages.indexOf(pages[pages.length - 1]);
            var naviBack = setTimeout(function () {
              console.log(_this.conversationId);
              if (_this.conversationId) {
                uni.redirectTo({
                  url: "/pages/topic/content?id=".concat(_this.conversationId) });

              } else {
                uni.navigateBack({
                  delta: 1 });

              }
              _this.$store.dispatch('jv/get', "topics/".concat(_this.conversationId)).then(function (res) {
                if (res) {
                  _this.conversationId = '';
                }
              });
            }, 1000);
            // 因为设置了虚拟滚动，所以将会去除所有对列表数据的操作，只会刷新才会更新现有数据
            // this.$u.event.$emit('deleteThread', this.threadId);
          }
        }
      }).
      catch(function (err) {
        console.log(err);
      });
    },
    // 主题回复，评论的回复调用接口
    postComment: function postComment() {var _this6 = this;
      if (this.textAreaValue.length < 1) {
        this.$refs.toast.show({ message: this.t.replyContentCannotBeEmpty });
        this.publishClickStatus = true;
        return false;
      }
      // console.log('^^^^^^^^');
      var params = {};
      if (this.commentReply) {
        params = {
          _jv: {
            type: 'posts',
            relationships: {
              thread: {
                data: {
                  type: 'threads',
                  id: this.threadId } } } },




          content: this.textAreaValue,
          isComment: true,
          replyId: this.commentId };

      } else {
        if (!this.commentAnser) {
          params = {
            _jv: {
              type: 'posts',
              relationships: {
                thread: {
                  data: {
                    type: 'threads',
                    id: this.threadId } } } },




            content: this.textAreaValue };

        }
      }
      params._jv.relationships.attachments = {
        data: [] };

      if (this.uploadFile) {
        this.uploadFile.forEach(function (item) {
          params._jv.relationships.attachments.data.push({
            type: 'attachments',
            id: item.id });

        });
      }
      this.$store.
      dispatch('jv/post', params).
      then(function (res) {
        _this6.$refs.commentPopup.close();
        _this6.commentReply = false;
        _this6.commentPopupStatus = false;
        _this6.publishClickStatus = true;
        if (res.isApproved === 1) {
          if (!res.isComment) {
            // 只保留一个用户组显示
            var hasFirst = false;
            res.user.groups = res.user.groups.filter(function (group) {
              if (group.isDisplay === true && !hasFirst) {
                hasFirst = true;
                return true;
              }
              return false;
            });
            _this6.posts.push(res);
            // console.log('(((((((((((((((', res);
          } else {
            console.log('%%%%%%%');
            if (!_this6.posts[_this6.postIndex].lastThreeComments) {
              _this6.posts[_this6.postIndex].lastThreeComments = [];
            }
            _this6.posts[_this6.postIndex].lastThreeComments.unshift(res);
            _this6.posts[_this6.postIndex].replyCount += 1;
          }
        } else {
          _this6.$refs.toast.show({ message: '您发布的内容正在审核中哦' });
        }

        _this6.textAreaValue = '';
        _this6.uploadFile = '';
      }).
      catch(function (err) {
        _this6.publishClickStatus = true;
        console.log(err);
      });
    },
    handleGroup: function handleGroup(data) {
      var groups = [];
      if (data && data.length > 0) {
        groups = data.filter(function (item) {return item.isDisplay;});
      }
      if (groups.length > 0) {
        return [groups[0]];
      }
      return [];
    },
    // 创建问答的回答
    postAnswer: function postAnswer() {var _this7 = this;
      this.commentAnser = true;
      if (this.textAreaValue.length < 1) {
        this.$refs.toast.show({ message: this.t.TheContentOfTheAnswerCannotBeEmpty });
        this.publishClickStatus = true;
        return false;
      }
      var params = {
        content: this.textAreaValue,
        type: 5,
        _jv: {
          type: 'answer',
          relationships: {},
          links: {
            self: "questions/".concat(this.questionId, "/answer") } } };



      params._jv.relationships.attachments = {
        data: [] };

      if (this.uploadFile) {
        this.uploadFile.forEach(function (item) {
          params._jv.relationships.attachments.data.push({
            type: 'attachments',
            id: item.id });

        });
      }
      this.$store.dispatch('jv/post', params).then(function (res) {
        _this7.$refs.commentPopup.close();
        _this7.loadThread();
      }).
      catch(function (err) {
        if (err && err.data && err.data.errors) {
          if (err.data.errors[0].code === 'content_banned_show_words') {
            uni.showToast({
              icon: 'none',
              title: "".concat(_this7.i18n.t('core.content_banned_show_words'), "[").concat(err.data.errors[0].detail.join('、'), "]"),
              duration: 2000 });

          }
        }
      });
    },

    // 加载当前主题评论的数据
    loadThreadPosts: function loadThreadPosts() {var _this8 = this;
      var params = {
        'filter[isApproved]': 1,
        'filter[isDeleted]': 'no',
        'filter[isComment]': 'no',
        'page[number]': this.pageNum,
        'page[limit]': this.pageSize,
        'filter[thread]': this.threadId,
        sort: this.sortVal,
        include: [
        'replyUser',
        'user.groups',
        'user',
        'images',
        'lastThreeComments',
        'lastThreeComments.user',
        'lastThreeComments.replyUser'] };


      var loadDetailCommnetAction = _index.status.run(function () {return (
          _this8.$store.dispatch('jv/get', ['posts', { params: params }]));});


      this.loadDetailCommnetStatusId = loadDetailCommnetAction._statusID;
      loadDetailCommnetAction.then(function (data) {
        /* eslint-disable */
        delete data._jv;
        // 只保留一个用户组显示
        data.forEach(function (item, index) {
          var hasFirst = false;
          data[index].user.groups = data[index].user.groups.filter(function (group) {
            if (group.isDisplay === true && !hasFirst) {
              hasFirst = true;
              return true;
            }

            return false;
          });
        });
        // console.log(data, '这是处理后的');
        _this8.loadingType = data.length === _this8.pageSize ? 'more' : 'nomore';
        _this8.posts = [].concat(_toConsumableArray(_this8.posts), _toConsumableArray(data));
        if (data.length === 0) {
          _this8.contentnomoreVal = _this8.t.noComment;
        } else {
          _this8.contentnomoreVal = _this8.t.noMoreData;
        }
      });
    },
    // 非小程序内微信支付
    onBridgeReady: function onBridgeReady(data) {var _this9 = this;
      console.log(data, 'datadata');
      // const that = this;
      WeixinJSBridge.invoke(
      'getBrandWCPayRequest',
      {
        appId: data.wechat_js.appId, // 公众号名称，由商户传入
        timeStamp: data.wechat_js.timeStamp, // 时间戳，自1970年以来的秒数
        nonceStr: data.wechat_js.nonceStr, // 随机串
        package: data.wechat_js.package,
        signType: 'MD5', // 微信签名方式：
        paySign: data.wechat_js.paySign // 微信签名
      },
      function (data) {
        // alert('支付唤醒');
        if (data.err_msg == 'get_brand_wcpay_request:ok') {
          //微信支付成功，进行支付成功处理
        } else if (data.err_msg == 'get_brand_wcpay_request:cancel') {
          // 取消支付
          clearInterval(payWechat);
          resolve;
        } else if (data.err_msg == 'get_brand_wcpay_request:fail') {
          // 支付失败
          clearInterval(payWechat);
          resolve;
        }
      });

      payWechat = setInterval(function () {
        if (_this9.payStatus === 1) {
          clearInterval(payWechat);
          return;
        }
        _this9.getOrderStatus(_this9.orderSn);
      }, 3000);
    },
    // 创建订单
    creatOrder: function creatOrder(amount, type, value, payType) {var _this10 = this;
      var params = {
        _jv: {
          type: 'orders' },

        type: type,
        thread_id: this.threadId,
        amount: amount,
        is_anonymous: this.isAnonymous };

      this.$store.
      dispatch('jv/post', params).
      then(function (res) {
        _this10.orderSn = res.order_sn;
        if (payType === 0) {
          // 微信支付
          if (_this10.browser == 0) {
            // 这是微信小程序内的支付
            _this10.orderPay(13, value, _this10.orderSn, payType, '0');
          } else {
            // 这是除微信小程序之外, this.isWeixin, this.isPhone
            if (_this10.isWeixin && _this10.isPhone) {
              // 这是微信浏览器
              _this10.orderPay(12, value, _this10.orderSn, payType, '1');
            } else if (_this10.isPhone) {
              _this10.orderPay(11, value, _this10.orderSn, payType, '2');
            } else {
              // 这是pc，没调接口之前
              _this10.orderPay(10, value, _this10.orderSn, payType, '3');
            }
          }
        } else if (payType === 1) {
          // 钱包支付
          _this10.orderPay(20, value, _this10.orderSn, payType);
        }
      }).
      catch(function (err) {
        console.log(err);
      });
    },

    // 订单支付       broswerType: 0是小程序，1是微信浏览器，2是h5，3是pc
    orderPay: function orderPay(type, value, orderSn, payType, broswerType) {var _this11 = this;
      var params = {};
      if (payType === 0) {
        params = {
          _jv: {
            type: "trade/pay/order/".concat(orderSn) },

          payment_type: type };

      } else if (payType === 1) {
        params = {
          _jv: {
            type: "trade/pay/order/".concat(orderSn) },

          payment_type: type,
          pay_password: value };

      }

      this.$store.
      dispatch('jv/post', params).
      then(function (res) {
        _this11.wxRes = res;
        if (payType === 0) {
          if (broswerType === '0') {
            _this11.wechatPay(
            res.wechat_js.timeStamp,
            res.wechat_js.nonceStr,
            res.wechat_js.package,
            res.wechat_js.signType,
            res.wechat_js.paySign);

          } else if (broswerType === '1') {
            if (typeof WeixinJSBridge === 'undefined') {
              if (document.addEventListener) {
                document.addEventListener('WeixinJSBridgeReady', _this11.onBridgeReady(res), false);
              } else if (document.attachEvent) {
                document.attachEvent('WeixinJSBridgeReady', _this11.onBridgeReady(res));
                document.attachEvent('onWeixinJSBridgeReady', _this11.onBridgeReady(res));
              }
            } else {
              _this11.onBridgeReady(res);
            }
          } else if (broswerType === '2') {
            payPhone = setInterval(function () {
              if (_this11.payStatus === 1) {
                clearInterval(payPhone);
                return;
              }
              _this11.getOrderStatus(orderSn, broswerType);
            }, 3000);
            window.location.href = res.wechat_h5_link;
          } else if (broswerType === '3') {
            if (res) {
              _this11.codeUrl = res.wechat_qrcode;
              _this11.payShowStatus = false;
              _this11.$refs.codePopup.open();
              _this11.qrcodeShow = true;
              payWechat = setInterval(function () {
                if (_this11.payStatus === 1) {
                  clearInterval(payWechat);
                  return;
                }
                _this11.getOrderStatus(_this11.orderSn, broswerType);
                uni.hideLoading();
              }, 3000);
            }
          }
        } else if (payType === 1) {
          if (res.wallet_pay.result === 'success') {
            _this11.$store.dispatch('jv/get', ["users/".concat(_this11.currentLoginId), {}]);
            if (_this11.payTypeVal === 0 || _this11.payTypeVal === 2 || _this11.payTypeVal === 3) {
              // 这是主题支付和附件支付，支付完成刷新详情页，重新请求数据
              if (_this11.thread.attachmentPrice > 0) {
                isOnPaidAttachment = false;
              }
              _this11.loadThread();
              _this11.$store.dispatch('jv/get', [
              'forum',
              {
                params: {
                  include: 'users' } }]);



            } else if (_this11.payTypeVal === 1) {
              // 这是主题打赏，打赏完成，给主题打赏列表新增一条数据
              _this11._updateRewardUsers();
            }
            _this11.payShowStatus = false;
            _this11.coverLoading = false;
          }
          _this11.coverLoading = false;
        }
      }).
      catch(function (err) {
        // 清空支付的密码
        console.log(err);
        _this11.$refs.payShow.clearPassword();
      });
    },
    // 查询订单支状 broswerType: 0是小程序，1是微信浏览器，2是h5，3是pc
    getOrderStatus: function getOrderStatus(orderSn, broswerType) {var _this12 = this;
      this.$store.
      dispatch('jv/get', ["orders/".concat(orderSn), { custom: { loading: false } }]).
      then(function (res) {
        _this12.payStatus = res.status;
        if (_this12.payStatus === 1) {
          _this12.payShowStatus = false;
          _this12.coverLoading = false;
          if (broswerType === '2') {
            // return false;
          } else if (broswerType === '3') {
            // 这是pc扫码支付完成
            _this12.$refs.codePopup.close();
            _this12.qrcodeShow = false;
            isOnPaidAttachment = false;
            _this12.loadThread();
            _this12.$store.dispatch('jv/get', [
            'forum',
            {
              params: {
                include: 'users' } }]);



          }

          if (_this12.payTypeVal === 0 || _this12.payTypeVal === 2 || _this12.payTypeVal === 3) {
            // 这是主题支付，支付完成刷新详情页，重新请求数据
            if (_this12.thread.attachmentPrice > 0) {
              isOnPaidAttachment = false;
            }

            _this12.loadThread();
            _this12.$store.dispatch('jv/get', [
            'forum',
            {
              params: {
                include: 'users' } }]);



          } else if (_this12.payTypeVal === 1) {
            // 这是主题打赏，打赏完成，给主题打赏列表新增一条数据
            _this12._updateRewardUsers();
          }
          _this12.$refs.toast.show({ message: _this12.p.paySuccess });
        }
      }).
      catch(function (err) {
        console.log(err);
        _this12.coverLoading = false;
        _this12.$refs.toast.show({ message: _this12.p.payFail });
      });
    },

    wechatPay: function wechatPay(timeStamp, nonceStr, packageVal, signType, paySign) {
      // 小程序支付。
      var _this = this;
      uni.requestPayment({
        provider: 'wxpay',
        timeStamp: timeStamp,
        nonceStr: nonceStr,
        package: packageVal,
        signType: signType,
        paySign: paySign,
        success: function success(res) {
          _this.coverLoading = true;
          payWechat = setInterval(function () {
            if (_this.payStatus === 1) {
              clearInterval(payWechat);
              return;
            }
            _this.getOrderStatus(_this.orderSn);
          }, 3000);
        },
        fail: function fail(err) {
          _this.payShowStatus = false;
          _this.coverLoading = false;
          _this.$refs.toast.show({ message: _this.p.payFail });
        } });

    },
    // 输入密码完成时
    onInput: function onInput(val) {
      this.value = val;
      if (this.payTypeVal === 0) {
        // 这是主题支付
        this.creatOrder(this.thread.price, 3, val, 1);
      } else if (this.payTypeVal === 1) {
        // 这是主题打赏
        this.creatOrder(this.price, 2, val, 1);
      } else if (this.payTypeVal === 2) {
        // 这是围观支付
        this.creatOrder(this.price, 6, val, 1);
      } else if (this.payTypeVal === 3) {
        this.creatOrder(this.thread.attachmentPrice, 7, val, 1);
      }
    },
    // 支付方式选择完成点击确定时
    paysureShow: function paysureShow(payType) {
      uni.setStorage({
        key: 'page',
        data: "/topic/index?id=".concat(this.threadId) });

      // 微信支付
      if (payType === 0) {












        if (
        this.user.wechat === undefined ||
        this.user.wechat && this.user.wechat.min_openid === '')
        {
          this.$refs.wechatPopup.open();
          return;
        }

        if (this.payTypeVal === 0) {
          // 这是主题支付
          this.creatOrder(this.thread.price, 3, this.value, payType);
        } else if (this.payTypeVal === 1) {
          // 这是主题打赏
          this.creatOrder(this.price, 2, this.value, payType);
        } else if (this.payTypeVal === 2) {
          // 这是围观支付
          this.creatOrder(this.price, 6, this.value, payType);
        } else if (this.payTypeVal === 3) {
          this.creatOrder(this.thread.attachmentPrice, 7, this.value, payType);
        }
      } else if (payType === 1) {
        "";
        // 这是详情页获取到的支付方式---钱包
      }
    },
    // 对象转数组
    limitArray: function limitArray(obj) {
      var arr = [];
      Object.values(obj).forEach(function (item) {
        arr.push(item);
      });
      return arr;
    },
    // 管理菜单点击事件
    selectClick: function selectClick() {
      this.seleShow = !this.seleShow;
    },
    // 管理菜单内标签点击事件
    selectChoice: function selectChoice(param) {
      // console.log(param);
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      if (param.type === '0') {
        uni.redirectTo({
          url: "/topic/post?type=".concat(this.thread.type, "&operating=edit&threadId=").concat(this.thread._jv.id) });

      } else if (param.type === '2' || param.type === '3') {
        this.threadOpera(this.threadId, param.canOpera, param.status, param.type);
      } else if (param.type === '4') {
        this.$refs.deletePopup.open();
        this.deleteType = '4';
        this.deleteId = this.threadId;
        this.deletePostCanStatus = param.canOpera;
        this.deletePostIsStatus = param.status;
        this.deletePostType = param.type;
        this.deleteTip = this.i18n.t('core.deleteContentSure');
      }
    },
    // 点击用户名跳转
    beAskClick: function beAskClick(id) {
      if (id <= 0) {
        return;
      }
      uni.navigateTo({
        url: "/pages/profile/index?userId=".concat(id) });

    },
    // 跳转到用户主页
    personJump: function personJump(id) {
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      if (id <= 0) {
        return;
      }
      uni.navigateTo({
        url: "/pages/profile/index?userId=".concat(id) });

    },
    // 主题支付
    payClickShow: function payClickShow() {var _this13 = this;
      // console.log('0000');
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      this.payStatus = false;
      if (!this.forums.paycenter.wxpay_close) {
        this.payShowStatus = false;
        return;
      } else if (this.forums.paycenter.wxpay_close) {

        if (this.system === 'ios') {
          if (this.paymentmodel === false) {
            this.payShowStatus = false;
            return;
          } else {
            this.payShowStatus = true;
          }
        } else {
          this.payShowStatus = true;
        }




      } else {
        this.payShowStatus = false;
        return;
      }

      this.payTypeVal = 0; // payTypeVal, '这是类型，0为主题支付，1为主题打赏 2围观支付  3为附件支付
      if (this.thread.attachmentPrice > 0) {
        this.payTypeVal = 3;
      } else {
        this.payTypeVal = 0;
      }

      if (this.thread.type === 3) {
        this.payTypeText = this.t.pay + this.t.paymentViewPicture;
        this.price = parseFloat(this.thread.price);
      } else if (this.thread.type === 1) {
        if (this.thread.attachmentPrice > 0) {
          this.payTypeText = this.t.pay + this.thread.attachmentPrice + this.t.checkTheAttachment;
          this.price = parseFloat(this.thread.attachmentPrice);
          // console.log(this.payTypeText, '支付附件');
        } else {
          this.payTypeText = this.t.pay + this.thread.price + this.t.paymentViewRemainingContent;
          this.price = parseFloat(this.thread.price);
        }
      } else if (this.thread.type === 2) {
        this.payTypeText = this.t.pay + this.t.paymentViewVideo;
        this.price = parseFloat(this.thread.price);
      } else if (this.thread.type === 4) {
        this.payTypeText = this.t.pay + this.t.paymentViewAudio;
        this.price = parseFloat(this.thread.price);
      }

      this.$nextTick(function () {
        // console.log('9999');
        _this13.$refs.payShow.payClickShow(_this13.payTypeVal);
      });
    },
    // 围观支付
    payAnswerClickShow: function payAnswerClickShow() {var _this14 = this;
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      this.payStatus = false;
      this.payTypeVal = 2;
      this.price = parseFloat(this.thread.question.onlooker_unit_price);
      this.$nextTick(function () {
        // console.log('9999');
        _this14.$refs.payShow.payClickShow(_this14.payTypeVal);
      });
    },
    // 支付是否显示用户头像
    radioMyHead: function radioMyHead(val) {
      // 是否显示用户头像
      this.isAnonymous = !val;
    },

    // 选择支付方式，获取值
    radioChange: function radioChange(val) {
      // val, 这是父级得到的
    },
    // 打赏
    rewardClick: function rewardClick() {
      // console.log('打赏');
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      if (this.user._jv.id === this.thread.user._jv.id) {
        this.$refs.toast.show({ message: this.t.iCantRewardMyself });
        return false;
      }
      // 这是打赏
      this.payStatus = false;
      this.payTypeVal = 1;
      this.payTypeText = this.t.supportTheAuthorToCreate;
      // this.payShowStatus = true;
      this.payNumCheck = [
      {
        name: '',
        pay: '' }];


      this.$refs.rewardPopup.open();
    },
    // 取消打赏
    cancelReward: function cancelReward() {
      this.payNumCheck = [
      {
        name: '',
        pay: '' }];


      this.$refs.rewardPopup.close();
    },
    // 打赏选择付费金额
    moneyClick: function moneyClick(index) {var _this15 = this;
      // this.setType = 'pay';
      this.payNumCheck = [];
      this.payNumCheck.push(this.payNum[index]);

      if (this.payNumCheck[0].name === '自定义') {
        this.$refs.rewardPopup.close();

        this.$nextTick(function () {
          _this15.$refs.customAmountPopup.open();
          _this15.customAmountStatus = true;
        });
      } else {
        this.price = this.payNumCheck[0].pay;
        this.payShowStatus = true;
        this.$refs.rewardPopup.close();
        this.payTypeVal = 1;
        this.$nextTick(function () {
          // this.$refs.payShow.payClickShow();
          _this15.$refs.payShow.payClickShow(_this15.payTypeVal);
        });
      }
    },
    // 处理金额
    checkNum: function checkNum(e) {
      var that = this;
      var price = e.target.value;
      var maxLength = price.indexOf('.');

      if (price.indexOf('.') < 0 && price != '') {
        // 超过4位则大于1万元
        if (price.length > 6) {
          price = price.substring(0, price.length - 1);
          uni.showToast({
            title: that.c.TheAmountCannotExceedOneMillion,
            icon: 'none' });

        } else {
          price = parseFloat(price);
        }
      } else if (price.indexOf('.') == 0) {
        //'首位小数点情况'
        price = price.replace(/[^$#$]/g, '0.');
        price = price.replace(/\.{2,}/g, '.');
      } else if (!/^(\d?)+(\.\d{0,2})?$/.test(price)) {
        //去掉最后一位
        price = price.substring(0, price.length - 1);
      }
      that.$nextTick(function () {
        //'有小数点时，最大长度为9位，没有则是7位'
        that.maxLength = maxLength == -1 ? 7 : 10;
        that.inputPrice = price;
      });
    },
    // 自定义付费金额弹框点击关闭时
    diaLogClose: function diaLogClose() {
      this.$refs.customAmountPopup.close();
      this.customAmountStatus = false;
    },
    // 自定义付费金额弹框点击确定时
    diaLogOk: function diaLogOk() {var _this16 = this;
      // if (this.inputPrice <= 0) {
      //   this.$refs.toast.show({ message: this.p.AmountCannotBeLessThan0 });
      // } else {
      if (this.forums.set_site.site_minimum_amount === '') {
        if (this.inputPrice < '0.1') {
          uni.showToast({
            title: this.i18n.t('core.TheAmountCannotBeLessThanOneYuan'),
            icon: 'none' });

          return;
        }
      } else {
        if (this.inputPrice < this.forums.set_site.site_minimum_amount) {
          uni.showToast({
            title:
            this.i18n.t('core.TheAmountCannotBeLessThanMinMoney') +
            this.forums.set_site.site_minimum_amount +
            this.i18n.t('discuzq.post.yuan'),
            icon: 'none' });

          return;
        }
      }
      this.price = Number(this.inputPrice);
      this.$refs.customAmountPopup.close();
      this.customAmountStatus = false;
      this.payShowStatus = true;
      // this.$refs.payShow.payClickShow();
      this.$nextTick(function () {
        _this16.$refs.payShow.payClickShow(_this16.payTypeVal);
      });
      // }
    },
    // 回复文本域失去焦点时，获取光标位置
    contBlur: function contBlur(e) {
      this.cursor = e.detail.cursor;
    },
    // 点击表情插入到文本域
    getEmojiClick: function getEmojiClick(code) {
      var text = '';
      text = "".concat(this.textAreaValue.slice(0, this.cursor) +
      code +
      this.textAreaValue.slice(this.cursor));
      this.textAreaValue = text;
      this.emojiShow = false;
    },

    // 点击@跳转到@页
    callClick: function callClick() {
      uni.navigateTo({ url: '/pages/user/at-member' });
    },
    // // 上传图片
    // imageUploader() {
    //   // this.uploaderShow = true;
    //   // if (this.uploadFile.length == 3) {
    //   //   this.$refs.toast.show({ message: this.t.imageNumLimit });
    //   //   return;
    //   // }
    //   this.$nextTick(() => {
    //     this.$refs.upload.uploadClick();
    //   });
    // },
    // 上传图片
    uploadChange: function uploadChange(e) {
      this.uploadFile = e;
    },
    // 删除图片
    uploadClear: function uploadClear(list, del) {
      // console.log('触发删除');
      var id = list.id;
      this.deleteType = 0;
      this.deleteImgId = id;
      this.deleteIndex = del;
      this.$refs.deletePopup.open();
      this.deleteTip = this.i18n.t('core.deleteImgSure');
      // this.delAttachments(id, del).then(() => {
      //   this.$refs.upload.clear(del);
      // });
    },
    // 删除图片
    delAttachments: function delAttachments(id) {
      var params = {
        _jv: {
          type: 'attachments',
          id: id } };



      return this.$store.
      dispatch('jv/delete', params).
      then(function (res) {
        return res;
      }).
      catch(function (err) {
        console.log(err);
      });
    },
    // 主题评论点击发布事件
    publishClick: function publishClick() {
      this.publishClickStatus = false;
      if (this.commentAnser === true) {
        this.postAnswer();
      } else {
        this.postComment(this.commentId);
      }
    },
    // 跳转到评论详情页
    commentJump: function commentJump(threadId, postId) {
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: "/pages/topic/comment?threadId=".concat(threadId, "&commentId=").concat(postId) });


        this.mpLoginMode();




      }
      uni.navigateTo({
        url: "/pages/topic/comment?threadId=".concat(threadId, "&commentId=").concat(postId) });

    },
    // 评论点赞
    commentLikeClick: function commentLikeClick(postId, type, canStatus, isStatus, index, post) {
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      this.postIndex = index;
      this.postOpera(postId, type, canStatus, isStatus, post);
    },
    // 删除评论
    deleteComment: function deleteComment(postId, type, canStatus, isStatus, post) {
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      this.$refs.deletePopup.open();
      this.deleteId = postId;
      this.deleteType = '3';
      this.deletePostCanStatus = canStatus;
      this.deletePostIsStatus = isStatus;
      this.deletePost = post;
      this.deleteTip = this.i18n.t('core.deleteCommentSure');
      // this.postOpera(postId, '3', canStatus, isStatus, post);
    },
    // 评论的回复
    replyComment: function replyComment(postId, postIndex) {
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      if (!this.thread.canReply) {
        this.$refs.toast.show({ message: this.t.noReplyPermission });
      } else {
        this.commentReply = true;
        this.postIndex = postIndex;
        this.commentId = postId;
        this.$refs.commentPopup.open();
        this.commentPopupStatus = true;
        this.commentWorkTips = true;
        this.commentText = false;
        this.focusVal = true;
      }
    },
    // 点击图片
    imageClick: function imageClick() {
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      // this.previewImg();
    },
    // 点击分类标签
    tagClick: function tagClick(tagId) {
      this.$u.event.$emit('tagClick', tagId);
      var pages = getCurrentPages();
      var delta = pages.indexOf(pages[pages.length - 1]);
      if (
      pages.length > 1 &&
      pages[delta - 1].route &&
      pages[delta - 1].route === 'pages/home/index')
      {
        uni.navigateBack({
          delta: delta });

        this.setFooterIndex(0);
      } else {
        uni.navigateTo({
          url: '/pages/home/index' });

        this.setFooterIndex(0);
      }
    },
    // 主题点赞
    threadLikeClick: function threadLikeClick(postId, canLike, isLiked) {
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      this.postOpera(postId, '1', canLike, isLiked);
    },
    // 主题收藏
    threadCollectionClick: function threadCollectionClick(id, canStatus, isStatus, type) {
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      this.threadOpera(id, canStatus, isStatus, type);
    },

    // 主题回复
    threadComment: function threadComment(threadId) {
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      if (this.thread.canReply) {
        this.commentId = threadId;
        this.formData.type = 1;
        this.$refs.commentPopup.open();
        this.commentPopupStatus = true;
        this.commentWorkTips = true;
        this.commentText = false;
        this.focusVal = true;
      } else {
        this.$refs.toast.show({ message: this.t.noReplyPermission });
      }
    },

    // 回答问题
    queClick: function queClick() {
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      this.formData.type = 5;
      this.commentAnser = true;
      this.$refs.commentPopup.open();
      // this.postAnswer();
      this.commentPopupStatus = true;
      this.commentWorkTips = false;
      this.commentText = true;
      this.maxTextLength = 49999;
    },

    handleClickOk: function handleClickOk() {var _this17 = this;
      this.$refs.deletePopup.close();
      if (this.deleteType === '4') {
        this.threadOpera(
        this.deleteId,
        this.deletePostCanStatus,
        this.deletePostIsStatus,
        this.deleteType);

      } else if (this.deleteType === '3') {
        // 删除类型为主题评论
        this.postOpera(
        this.deleteId,
        '3',
        this.deletePostCanStatus,
        this.deletePostIsStatus,
        this.deletePost);

      } else if (this.deleteType === 0) {
        // console.log('确定删除');
        // 删除类型为评论时上传的图片
        this.delAttachments(this.deleteImgId, this.deleteIndex).then(function () {
          _this17.$refs.upload.clear(_this17.deleteIndex);
          _this17.$refs.upload.getValue().forEach(function (value, key, item) {
            value.id == _this17.deleteImgId && item.splice(key, 1);
          });
          // console.log(this.$refs.upload.getValue(), '这是列表');
        });
      }
    },
    // 确认去绑定微信
    handleWechatClickOk: function handleWechatClickOk() {
      this.$refs.wechatPopup.close();

      this.mpLogin();












    },
    // 取消去绑定微信
    handleWechatClickCancel: function handleWechatClickCancel() {
      this.$refs.wechatPopup.close();
    },
    handleClickCancel: function handleClickCancel() {
      this.$refs.deletePopup.close();
    },

    // 分享
    shareClick: function shareClick() {
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }

      this.$refs.sharePopup.open();
      if (this.forums.set_site && this.forums.set_site.site_mode === 'pay') {
        this.bottomData.forEach(function (value, key, bottomData) {
          // this.bottomData.map((value, key, bottomData) => {
          value.name === 'wxFriends' && bottomData.splice(key, 1);
        });
      }













    },





    // 取消分享
    cancel: function cancel() {
      this.$refs.sharePopup.close();
    },
    // 内容部分分享海报,跳到分享海报页面
    shareContent: function shareContent(index) {
      if (index === 0) {
        if (this.thread.isApproved == 0) {
          uni.showToast({
            icon: 'none',
            title: this.i18n.t('topic.underReview'),
            duration: 2000 });

        } else {
          uni.navigateTo({
            url: "/pages/share/topic?id=".concat(this.threadId) });

        }
      }
      this.cancel();
    },

    // // 下拉加载
    // pullDown() {
    //   if (this.loadingType !== 'more') {
    //     return;
    //   }
    //   this.pageNum += 1;
    //   this.loadThreadPosts();
    // },
    codeImgChange: function codeImgChange(params) {
      if (!params.show) {
        clearInterval(payWechat);
      }
    },
    _updateLikedUsers: function _updateLikedUsers() {var _this18 = this;var liked = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;
      this.isLiked = liked;
      // 主题点赞
      if (this.isLiked) {
        this.likedUsers.unshift(this.user);
        this.thread.firstPost._jv.relationships.likedUsers.data.unshift({
          type: this.user._jv.type,
          id: this.user._jv.id });

      } else {
        this.likedUsers.forEach(function (value, key, item) {
          value.id == _this18.user.id && item.splice(key, 1);
        });
        this.thread.firstPost._jv.relationships.likedUsers.data.forEach(function (value, key, item) {
          value.id == _this18.user.id && item.splice(key, 1);
        });
      }
      this.$forceUpdate();
    },
    _updateRewardUsers: function _updateRewardUsers() {var payType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      if (this.payTypeVal === 1) {
        this.thread.rewardedCount++;
        if (!this.rewardStatus) {
          this.rewardStatus = true;
          this.rewardBtnStatus = true;
        }
      }

      this.rewardedUsers.unshift(this.user);
      this.thread._jv.relationships.rewardedUsers.data.unshift({
        type: this.user._jv.type,
        id: this.user._jv.id });

      this.$forceUpdate();
    },
    onUnload: function onUnload() {
      clearInterval(payWechat);
      clearInterval(payPhone);
    },
    // 点击排序
    sortOperaClick: function sortOperaClick() {
      this.sortSeleShow = !this.sortSeleShow;
    },
    // 管理菜单内标签点击事件
    sortSelectChoice: function sortSelectChoice(param) {var _this19 = this;
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      this.sortSeleShow = false;

      if (param.type === '0') {
        if (this.sortVal === 'createdAt') {
          this.$refs.toast.show({ message: this.t.itsAlreadyWantedSort });
        } else {
          this.refreshVal = false;

          this.$nextTick(function () {
            _this19.refreshVal = true;
          });
          this.sortVal = 'createdAt';
          this.posts = [];
          this.loadThreadPosts();
        }
      } else if (param.type === '1') {
        if (this.sortVal === '-createdAt') {
          this.$refs.toast.show({ message: this.t.itsAlreadyWantedSort });
        } else {
          this.refreshVal = false;
          this.sortVal = '-createdAt';
          this.posts = [];
          this.loadThreadPosts();
          this.$nextTick(function () {
            _this19.refreshVal = true;
          });
        }
      }
    },
    // 添加关注
    addFollow: function addFollow(userInfo) {var _this20 = this;
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      var originUser = this.$store.getters['jv/get']("users/".concat(userInfo.id));
      var params = {
        _jv: {
          type: 'follow' },

        type: 'user_follow',
        to_user_id: userInfo.id };

      this.$store.dispatch('jv/post', params).then(function (res) {
        if (res.is_mutual == 0) {
          _this20.thread.user.follow = 1;
          originUser.follow = 1;
          _this20.followStatus = 1;
        } else {
          _this20.thread.user.follow = 2;
          originUser.follow = 2;
          _this20.followStatus = 2;
        }
      });
    },
    // 取消关注
    deleteFollow: function deleteFollow(userInfo) {var _this21 = this;
      var originUser = this.$store.getters['jv/get']("users/".concat(userInfo.id));
      this.$store.dispatch('jv/delete', "follow/".concat(userInfo.id, "/1")).then(function () {
        _this21.thread.user.follow = 0;
        originUser.follow = 0;
        _this21.followStatus = 0;
      });
      s;
    },
    // 更多操作-唤起弹框
    moreClick: function moreClick() {
      if (!this.$store.getters['session/get']('isLogin')) {
        uni.setStorage({
          key: 'page',
          data: (0, _getCurUrl.getCurUrl)() });


        this.mpLoginMode();




      }
      this.$refs.morePopup.open();
    },
    // 更多操作内标签选择
    moreContent: function moreContent(param, thread) {
      this.moreCancel();
      if (param.type === '0') {
        this.$;
        uni.redirectTo({
          url: "/topic/post?type=".concat(this.thread.type, "&operating=edit&threadId=").concat(this.thread._jv.id) });

      } else if (param.type === '2' || param.type === '3') {
        this.threadOpera(this.threadId, param.canOpera, param.isStatus, param.type);
      } else if (param.type === '4') {
        this.$refs.deletePopup.open();
        this.deleteType = '4';
        this.deleteId = this.threadId;
        this.deletePostCanStatus = param.canOpera;
        this.deletePostIsStatus = param.status;
        this.deletePostType = param.type;
        this.deleteTip = this.i18n.t('core.deleteContentSure');
      }
      if (param.name === 'report') {
        this.reportClick();
      }
      if (param.name === 'collection') {
        this.threadCollectionClick(thread._jv.id, thread.canFavorite, thread.isFavorite, '1');
      }
      if (param.name === 'share') {
        this.shareClick();
      }
      if (param.name === 'poster') {
        this.shareContent(0);
      }
    },
    // 关闭更多操作弹框
    moreCancel: function moreCancel() {
      this.$refs.morePopup.close();
    },
    // 关闭举报弹框
    reportClose: function reportClose(val) {
      this.$refs.reportPopup.close();
    },
    // 举报
    reportClick: function reportClick() {
      this.moreCancel();
      this.$refs.reportPopup.open();
    },
    // 点击购买商品 在小程序内复制链接，提醒在浏览器里打开，在微信 浏览器和h5内，直接跳转页面
    buyGood: function buyGood() {
      if (this.thread.type === 6) {

















        this.copy(this.thread.firstPost.postGoods.detail_content);

      }
    },
    copy: function copy(text) {var _this22 = this;
      (0, _uniCopy.default)({
        content: text,
        success: function success(res) {
          uni.showToast({
            title: _this22.thread.firstPost.postGoods.type_name + res,
            icon: 'none' });

        },
        error: function error(e) {
          uni.showToast({
            title: e,
            icon: 'none',
            duration: 3000 });

        } });

    } }) };exports.default = _default;
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 1)["default"]))

/***/ }),

/***/ 680:
/*!*****************************************************************************************************************!*\
  !*** E:/wamp/www/hi-hupai-wechat-pro/topic/index.vue?vue&type=style&index=0&id=1ebd8ed4&lang=scss&scoped=true& ***!
  \*****************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _G_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_G_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_G_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_G_HBuilderX_plugins_uniapp_cli_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_style_index_0_id_1ebd8ed4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=1ebd8ed4&lang=scss&scoped=true& */ 681);
/* harmony import */ var _G_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_G_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_G_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_G_HBuilderX_plugins_uniapp_cli_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_style_index_0_id_1ebd8ed4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_G_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_G_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_G_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_G_HBuilderX_plugins_uniapp_cli_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_style_index_0_id_1ebd8ed4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _G_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_G_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_G_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_G_HBuilderX_plugins_uniapp_cli_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_style_index_0_id_1ebd8ed4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__) if(__WEBPACK_IMPORT_KEY__ !== 'default') (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _G_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_G_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_G_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_G_HBuilderX_plugins_uniapp_cli_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_style_index_0_id_1ebd8ed4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_G_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_G_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_8_oneOf_1_1_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_2_G_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_3_G_HBuilderX_plugins_uniapp_cli_node_modules_sass_loader_dist_cjs_js_ref_8_oneOf_1_4_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_8_oneOf_1_5_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_G_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_index_vue_vue_type_style_index_0_id_1ebd8ed4_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 681:
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/wamp/www/hi-hupai-wechat-pro/topic/index.vue?vue&type=style&index=0&id=1ebd8ed4&lang=scss&scoped=true& ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ })

},[[673,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../.sourcemap/mp-weixin/topic/index.js.map