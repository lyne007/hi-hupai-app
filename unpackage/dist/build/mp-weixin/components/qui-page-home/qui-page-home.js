(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/qui-page-home/qui-page-home"],{"2aed":function(e,t,i){"use strict";i.r(t);var n=i("63e70"),o=i("7ab8");for(var s in o)"default"!==s&&function(e){i.d(t,e,(function(){return o[e]}))}(s);i("4fab");var r,a=i("f0c5"),c=Object(a["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],r);t["default"]=c.exports},"4fab":function(e,t,i){"use strict";var n=i("f6dd"),o=i.n(n);o.a},"63e70":function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){return n}));var n={uniNavBar:function(){return i.e("components/uni-nav-bar/uni-nav-bar").then(i.bind(null,"8fb0"))},quiHeader:function(){return i.e("components/qui-header/qui-header").then(i.bind(null,"93b9"))},quiIcon:function(){return i.e("components/qui-icon/qui-icon").then(i.bind(null,"5d1d"))},uTabs:function(){return i.e("components/u-tabs/u-tabs").then(i.bind(null,"233a"))},quiUparse:function(){return Promise.all([i.e("common/vendor"),i.e("components/qui-uparse/qui-uparse")]).then(i.bind(null,"62d3"))},quiContent:function(){return Promise.all([i.e("common/vendor"),i.e("components/qui-content/qui-content")]).then(i.bind(null,"527d"))},quiLoadMore:function(){return i.e("components/qui-load-more/qui-load-more").then(i.bind(null,"80d7"))},quiFilterModal:function(){return i.e("components/qui-filter-modal/qui-filter-modal").then(i.bind(null,"7339"))},uniPopup:function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"f1be"))},quiToast:function(){return i.e("components/qui-toast/qui-toast").then(i.bind(null,"6512"))}},o=function(){var e=this,t=e.$createElement,i=(e._self._c,e.$u.light()),n=e.$u.light(),o=e.i18n.t("home.sticky"),s=e.__map(e.threads,(function(t,i){var n=e.__get_orig(t),o=e.handleGroup(t.user&&t.user.groups),s=e.handleGroup(t.question&&t.question.beUser.groups);return{$orig:n,m0:o,m1:s}})),r=e.i18n.t("home.copyright"),a=e.i18n.t("home.confirmText"),c=e.i18n.t("home.cancel"),l=e.i18n.t("home.cancel");e.$mp.data=Object.assign({},{$root:{g0:i,g1:n,g2:o,l0:s,g3:r,g4:a,g5:c,g6:l}})},s=[]},"7ab8":function(e,t,i){"use strict";i.r(t);var n=i("fd3a"),o=i.n(n);for(var s in n)"default"!==s&&function(e){i.d(t,e,(function(){return n[e]}))}(s);t["default"]=o.a},f6dd:function(e,t,i){},fd3a:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(i("a34a")),o=i("db65"),s=l(i("8605")),r=l(i("245a")),a=l(i("412c")),c=i("2f62");function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return p(e)||f(e)||d(e)||h()}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){if(e){if("string"===typeof e)return g(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?g(e,t):void 0}}function f(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function p(e){if(Array.isArray(e))return g(e)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function m(e,t,i,n,o,s,r){try{var a=e[s](r),c=a.value}catch(l){return void i(l)}a.done?t(c):Promise.resolve(c).then(n,o)}function v(e){return function(){var t=this,i=arguments;return new Promise((function(n,o){var s=e.apply(t,i);function r(e){m(s,n,o,r,a,"next",e)}function a(e){m(s,n,o,r,a,"throw",e)}r(void 0)}))}}function y(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function b(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?y(Object(i),!0).forEach((function(t){T(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function T(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var x,w=e.getSystemInfoSync();x=w.statusBarHeight+44;var I="translateY(-".concat(x,"px)"),$={mixins:[s.default,r.default,a.default],props:{navTheme:{type:String,default:""},homeCategoryId:{type:String,default:""}},data:function(){return{navBarTransform:I,checkoutTheme:!1,threadType:"",threadEssence:"",threadFollow:0,show:!1,ifNeedConfirm:!0,top:500,filterSelected:{label:this.i18n.t("topic.whole"),value:""},loadingType:"more",hasMore:!1,pageSize:20,pageNum:1,isLiked:!1,showSearch:!0,navbarHeight:x,headerShow:!0,navTop:128,navHeight:0,nowThreadId:"",filterTop:"",shareShow:!1,shareTitle:"",isWeixin:"",filterList:[{title:this.i18n.t("home.filterPlate"),data:[]},{title:this.i18n.t("home.filterType"),data:[{label:this.i18n.t("home.all"),value:"",selected:!0},{label:this.i18n.t("home.text"),value:"0",selected:!1},{label:this.i18n.t("home.invitation"),value:"1",selected:!1},{label:this.i18n.t("home.video"),value:"2",selected:!1},{label:this.i18n.t("home.picture"),value:"3",selected:!1},{label:this.i18n.t("home.audio"),value:"4",selected:!1},{label:this.i18n.t("home.questions"),value:"5",selected:!1},{label:this.i18n.t("home.goods"),value:"6",selected:!1}]},{title:this.i18n.t("home.confirmText"),data:[{label:this.i18n.t("home.all"),value:"",selected:!0},{label:this.i18n.t("home.essence"),value:"1",selected:!1},{label:this.i18n.t("home.followed"),value:"2",selected:!1}]}],threads:[],location:{},sticky:[],shareBtn:"icon-share1",tabIndex:0,isResetList:!1,bottomData:[{text:this.i18n.t("home.generatePoster"),icon:"icon-poster",name:"wx",id:1},{text:this.i18n.t("home.wxShare"),icon:"icon-wx-friends",name:"wx",id:2}],threadsStatusId:0,categories:[],playIndex:null,scrollTop:0,surl:"",observer:null,scrollnumber:"",scrollindex:"",switchscroll:!1}},computed:b(b({},(0,c.mapState)({categoryId:function(e){return e.session.categoryId},categoryIndex:function(e){return e.session.categoryIndex},footerIndex:function(e){return e.footerTab.footerIndex?parseInt(e.footerTab.footerIndex,10):0}})),{},{setIndex:{get:function(){var e=this.$store.state.footerTab.footerIndex;return e},set:function(e){1!==e&&2!==e||(this.headerShow=!0)}},userId:function(){return this.$store.getters["session/get"]("userId")}}),created:function(){var t=this;this.$u.event.$on("addThread",(function(){t.isResetList=!0,t.pageNum=1,t.loadThreads()})),this.$u.event.$on("deleteThread",(function(e){return t.threads.forEach((function(i,n){i._jv.id===e&&t.threads.splice(n,1)}))})),this.$u.event.$on("deletedImg",(function(e){t.threads.forEach((function(t){t._jv.id===e.threadId&&t.firstPost.images.splice(e.index,1)}))})),this.$u.event.$on("stickyThread",(function(e){t.sticky.unshift(e),t.threads.forEach((function(i,n){i._jv.id===e._jv.id&&t.threads.splice(n,1)}))})),this.$u.event.$on("cancelSticky",(function(e){t.sticky.forEach((function(i,n){i._jv.id===e._jv.id&&t.sticky.splice(n,1)}))})),this.$u.event.$on("refreshImg",(function(e){for(var i in t.threads)if(t.threads[i]._jv.id===e.threadId){var n=function(){var n=[];return e.images.data&&e.images.data.forEach((function(e){n.push(t.$store.getters["jv/get"]("attachments/".concat(e.id)))})),t.threads[i].firstPost.images=n,t.$forceUpdate(),"break"}();if("break"===n)break}})),this.$u.event.$on("refreshGoods",(function(e){for(var i in console.log(e,"这是接收的商品"),t.threads)if(t.threads[i]._jv.id===e.threadId){t.threads[i].firstPost.postGoods=e.goods,t.$forceUpdate();break}})),this.$u.event.$on("updateLocation",(function(e,i){t.threads.forEach((function(n,o){n._jv.id===e&&(t.threads[o].latitude=i.latitude||"",t.threads[o].location=i.location||"",t.threads[o].longitude=i.longitude||"",t.threads[o].address=i.address||"")}))})),this.ontrueGetList(),e.$on("logind",(function(){t.ontrueGetList()}))},destroyed:function(){e.$off("logind")},mounted:function(){var t=this;this.$u.event.$on("tagClick",(function(e){t.isResetList=!0,t.loadCategories(),t.setCategoryId(e),t.setCategoryIndex(t.getCategorieIndex(e)),t.loadThreadsSticky(),t.loadThreads()})),0===this.footerIndex&&this.$uGetRect("#navId").then((function(e){t.navTop=e.top,t.navHeight=e.height})),this.forums.set_site&&this.forums.set_site.site_title?e.setNavigationBarTitle({title:"".concat(this.forums.set_site.site_title)}):this.forums.set_site&&e.setNavigationBarTitle({title:"".concat(this.forums.set_site.site_name)})},methods:b(b({},(0,c.mapMutations)({setCategoryId:"session/SET_CATEGORYID",setCategoryIndex:"session/SET_CATEGORYINDEX"})),{},{topMargin:function(){return";"},handleGroup:function(e){var t=[];return e&&e.length>0&&(t=e.filter((function(e){return e.isDisplay}))),t.length>0?[t[0]]:[]},scrpllsip:function(e,t){this.scrollnumber=e,this.scrollindex=t,this.switchscroll=!0},scroll:function(e){this.scrollTop=e.scrollTop,this.switchscroll&&0!==this.scrollTop&&(this.scrollTop>this.num||this.scrollTop<this.num)&&(this.$refs["myVideo".concat(this.scrollindex)][0].pauseVideo(),this.switchscroll=!1),this.navbarHeight&&(e.scrollTop+this.navbarHeight+20>=this.navTop?(this.headerShow=!1,this.navBarTransform="none"):(this.headerShow=!0,this.navBarTransform="translate3d(0, -".concat(this.navbarHeight,"px, 0)")))},scrollsetups:function(){var t=this;e.setStorage({key:"scroll_top",data:t.scrollTop})},screenplayback:function(){var t=0,i=this;e.getStorage({key:"scroll_top",success:function(e){t=e.data,i.num=e.data}});var n=setTimeout((function(){e.pageScrollTo({duration:0,scrollTop:t}),clearTimeout(n)}),50)},toUpper:function(){this.headerShow=!0},getCategorieIndex:function(e){for(var t=0,i=this.categories.length;t<i;t+=1)if(+this.categories[t]._jv.id===+e)return t},toggleTab:function(t){var i=this;return v(n.default.mark((function o(){return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i.isResetList=!0,i.pageNum=1,i.checkoutTheme=!0,i.threadEssence="",i.threadFollow=0,i.setCategoryId(t.id),i.setCategoryIndex(t.index),i.filterList[0].data.map((function(e){e.selected=!1})),i.filterList[0].data[t.index].selected=!0,i.loadThreadsSticky(),i.threads=[],n.next=13,i.loadThreads();case 13:i.checkoutTheme=!1,0!==t.id?e.setNavigationBarTitle({title:"".concat(t.name," - ").concat(i.forums.set_site.site_name)}):i.forums.set_site&&i.forums.set_site.site_title?e.setNavigationBarTitle({title:"".concat(i.forums.set_site.site_title)}):e.setNavigationBarTitle({title:"".concat(i.forums.set_site.site_name)});case 15:case"end":return n.stop()}}),o)})))()},searchClick:function(){e.navigateTo({url:"/pages/site/search"}),this.show=!1},stickyClick:function(t){e.navigateTo({url:"/topic/index?id=".concat(t)})},commentClick:function(t){e.navigateTo({url:"/topic/index?id=".concat(t)})},contentClick:function(t){t.canViewPosts?e.navigateTo({url:"/topic/index?id=".concat(t._jv.id)}):this.$refs.toast.show({message:this.i18n.t("home.noPostingTopic")})},headClick:function(t){t<=0||e.navigateTo({url:"/pages/profile/index?userId=".concat(t)})},answeClick:function(t){t<=0||e.navigateTo({url:"/pages/profile/index?userId=".concat(t)})},beAskClick:function(t){t<=0||e.navigateTo({url:"/pages/profile/index?userId=".concat(t)})},headAnswerClick:function(t){t<=0||e.navigateTo({url:"/pages/profile/index?userId=".concat(t)})},open:function(){this.$store.getters["session/get"]("isLogin")||(e.setStorage({key:"page",data:"/pages/home/index"}),this.mpLoginMode()),this.$refs.popupHead.open(),"pay"===this.forums.set_site.site_mode&&(this.bottomData=[{text:this.i18n.t("home.generatePoster"),icon:"icon-poster",name:"wx",id:1}])},shareHead:function(t){0===t&&(this.$store.getters["session/get"]("isLogin")||(e.setStorage({key:"page",data:"/pages/home/index"}),this.mpLoginMode()),e.navigateTo({url:"/pages/share/site"})),this.cancel()},cancel:function(){this.$refs.popupContent.close(),this.$refs.popupHead.close()},close:function(){this.$refs.auth.close()},confirm:function(e){this.isResetList=!0,this.pageNum=1;var t=b({},e);switch(this.setCategoryId(t[0].data.value),this.setCategoryIndex(t[0].data.index),this.threadType=t[1].data.value,t[2].data.value){case"1":this.threadEssence="yes",this.threadFollow=0;break;case"2":this.threadEssence="",this.threadFollow=this.user.id;break;default:this.threadEssence="",this.threadFollow=0;break}this.loadThreadsSticky(),this.loadThreads()},changeType:function(e){this.filterList=e},showFilter:function(){var e=this;wx.createSelectorQuery().in(this).select("#navId").boundingClientRect((function(t){e.filterTop="".concat(2*t.bottom,"rpx")})).exec(),this.show=!this.show,this.$refs.filter.setData()},handleClickShare:function(t){this.$store.getters["session/get"]("isLogin")||(e.setStorage({key:"page",data:"/pages/home/index"}),this.mpLoginMode()),this.$emit("handleClickShare",t),this.nowThreadId=t,this.$refs.popupContent.open(),"pay"===this.forums.set_site.site_mode&&(this.bottomData=[{text:this.i18n.t("home.generatePoster"),icon:"icon-poster",name:"wx",id:1}])},shareContent:function(t){0===t&&e.navigateTo({url:"/pages/share/topic?id=".concat(this.nowThreadId)}),this.cancel()},loadCategories:function(){var e=this;this.$store.dispatch("jv/get",["categories",{}]).then((function(t){var i=u(t)||[];e.categories=[{_jv:{id:0},name:e.i18n.t("home.all")}].concat(u(i));var n=[{label:e.i18n.t("home.all"),value:0,selected:!0}];i.forEach((function(e){n.push({label:e.name,value:e._jv.id,selected:!1})})),e.filterList[0].data=n}))},loadThreadsSticky:function(){var e=this,t={"filter[isSticky]":"yes","filter[isDisplay]":"yes","filter[isApproved]":1,"filter[isDeleted]":"no","filter[categoryId]":this.categoryId,include:["firstPost"]};this.$store.dispatch("jv/get",["threads",{params:t}]).then((function(t){e.sticky=u(t)}))},loadThreads:function(){var e=this,t={"filter[isSticky]":"no","filter[isApproved]":1,"filter[isDeleted]":"no","filter[categoryId]":this.categoryId,"filter[type]":this.threadType,"filter[isEssence]":this.threadEssence,"filter[isDisplay]":"yes","page[number]":this.pageNum,"page[limit]":this.pageSize,include:["user","user.groups","firstPost","firstPost.images","firstPost.postGoods","category","threadVideo","question","question.beUser","question.beUser.groups","threadAudio"]};null!==this.threadType&&(t["filter[type]"]=this.threadType),t["filter[fromUserId]"]=this.threadFollow;var i=o.status.run((function(){return e.$store.dispatch("jv/get",["threads",{params:t}])}));return this.threadsStatusId=i._statusID,i.then((function(t){e.loadingType=t.length===e.pageSize?"more":"nomore",delete t._jv,e.isResetList?e.threads=t:e.threads=[].concat(u(e.threads),u(t)),e.isResetList=!1}))},handleIsGreat:function(t,i,n){this.$store.getters["session/get"]("isLogin")||(e.setStorage({key:"page",data:"/pages/home/index"}),this.mpLoginMode());var o={_jv:{type:"posts",id:t},isLiked:!0!==n};this.$store.dispatch("jv/patch",o)},pullDown:function(){0===this.footerIndex&&"more"===this.loadingType&&(this.pageNum+=1,this.loadThreads())},handleVideoPlay:function(e,t){this.switchscroll=t,this.playIndex!==e&&null!==this.playIndex&&this.$refs["myVideo".concat(this.playIndex)][0].pauseVideo(),this.playIndex=e},ontrueGetList:function(){this.headerShow=!0,this.isResetList=!0,this.loadCategories(),this.loadThreadsSticky(),this.loadThreads()},getQueryString:function(e){var t=new RegExp("(^|&)".concat(e,"([^&]*)(&|$)")),i=window.location.search.substr(1).match(t);return null!=i?i[2].substring(1):null}})};t.default=$}).call(this,i("543d")["default"])}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/qui-page-home/qui-page-home-create-component',
    {
        'components/qui-page-home/qui-page-home-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("2aed"))
        })
    },
    [['components/qui-page-home/qui-page-home-create-component']]
]);
