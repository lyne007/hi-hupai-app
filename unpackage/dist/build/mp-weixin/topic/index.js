(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["topic/index"],{"097b":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i("db65"),a=i("2f62"),n=i("0301"),r=l(i("245a")),c=l(i("8605")),u=l(i("38c7")),h=l(i("412c")),d=i("198a"),p=l(i("d135"));function l(t){return t&&t.__esModule?t:{default:t}}function m(t){return S(t)||g(t)||y(t)||f()}function f(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function y(t,e){if(t){if("string"===typeof t)return w(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?w(t,e):void 0}}function g(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function S(t){if(Array.isArray(t))return w(t)}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var s=0,i=new Array(e);s<e;s++)i[s]=t[s];return i}function v(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function T(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?v(Object(s),!0).forEach((function(e){P(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function P(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var k=function(){i.e("components/uni-popup/uni-popup-dialog").then(function(){return resolve(i("8b8a"))}.bind(null,i)).catch(i.oe)},_=null,b=null,x=!0,C={components:{uniPopupDialog:k},mixins:[r.default,c.default,h.default,u.default],data:function(){return{imageList:[],navTitle:"内容详情页",threadId:"",loadDetailStatusId:0,posts:[],loadingType:"more",scrollTop:0,pageNum:1,pageSize:20,payThreadTypeText:"",loadDetailCommnetStatusId:0,postIndex:"",footerShow:!0,commentShow:!1,commentPopupStatus:!1,commentWorkTips:!0,commentText:!0,maxTextLength:5e3,cursor:0,textAreaValue:"",barStatus:!1,uploadFile:[],isLiked:!1,role:"管理员",isActive:!0,shareShow:!1,beAsk:!1,answerPay:!1,payment:!1,questionId:"",beAskDate:0,beAskBeDate:0,platformDate:0,onLookformDate:0,bottomData:[{text:this.i18n.t("core.generatePoster"),icon:"icon-poster",name:"wx"},{text:this.i18n.t("core.wxShare"),icon:"icon-wx-friends",name:"wxFriends"}],seleShow:!1,selectList:[{text:this.i18n.t("topic.edit"),type:"0"},{text:this.i18n.t("topic.essence"),type:"2"},{text:this.i18n.t("topic.sticky"),type:"3"},{text:this.i18n.t("topic.delete"),type:"4"}],limitShowNum:12,paidStatus:!1,paidBtnStatus:!1,rewardBtnStatus:!1,rewardStatus:!1,likedStatus:!1,commentStatus:{},commentReply:!1,commentAnser:!1,emojiShow:!1,publishClickStatus:!0,focusVal:!0,header:{},formData:{},commentId:"",isAnonymous:"0",payTypeText:"",payTypeVal:0,payNum:[{name:"￥1",pay:1},{name:"￥2",pay:2},{name:"￥5",pay:5},{name:"￥10",pay:10},{name:"￥20",pay:20},{name:"￥50",pay:50},{name:"￥88",pay:88},{name:"￥128",pay:128},{name:this.i18n.t("discuzq.post.customize"),pay:"0"}],payNumCheck:[{name:"",pay:""}],price:0,inputPrice:0,maxLength:7,payShowStatus:!0,pwdVal:"",orderSn:"",payStatus:!1,coverLoading:!1,payTypeData:[{name:"微信支付",icon:"icon-wxPay",color:"#09bb07",value:"0"},{name:"钱包支付",icon:"icon-walletPay",color:"#1878f3",value:"1"}],currentReplyPost:{},contentnomoreVal:"",url:"",customAmountStatus:!1,windowHeight:"",system:"",detectionmodel:"",paymentmodel:!1,loaded:!1,loadingStatus:!0,isWeixin:!1,isPhone:!1,qrcodeShow:!1,codeUrl:"",browser:0,wxRes:"",contentVal:"",shareLogo:"",desc:"",rewardedUsers:[],likedUsers:[],sortSeleShow:!1,sortSelectList:[{text:this.i18n.t("topic.sortTimeSequence"),type:"0",canOpera:!0},{text:this.i18n.t("topic.sortTimeReverse"),type:"1",canOpera:!0}],sortVal:"createdAt",refreshVal:!0,deleteId:"",deleteType:"",deletePostType:"",deletePostCanStatus:"",deletePostIsStatus:"",deletePost:"",deleteIndex:"",deleteTip:"确定删除吗？",wechatTip:this.i18n.t("discuzq.wechatBind"),deleteImgId:"",followStatus:"",beRewarded:!1,curUrl:"",bottom:"",moreData:[{text:this.i18n.t("topic.edit"),icon:"icon-bianji",name:"edit",type:"0",canOpera:!0},{text:this.i18n.t("topic.delete"),icon:"icon-shanchu",name:"delete",type:"4",canOpera:!0},{text:this.i18n.t("topic.essence"),icon:"icon-jinghua",name:"essence",type:"2",canOpera:!0},{text:this.i18n.t("topic.sticky"),icon:"icon-zhiding",name:"sticky",type:"3",canOpera:!0},{text:this.i18n.t("topic.collection"),icon:"icon-collection",name:"collection",type:"5",canOpera:!0},{text:this.i18n.t("topic.share"),icon:"icon-share",name:"share",type:"6",canOpera:!0},{text:this.i18n.t("core.generatePoster"),icon:"icon-poster",name:"poster",type:"7",canOpera:!0},{text:this.i18n.t("core.wxShare"),icon:"icon-wx-friends",name:"wxFriends",type:"8",canOpera:!0},{text:this.i18n.t("report.reportTitle"),icon:"icon-jubao",name:"report",type:"9",canOpera:!0}],moreDataLength:0,conversationId:"",attachmentFileList:[],refreshStatus:!0,threadIsPaidCover:!1,token:"",postGoodsStatus:!1}},onUnload:function(){this.$store.dispatch("forum/setError",{loading:!1}),t.$off("logind")},computed:T(T({},(0,a.mapState)({getAtMemberData:function(t){return t.atMember.atMemberData}})),{},{thread:function(){var t=this.$store.getters["jv/get"]("threads/".concat(this.threadId)),e=!1;return t.user&&t.user.groups&&t.user.groups.length>0&&(t.user.groups=t.user.groups.filter((function(t){if(!0===t.isDisplay&&!e)return e=!0,!0}))),t.rewardedUsers&&(this.rewardedUsers=t.rewardedUsers),t.firstPost&&(this.likedUsers=t.firstPost.likedUsers,t.firstPost.images&&(t.firstPost.images=t.firstPost.images.filter((function(e){return-1===t.firstPost.contentAttachIds.indexOf(e._jv.id)}))),t.firstPost.attachments&&(t.firstPost.attachments=t.firstPost.attachments.filter((function(e){return-1===t.firstPost.contentAttachIds.indexOf(e._jv.id)})))),t},t:function(){return this.i18n.t("topic")},p:function(){return this.i18n.t("pay")},c:function(){return this.i18n.t("core")},status:function(){return o.status.status},themeColor:function(){return this.theme===this.$u.light()?"#333":"#fff"},currentLoginId:function(){var t=this.$store.getters["session/get"]("userId");return parseInt(t,10)}}),onLoad:function(e){var s=this,i=t.getSystemInfoSync();if(this.system=i.platform,this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.detectionmodel=this.forums.set_site.site_mode),this.forums&&this.forums.paycenter&&this.forums.paycenter.wxpay_ios&&(this.paymentmodel=this.forums.paycenter.wxpay_ios),"public"===this.detectionmodel&&"ios"===this.system&&(this.paidStatus=!1,this.paidBtnStatus=!1,this.rewardBtnStatus=!1,this.rewardStatus=!1),"pay"!==this.detectionmodel||"ios"!==this.system){this.token=t.getStorageSync("access_token"),t.$on("logind",(function(){s.loadThread(),s.loadThreadPosts()})),this.threadId=e.id,this.conversationId=e.topicid||"",this.loadThread(),this.loadThreadPosts(),this.curUrl=(0,d.getCurUrl)(),this.rewardStatus=!1,this.paidStatus=!1,wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),this.$u.event.$on("addComment",(function(t){Object.keys(s.posts).forEach((function(e){s.posts[e]._jv.id===t.commentId&&(s.posts[e].lastThreeComments.length>=3&&s.posts[e].lastThreeComments.pop(),t.data&&s.posts[e].lastThreeComments.unshift(t.data))}))})),this.$u.event.$on("deleteComment",(function(t){Object.keys(s.posts).forEach((function(e){s.posts[e]._jv.id===t.commentId&&(s.posts[e].lastThreeComments=[],t.data._jv.json.data.relationships.lastThreeComments.data&&t.data._jv.json.data.relationships.lastThreeComments.data.forEach((function(t){s.posts[e].lastThreeComments.push(s.$store.getters["jv/get"]("".concat(t.type,"/").concat(t.id)))})))}))})),this.url=n.DISCUZ_REQUEST_HOST;var o=t.getStorageSync("access_token");this.header={authorization:"Bearer ".concat(o)},this.formData={type:1},this.$u.event.$on("refreshFiles",(function(){s.loadThread()}))}else this.$store.dispatch("forum/setError",{loading:!1,code:"dataerro"})},onPullDownRefresh:function(){var e=this;e.posts=[],e.pageNum=1,e.attachmentFileList=[],setTimeout((function(){x=!0,e.loadThread(),e.loadThreadPosts(),t.stopPullDownRefresh()}),1e3)},onReachBottom:function(){"more"===this.loadingType&&(this.pageNum+=1,this.loadThreadPosts())},onPageScroll:function(t){this.scrollTop=t.scrollTop},onShareAppMessage:function(t){if("button"===t.from){var e=this.$store.getters["jv/get"]("/threads/".concat(this.threadId));return{title:1===e.type?this.thread.title:this.thread.firstPost.summaryText}}return{title:this.forums.set_site.site_name}},onShareTimeline:function(){var t=this.$store.getters["jv/get"]("/threads/".concat(this.threadId));return{title:1===t.type?this.thread.title:this.thread.firstPost.summaryText,query:"id=".concat(this.threadId),imageUrl:this.shareLogo}},onShow:function(){var e=t.getSystemInfoSync();if(this.system=e.platform,this.forums&&this.forums.set_site&&this.forums.set_site.site_mode&&(this.detectionmodel=this.forums.set_site.site_mode),this.forums&&this.forums.paycenter&&this.forums.paycenter.wxpay_ios&&(this.paymentmodel=this.forums.paycenter.wxpay_ios),"public"===this.detectionmodel&&"ios"===this.system&&(this.paidStatus=!1,this.paidBtnStatus=!1,this.rewardBtnStatus=!1,this.rewardStatus=!1),"pay"!==this.detectionmodel||"ios"!==this.system){var s="";this.getAtMemberData.map((function(t){return s+="@".concat(t.username," "),s})),this.textAreaValue="".concat(this.textAreaValue.slice(0,this.cursor)+s+this.textAreaValue.slice(this.cursor)),this.setAtMember([])}else this.$store.dispatch("forum/setError",{loading:!1,code:"dataerro"})},methods:T(T({},(0,a.mapMutations)({setAtMember:"atMember/SET_ATMEMBER",setCategoryId:"session/SET_CATEGORYID",setCategoryIndex:"session/SET_CATEGORYINDEX",setFooterIndex:"footerTab/SET_FOOTERINDEX"})),{},{touchStop:function(){},loadThread:function(){var e=this,s={include:["posts.replyUser","user.groups","user","posts","posts.user","posts.likedUsers","posts.images","firstPost","firstPost.likedUsers","firstPost.images","firstPost.attachments","firstPost.postGoods","rewardedUsers","category","threadVideo","threadAudio","paidUsers","user.groups.permissionWithoutCategories","question","onlookers","question.beUser","question.images"]},i=o.status.run((function(){return e.$store.dispatch("jv/get",["threads/".concat(e.threadId),{params:s}])}));this.loadDetailStatusId=i._statusID,i.then((function(s){if(e.$store.dispatch("session/setThread",s),s.isDeleted)e.$store.dispatch("forum/setError",{code:"thread_deleted",status:500}),e.loaded=!1;else switch(s.firstPost.postGoods?e.postGoodsStatus=!0:e.postGoodsStatus=!1,1===s.type?s.attachmentPrice>0||s.price>0&&s.isPaid||s.price<=0?e.threadIsPaidCover=!1:s.price>0&&!s.isPaid&&(e.threadIsPaidCover=!0):e.threadIsPaidCover=!1,x&&s.firstPost.attachments.forEach((function(t){-1===s.firstPost.contentAttachIds.indexOf(t._jv.id)&&e.attachmentFileList.push(t)})),s.question&&(console.log(s,"xiangqing"),e.platformDate=(s.question.price*(e.forums.set_site.site_master_scale/10)).toFixed(2),e.onLookformDate=(s.question.onlooker_unit_price*(e.forums.set_site.site_master_scale/10)).toFixed(2),e.beAskDate=(s.question.price-e.platformDate).toFixed(2),e.beAskBeDate=((s.question.onlooker_unit_price-e.onLookformDate)/2).toFixed(2),"0.00"===s.question.price?e.user.id===s.question.be_user_id&&0===s.question.is_answer?e.beAsk=!0:e.user.id===s.user.id&&1===s.question.is_answer?(e.beAsk=!1,e.payment=!0,e.answerPay=!1,console.log(s,"免费允许围观")):e.user.id===s.question.be_user_id&&1===s.question.is_answer?(e.beAsk=!1,e.payment=!0,e.answerPay=!1):e.user.id!==s.question.be_user_id&&e.user.id!==s.user.id&&1===s.question.is_answer&&!0===s.question.is_onlooker?(e.beAsk=!1,e.payment=!1,e.answerPay=!0,console.log("允许围观可查看答案")):e.user.id!==s.question.be_user_id&&e.user.id!==s.user.id&&1===s.question.is_answer&&!1===s.question.is_onlooker&&(e.beAsk=!1,e.payment=!1,e.answerPay=!0,console.log("免费不设置围观也可查看答案")):s.question.price>"0.00"&&(e.user.id===s.question.be_user_id&&0===s.question.is_answer?e.beAsk=!0:e.user.id===s.question.be_user_id&&1===s.question.is_answer?(e.beAsk=!1,e.answerPay=!0,console.log("显示答案")):e.user.id===s.user.id&&1===s.question.is_answer?(e.beAsk=!1,e.answerPay=!0):e.user.id===s.question.be_user_id&&1===s.question.is_answer&&s.question.onlooker_number>0?(e.answerPay=!0,e.beAsk=!1,console.log("3333344444")):e.user.id===s.user.id&&1===s.question.is_answer&&s.question.onlooker_number>0?(e.answerPay=!0,e.beAsk=!1):e.user.id!==s.question.be_user_id&&e.user.id!==s.user.id&&1===s.question.is_answer&&!1===s.question.is_onlooker&&!0===s.onlookerState?(e.answerPay=!0,console.log("付费允许围观付费即可查看答案222222")):e.user.id!==s.user.id&&1===s.question.is_answer&&!0===s.question.is_onlooker&&!1===s.onlookerState?(e.answerPay=!0,console.log("付费不允许围观")):e.user.id!==s.user.id&&e.user.id!==s.question.be_user_id&&!0===s.question.is_onlooker&&1===s.question.is_answer&&!0===s.onlookerState&&(e.answerPay=!0,console.log("付费允许围观"))),e.questionId=s.question._jv.id),s.user.groups&&s.user.groups.length>0&&s.user.groups[0].permissionWithoutCategories.forEach((function(t,s){"createThreadPaid"!==t.permission||(e.beRewarded=!0)})),s.user.groups&&s.user.groups.length>0&&"1"===s.user.groups[0]._jv.id&&(e.beRewarded=!0),e.loaded=!0,e.loadingStatus=!1,s.type){case 0:e.contentVal=s.firstPost.summaryText,e.desc=s.firstPost.summaryText,e.shareLogo="";break;case 1:e.contentVal=s.title,s.price>0?(e.desc=s.title,e.shareLogo=""):(e.desc=s.firstPost.summaryText,e.shareLogo=s.firstPost.images.length>0?s.firstPost.images[0].thumbUrl:"");break;case 2:e.contentVal=s.firstPost.summaryText,e.desc=s.firstPost.summaryText,e.shareLogo=s.threadVideo.coverUrl;break;case 3:e.contentVal=s.firstPost.summaryText,e.desc=s.firstPost.summaryText,e.shareLogo=0==s.price&&s.firstPost.images.length>0?s.firstPost.images[0].thumbUrl:"";break;case 4:e.contentVal=s.firstPost.summaryText,e.desc=s.firstPost.summaryText,e.shareLogo="";break;case 5:e.contentVal=s.firstPost.summaryText,e.desc=s.firstPost.summaryText,e.shareLogo=s.firstPost.images.length>0?s.firstPost.images[0].thumbUrl:"";break;case 6:e.contentVal=s.firstPost.postGoods.title,e.desc=s.firstPost.summaryText,e.shareLogo=s.firstPost.postGoods.image_path;break;default:}if(e.selectList[0].canOpera=e.thread.firstPost.canEdit,e.selectList[1].canOpera=e.thread.canEssence,e.selectList[2].canOpera=e.thread.canSticky,e.selectList[3].canOpera=e.thread.canHide,e.selectList[1].isStatus=e.thread.isEssence,e.selectList[2].isStatus=e.thread.isSticky,e.selectList[3].isStatus=!1,s.isEssence&&(e.selectList[1].text=e.t.cancelEssence),s.isSticky&&(e.selectList[2].text=e.t.cancelSticky),e.moreData[5].canOpera=!1,e.moreData[6].canOpera=!0,e.moreData[7].canOpera=!0,5===s.type?e.moreData[0].canOpera=!1:e.moreData[0].canOpera=e.thread.firstPost.canEdit,e.moreData[2].canOpera=e.thread.canEssence,e.moreData[3].canOpera=e.thread.canSticky,e.moreData[1].canOpera=e.thread.canHide,e.moreData[2].isStatus=e.thread.isEssence,e.moreData[3].isStatus=e.thread.isSticky,e.moreData[1].isStatus=!1,e.moreData.forEach((function(t){t.canOpera&&(e.moreDataLength+=1)})),s.isFavorite&&(e.moreData[4].text=e.t.collectionAlready,e.moreData[4].icon="icon-collectioned"),s.isEssence&&(e.moreData[2].text=e.t.cancelEssence,e.moreData[2].icon="icon-quxiaojinghua"),s.isSticky&&(e.moreData[3].text=e.t.cancelSticky,e.moreData[3].icon="icon-quxiaozhiding"),e.isLiked=s.firstPost.isLiked,5===s.type)return e.rewardStatus=!1,void(e.paidStatus=!1);if(e.forums.paycenter.wxpay_close)if(e.forums.paycenter.wxpay_close){var i=t.getSystemInfoSync();e.system=i.platform,(!s.paid||s.paidUsers.length>0)&&("ios"===e.system&&!1===e.paymentmodel?(e.paidStatus=!1,e.paidBtnStatus=!1):(e.paidStatus=!0,e.paidBtnStatus=!0)),3===s.type?e.payThreadTypeText=e.t.pay+s.price+e.t.paymentViewPicture:2===s.type?e.payThreadTypeText=e.t.pay+s.price+e.t.paymentViewVideo:1===s.type?s.attachmentPrice>0?e.payThreadTypeText=e.t.pay+s.attachmentPrice+e.t.checkTheAttachment:e.payThreadTypeText=e.t.pay+s.price+e.t.paymentViewRemainingContent:5===s.type?e.payThreadTypeText=e.t.pay+s.price+e.t.paymentViewRemainingContent:4===s.type&&(e.payThreadTypeText=e.t.pay+s.price+e.t.paymentViewAudio),s.price<=0?"ios"===e.system?s.attachmentPrice>0&&!1===s.isPaidAttachment?!1===e.paymentmodel?(e.paidStatus=!1,e.rewardStatus=!1):!0===e.paymentmodel&&(e.paidStatus=!0,e.rewardStatus=!1):s.attachmentPrice>0&&!0===s.isPaidAttachment?!1===e.paymentmodel?(e.paidStatus=!1,e.rewardStatus=!1):!0===e.paymentmodel&&(e.paidStatus=!0,e.paidBtnStatus=!1,e.rewardStatus=!1):!1===e.paymentmodel?(e.paidStatus=!1,e.rewardStatus=!1):!0===e.paymentmodel&&(s.canBeReward?(e.paidStatus=!1,e.rewardStatus=!0,e.rewardBtnStatus=!0):(e.rewardStatus=!1,e.rewardBtnStatus=!1)):s.attachmentPrice>0&&!1===s.isPaidAttachment?(e.paidStatus=!0,e.paidBtnStatus=!0,e.rewardStatus=!1,e.rewardBtnStatus=!1):s.attachmentPrice>0&&!0===s.isPaidAttachment?(e.paidStatus=!0,e.paidBtnStatus=!1,e.rewardStatus=!1,e.rewardBtnStatus=!1):s.canBeReward?(e.paidStatus=!1,e.rewardStatus=!0,e.rewardBtnStatus=!0):(e.paidStatus=!1,e.rewardStatus=!1,e.rewardBtnStatus=!1):("ios"===e.system?!1===e.paymentmodel?(e.paidStatus=!1,e.paidBtnStatus=!1):!0===e.paymentmodel&&!1===s.paid?(e.paidStatus=!0,e.paidBtnStatus=!0):!0===e.paymentmodel&&!0===s.paid&&(e.paidStatus=!0,e.paidBtnStatus=!1):!0===s.paid?e.paidBtnStatus=!1:(e.paidStatus=!0,e.paidBtnStatus=!0),e.rewardStatus=!1,e.rewardBtnStatus=!1)}else e.rewardStatus=!1,e.paidBtnStatus=!1;else e.rewardStatus=!1,e.paidStatus=!1;s.firstPost.likedUsers.length<1?e.likedStatus=!1:e.likedStatus=!0})).catch((function(t){e.loaded=!1,e.loadingStatus=!1,console.log(t),404===t.statusCode&&e.$store.dispatch("forum/setError",{code:"type_404",status:500})}))},postOpera:function(e,s,i,o,a){var n=this;if("1"!==s||i)if("4"!==s||i){var r={type:"posts",id:e},c={};"1"===s?c={_jv:r,isLiked:!o}:"3"===s?c={_jv:r,isDeleted:!o}:"4"===s&&(c={_jv:r,isLiked:!o}),this.$store.dispatch("jv/patch",c).then((function(e){if("1"===s)n._updateLikedUsers(e.isLiked);else if("2"===s)e.isDeleted&&t.navigateBack({delta:1});else if("3"===s){var i=a;i.isDeleted=e.isDeleted,a=i}else if("4"===s){var o=a;o.isLiked=e.isLiked,o.likeCount=e.likeCount,a=o}})).catch((function(t){console.log(t)}))}else this.$refs.toast.show({message:this.t.noReplyLikePermission});else this.$refs.toast.show({message:this.t.noThreadLikePermission})},threadOpera:function(e,s,i,o){var a=this,n={type:"threads",id:e},r={};r="1"===o?{_jv:n,isFavorite:!i}:"2"===o?{_jv:n,isEssence:!i}:"3"===o?{_jv:n,isSticky:!i}:{_jv:n,isDeleted:!i},this.$store.dispatch("jv/patch",r).then((function(e){if("1"===o)a.thread.isFavorite=e.isFavorite,e.isFavorite?(a.moreData[4].text=a.t.collectionAlready,a.moreData[4].icon="icon-collectioned"):(a.moreData[4].text=a.t.collection,a.moreData[4].icon="icon-collection");else if("2"===o)a.selectList[1].isStatus=e.isEssence,a.moreData[2].isStatus=e.isEssence,e.isEssence?(a.selectList[1].text=a.t.cancelEssence,a.moreData[2].text=a.t.cancelEssence,a.moreData[2].icon="icon-quxiaojinghua"):(a.selectList[1].text=a.t.essence,a.moreData[2].text=a.t.essence,a.moreData[2].icon="icon-jinghua");else if("3"===o)a.selectList[2].isStatus=e.isSticky,a.moreData[3].isStatus=e.isSticky,e.isSticky?(a.selectList[2].text=a.t.cancelSticky,a.moreData[3].icon="icon-quxiaozhiding",a.moreData[3].text=a.t.cancelSticky):(a.selectList[2].text=a.t.sticky,a.moreData[3].icon="icon-zhiding",a.moreData[3].text=a.t.sticky);else if("4"===o){var s=a;if(e.isDeleted){a.$refs.toast.show({message:a.t.deleteSuccessAndJumpToBack});getCurrentPages(),setTimeout((function(){console.log(s.conversationId),s.conversationId?t.redirectTo({url:"/pages/topic/content?id=".concat(s.conversationId)}):t.navigateBack({delta:1}),s.$store.dispatch("jv/get","topics/".concat(s.conversationId)).then((function(t){t&&(s.conversationId="")}))}),1e3)}}})).catch((function(t){console.log(t)}))},postComment:function(){var t=this;if(this.textAreaValue.length<1)return this.$refs.toast.show({message:this.t.replyContentCannotBeEmpty}),this.publishClickStatus=!0,!1;var e={};this.commentReply?e={_jv:{type:"posts",relationships:{thread:{data:{type:"threads",id:this.threadId}}}},content:this.textAreaValue,isComment:!0,replyId:this.commentId}:this.commentAnser||(e={_jv:{type:"posts",relationships:{thread:{data:{type:"threads",id:this.threadId}}}},content:this.textAreaValue}),e._jv.relationships.attachments={data:[]},this.uploadFile&&this.uploadFile.forEach((function(t){e._jv.relationships.attachments.data.push({type:"attachments",id:t.id})})),this.$store.dispatch("jv/post",e).then((function(e){if(t.$refs.commentPopup.close(),t.commentReply=!1,t.commentPopupStatus=!1,t.publishClickStatus=!0,1===e.isApproved)if(e.isComment)console.log("%%%%%%%"),t.posts[t.postIndex].lastThreeComments||(t.posts[t.postIndex].lastThreeComments=[]),t.posts[t.postIndex].lastThreeComments.unshift(e),t.posts[t.postIndex].replyCount+=1;else{var s=!1;e.user.groups=e.user.groups.filter((function(t){return!0===t.isDisplay&&!s&&(s=!0,!0)})),t.posts.push(e)}else t.$refs.toast.show({message:"您发布的内容正在审核中哦"});t.textAreaValue="",t.uploadFile=""})).catch((function(e){t.publishClickStatus=!0,console.log(e)}))},handleGroup:function(t){var e=[];return t&&t.length>0&&(e=t.filter((function(t){return t.isDisplay}))),e.length>0?[e[0]]:[]},postAnswer:function(){var e=this;if(this.commentAnser=!0,this.textAreaValue.length<1)return this.$refs.toast.show({message:this.t.TheContentOfTheAnswerCannotBeEmpty}),this.publishClickStatus=!0,!1;var s={content:this.textAreaValue,type:5,_jv:{type:"answer",relationships:{},links:{self:"questions/".concat(this.questionId,"/answer")}}};s._jv.relationships.attachments={data:[]},this.uploadFile&&this.uploadFile.forEach((function(t){s._jv.relationships.attachments.data.push({type:"attachments",id:t.id})})),this.$store.dispatch("jv/post",s).then((function(t){e.$refs.commentPopup.close(),e.loadThread()})).catch((function(s){s&&s.data&&s.data.errors&&"content_banned_show_words"===s.data.errors[0].code&&t.showToast({icon:"none",title:"".concat(e.i18n.t("core.content_banned_show_words"),"[").concat(s.data.errors[0].detail.join("、"),"]"),duration:2e3})}))},loadThreadPosts:function(){var t=this,e={"filter[isApproved]":1,"filter[isDeleted]":"no","filter[isComment]":"no","page[number]":this.pageNum,"page[limit]":this.pageSize,"filter[thread]":this.threadId,sort:this.sortVal,include:["replyUser","user.groups","user","images","lastThreeComments","lastThreeComments.user","lastThreeComments.replyUser"]},s=o.status.run((function(){return t.$store.dispatch("jv/get",["posts",{params:e}])}));this.loadDetailCommnetStatusId=s._statusID,s.then((function(e){delete e._jv,e.forEach((function(t,s){var i=!1;e[s].user.groups=e[s].user.groups.filter((function(t){return!0===t.isDisplay&&!i&&(i=!0,!0)}))})),t.loadingType=e.length===t.pageSize?"more":"nomore",t.posts=[].concat(m(t.posts),m(e)),0===e.length?t.contentnomoreVal=t.t.noComment:t.contentnomoreVal=t.t.noMoreData}))},onBridgeReady:function(t){var e=this;console.log(t,"datadata"),WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.wechat_js.appId,timeStamp:t.wechat_js.timeStamp,nonceStr:t.wechat_js.nonceStr,package:t.wechat_js.package,signType:"MD5",paySign:t.wechat_js.paySign},(function(t){"get_brand_wcpay_request:ok"==t.err_msg||("get_brand_wcpay_request:cancel"==t.err_msg||"get_brand_wcpay_request:fail"==t.err_msg)&&(clearInterval(_),resolve)})),_=setInterval((function(){1!==e.payStatus?e.getOrderStatus(e.orderSn):clearInterval(_)}),3e3)},creatOrder:function(t,e,s,i){var o=this,a={_jv:{type:"orders"},type:e,thread_id:this.threadId,amount:t,is_anonymous:this.isAnonymous};this.$store.dispatch("jv/post",a).then((function(t){o.orderSn=t.order_sn,0===i?0==o.browser?o.orderPay(13,s,o.orderSn,i,"0"):o.isWeixin&&o.isPhone?o.orderPay(12,s,o.orderSn,i,"1"):o.isPhone?o.orderPay(11,s,o.orderSn,i,"2"):o.orderPay(10,s,o.orderSn,i,"3"):1===i&&o.orderPay(20,s,o.orderSn,i)})).catch((function(t){console.log(t)}))},orderPay:function(e,s,i,o,a){var n=this,r={};0===o?r={_jv:{type:"trade/pay/order/".concat(i)},payment_type:e}:1===o&&(r={_jv:{type:"trade/pay/order/".concat(i)},payment_type:e,pay_password:s}),this.$store.dispatch("jv/post",r).then((function(e){n.wxRes=e,0===o?"0"===a?n.wechatPay(e.wechat_js.timeStamp,e.wechat_js.nonceStr,e.wechat_js.package,e.wechat_js.signType,e.wechat_js.paySign):"1"===a?"undefined"===typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",n.onBridgeReady(e),!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",n.onBridgeReady(e)),document.attachEvent("onWeixinJSBridgeReady",n.onBridgeReady(e))):n.onBridgeReady(e):"2"===a?(b=setInterval((function(){1!==n.payStatus?n.getOrderStatus(i,a):clearInterval(b)}),3e3),window.location.href=e.wechat_h5_link):"3"===a&&e&&(n.codeUrl=e.wechat_qrcode,n.payShowStatus=!1,n.$refs.codePopup.open(),n.qrcodeShow=!0,_=setInterval((function(){1!==n.payStatus?(n.getOrderStatus(n.orderSn,a),t.hideLoading()):clearInterval(_)}),3e3)):1===o&&("success"===e.wallet_pay.result&&(n.$store.dispatch("jv/get",["users/".concat(n.currentLoginId),{}]),0===n.payTypeVal||2===n.payTypeVal||3===n.payTypeVal?(n.thread.attachmentPrice>0&&(x=!1),n.loadThread(),n.$store.dispatch("jv/get",["forum",{params:{include:"users"}}])):1===n.payTypeVal&&n._updateRewardUsers(),n.payShowStatus=!1,n.coverLoading=!1),n.coverLoading=!1)})).catch((function(t){console.log(t),n.$refs.payShow.clearPassword()}))},getOrderStatus:function(t,e){var s=this;this.$store.dispatch("jv/get",["orders/".concat(t),{custom:{loading:!1}}]).then((function(t){s.payStatus=t.status,1===s.payStatus&&(s.payShowStatus=!1,s.coverLoading=!1,"2"===e||"3"===e&&(s.$refs.codePopup.close(),s.qrcodeShow=!1,x=!1,s.loadThread(),s.$store.dispatch("jv/get",["forum",{params:{include:"users"}}])),0===s.payTypeVal||2===s.payTypeVal||3===s.payTypeVal?(s.thread.attachmentPrice>0&&(x=!1),s.loadThread(),s.$store.dispatch("jv/get",["forum",{params:{include:"users"}}])):1===s.payTypeVal&&s._updateRewardUsers(),s.$refs.toast.show({message:s.p.paySuccess}))})).catch((function(t){console.log(t),s.coverLoading=!1,s.$refs.toast.show({message:s.p.payFail})}))},wechatPay:function(e,s,i,o,a){var n=this;t.requestPayment({provider:"wxpay",timeStamp:e,nonceStr:s,package:i,signType:o,paySign:a,success:function(t){n.coverLoading=!0,_=setInterval((function(){1!==n.payStatus?n.getOrderStatus(n.orderSn):clearInterval(_)}),3e3)},fail:function(t){n.payShowStatus=!1,n.coverLoading=!1,n.$refs.toast.show({message:n.p.payFail})}})},onInput:function(t){this.value=t,0===this.payTypeVal?this.creatOrder(this.thread.price,3,t,1):1===this.payTypeVal?this.creatOrder(this.price,2,t,1):2===this.payTypeVal?this.creatOrder(this.price,6,t,1):3===this.payTypeVal&&this.creatOrder(this.thread.attachmentPrice,7,t,1)},paysureShow:function(e){if(t.setStorage({key:"page",data:"/topic/index?id=".concat(this.threadId)}),0===e){if(void 0===this.user.wechat||this.user.wechat&&""===this.user.wechat.min_openid)return void this.$refs.wechatPopup.open();0===this.payTypeVal?this.creatOrder(this.thread.price,3,this.value,e):1===this.payTypeVal?this.creatOrder(this.price,2,this.value,e):2===this.payTypeVal?this.creatOrder(this.price,6,this.value,e):3===this.payTypeVal&&this.creatOrder(this.thread.attachmentPrice,7,this.value,e)}},limitArray:function(t){var e=[];return Object.values(t).forEach((function(t){e.push(t)})),e},selectClick:function(){this.seleShow=!this.seleShow},selectChoice:function(e){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),"0"===e.type?t.redirectTo({url:"/topic/post?type=".concat(this.thread.type,"&operating=edit&threadId=").concat(this.thread._jv.id)}):"2"===e.type||"3"===e.type?this.threadOpera(this.threadId,e.canOpera,e.status,e.type):"4"===e.type&&(this.$refs.deletePopup.open(),this.deleteType="4",this.deleteId=this.threadId,this.deletePostCanStatus=e.canOpera,this.deletePostIsStatus=e.status,this.deletePostType=e.type,this.deleteTip=this.i18n.t("core.deleteContentSure"))},beAskClick:function(e){e<=0||t.navigateTo({url:"/pages/profile/index?userId=".concat(e)})},personJump:function(e){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),e<=0||t.navigateTo({url:"/pages/profile/index?userId=".concat(e)})},payClickShow:function(){var e=this;if(this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.payStatus=!1,this.forums.paycenter.wxpay_close)if(this.forums.paycenter.wxpay_close){if("ios"===this.system){if(!1===this.paymentmodel)return void(this.payShowStatus=!1);this.payShowStatus=!0}else this.payShowStatus=!0;this.payTypeVal=0,this.thread.attachmentPrice>0?this.payTypeVal=3:this.payTypeVal=0,3===this.thread.type?(this.payTypeText=this.t.pay+this.t.paymentViewPicture,this.price=parseFloat(this.thread.price)):1===this.thread.type?this.thread.attachmentPrice>0?(this.payTypeText=this.t.pay+this.thread.attachmentPrice+this.t.checkTheAttachment,this.price=parseFloat(this.thread.attachmentPrice)):(this.payTypeText=this.t.pay+this.thread.price+this.t.paymentViewRemainingContent,this.price=parseFloat(this.thread.price)):2===this.thread.type?(this.payTypeText=this.t.pay+this.t.paymentViewVideo,this.price=parseFloat(this.thread.price)):4===this.thread.type&&(this.payTypeText=this.t.pay+this.t.paymentViewAudio,this.price=parseFloat(this.thread.price)),this.$nextTick((function(){e.$refs.payShow.payClickShow(e.payTypeVal)}))}else this.payShowStatus=!1;else this.payShowStatus=!1},payAnswerClickShow:function(){var e=this;this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.payStatus=!1,this.payTypeVal=2,this.price=parseFloat(this.thread.question.onlooker_unit_price),this.$nextTick((function(){e.$refs.payShow.payClickShow(e.payTypeVal)}))},radioMyHead:function(t){this.isAnonymous=!t},radioChange:function(t){},rewardClick:function(){if(this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.user._jv.id===this.thread.user._jv.id)return this.$refs.toast.show({message:this.t.iCantRewardMyself}),!1;this.payStatus=!1,this.payTypeVal=1,this.payTypeText=this.t.supportTheAuthorToCreate,this.payNumCheck=[{name:"",pay:""}],this.$refs.rewardPopup.open()},cancelReward:function(){this.payNumCheck=[{name:"",pay:""}],this.$refs.rewardPopup.close()},moneyClick:function(t){var e=this;this.payNumCheck=[],this.payNumCheck.push(this.payNum[t]),"自定义"===this.payNumCheck[0].name?(this.$refs.rewardPopup.close(),this.$nextTick((function(){e.$refs.customAmountPopup.open(),e.customAmountStatus=!0}))):(this.price=this.payNumCheck[0].pay,this.payShowStatus=!0,this.$refs.rewardPopup.close(),this.payTypeVal=1,this.$nextTick((function(){e.$refs.payShow.payClickShow(e.payTypeVal)})))},checkNum:function(e){var s=this,i=e.target.value,o=i.indexOf(".");i.indexOf(".")<0&&""!=i?i.length>6?(i=i.substring(0,i.length-1),t.showToast({title:s.c.TheAmountCannotExceedOneMillion,icon:"none"})):i=parseFloat(i):0==i.indexOf(".")?(i=i.replace(/[^$#$]/g,"0."),i=i.replace(/\.{2,}/g,".")):/^(\d?)+(\.\d{0,2})?$/.test(i)||(i=i.substring(0,i.length-1)),s.$nextTick((function(){s.maxLength=-1==o?7:10,s.inputPrice=i}))},diaLogClose:function(){this.$refs.customAmountPopup.close(),this.customAmountStatus=!1},diaLogOk:function(){var e=this;if(""===this.forums.set_site.site_minimum_amount){if(this.inputPrice<"0.1")return void t.showToast({title:this.i18n.t("core.TheAmountCannotBeLessThanOneYuan"),icon:"none"})}else if(this.inputPrice<this.forums.set_site.site_minimum_amount)return void t.showToast({title:this.i18n.t("core.TheAmountCannotBeLessThanMinMoney")+this.forums.set_site.site_minimum_amount+this.i18n.t("discuzq.post.yuan"),icon:"none"});this.price=Number(this.inputPrice),this.$refs.customAmountPopup.close(),this.customAmountStatus=!1,this.payShowStatus=!0,this.$nextTick((function(){e.$refs.payShow.payClickShow(e.payTypeVal)}))},contBlur:function(t){this.cursor=t.detail.cursor},getEmojiClick:function(t){var e="";e="".concat(this.textAreaValue.slice(0,this.cursor)+t+this.textAreaValue.slice(this.cursor)),this.textAreaValue=e,this.emojiShow=!1},callClick:function(){t.navigateTo({url:"/pages/user/at-member"})},uploadChange:function(t){this.uploadFile=t},uploadClear:function(t,e){var s=t.id;this.deleteType=0,this.deleteImgId=s,this.deleteIndex=e,this.$refs.deletePopup.open(),this.deleteTip=this.i18n.t("core.deleteImgSure")},delAttachments:function(t){var e={_jv:{type:"attachments",id:t}};return this.$store.dispatch("jv/delete",e).then((function(t){return t})).catch((function(t){console.log(t)}))},publishClick:function(){this.publishClickStatus=!1,!0===this.commentAnser?this.postAnswer():this.postComment(this.commentId)},commentJump:function(e,s){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:"/pages/topic/comment?threadId=".concat(e,"&commentId=").concat(s)}),this.mpLoginMode()),t.navigateTo({url:"/pages/topic/comment?threadId=".concat(e,"&commentId=").concat(s)})},commentLikeClick:function(e,s,i,o,a,n){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.postIndex=a,this.postOpera(e,s,i,o,n)},deleteComment:function(e,s,i,o,a){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.$refs.deletePopup.open(),this.deleteId=e,this.deleteType="3",this.deletePostCanStatus=i,this.deletePostIsStatus=o,this.deletePost=a,this.deleteTip=this.i18n.t("core.deleteCommentSure")},replyComment:function(e,s){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.thread.canReply?(this.commentReply=!0,this.postIndex=s,this.commentId=e,this.$refs.commentPopup.open(),this.commentPopupStatus=!0,this.commentWorkTips=!0,this.commentText=!1,this.focusVal=!0):this.$refs.toast.show({message:this.t.noReplyPermission})},imageClick:function(){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode())},tagClick:function(e){this.$u.event.$emit("tagClick",e);var s=getCurrentPages(),i=s.indexOf(s[s.length-1]);s.length>1&&s[i-1].route&&"pages/home/index"===s[i-1].route?(t.navigateBack({delta:i}),this.setFooterIndex(0)):(t.navigateTo({url:"/pages/home/index"}),this.setFooterIndex(0))},threadLikeClick:function(e,s,i){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.postOpera(e,"1",s,i)},threadCollectionClick:function(e,s,i,o){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.threadOpera(e,s,i,o)},threadComment:function(e){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.thread.canReply?(this.commentId=e,this.formData.type=1,this.$refs.commentPopup.open(),this.commentPopupStatus=!0,this.commentWorkTips=!0,this.commentText=!1,this.focusVal=!0):this.$refs.toast.show({message:this.t.noReplyPermission})},queClick:function(){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.formData.type=5,this.commentAnser=!0,this.$refs.commentPopup.open(),this.commentPopupStatus=!0,this.commentWorkTips=!1,this.commentText=!0,this.maxTextLength=49999},handleClickOk:function(){var t=this;this.$refs.deletePopup.close(),"4"===this.deleteType?this.threadOpera(this.deleteId,this.deletePostCanStatus,this.deletePostIsStatus,this.deleteType):"3"===this.deleteType?this.postOpera(this.deleteId,"3",this.deletePostCanStatus,this.deletePostIsStatus,this.deletePost):0===this.deleteType&&this.delAttachments(this.deleteImgId,this.deleteIndex).then((function(){t.$refs.upload.clear(t.deleteIndex),t.$refs.upload.getValue().forEach((function(e,s,i){e.id==t.deleteImgId&&i.splice(s,1)}))}))},handleWechatClickOk:function(){this.$refs.wechatPopup.close(),this.mpLogin()},handleWechatClickCancel:function(){this.$refs.wechatPopup.close()},handleClickCancel:function(){this.$refs.deletePopup.close()},shareClick:function(){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.$refs.sharePopup.open(),this.forums.set_site&&"pay"===this.forums.set_site.site_mode&&this.bottomData.forEach((function(t,e,s){"wxFriends"===t.name&&s.splice(e,1)}))},cancel:function(){this.$refs.sharePopup.close()},shareContent:function(e){0===e&&(0==this.thread.isApproved?t.showToast({icon:"none",title:this.i18n.t("topic.underReview"),duration:2e3}):t.navigateTo({url:"/pages/share/topic?id=".concat(this.threadId)})),this.cancel()},codeImgChange:function(t){t.show||clearInterval(_)},_updateLikedUsers:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isLiked=e,this.isLiked?(this.likedUsers.unshift(this.user),this.thread.firstPost._jv.relationships.likedUsers.data.unshift({type:this.user._jv.type,id:this.user._jv.id})):(this.likedUsers.forEach((function(e,s,i){e.id==t.user.id&&i.splice(s,1)})),this.thread.firstPost._jv.relationships.likedUsers.data.forEach((function(e,s,i){e.id==t.user.id&&i.splice(s,1)}))),this.$forceUpdate()},_updateRewardUsers:function(){1===this.payTypeVal&&(this.thread.rewardedCount++,this.rewardStatus||(this.rewardStatus=!0,this.rewardBtnStatus=!0)),this.rewardedUsers.unshift(this.user),this.thread._jv.relationships.rewardedUsers.data.unshift({type:this.user._jv.type,id:this.user._jv.id}),this.$forceUpdate()},onUnload:function(){clearInterval(_),clearInterval(b)},sortOperaClick:function(){this.sortSeleShow=!this.sortSeleShow},sortSelectChoice:function(e){var s=this;this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.sortSeleShow=!1,"0"===e.type?"createdAt"===this.sortVal?this.$refs.toast.show({message:this.t.itsAlreadyWantedSort}):(this.refreshVal=!1,this.$nextTick((function(){s.refreshVal=!0})),this.sortVal="createdAt",this.posts=[],this.loadThreadPosts()):"1"===e.type&&("-createdAt"===this.sortVal?this.$refs.toast.show({message:this.t.itsAlreadyWantedSort}):(this.refreshVal=!1,this.sortVal="-createdAt",this.posts=[],this.loadThreadPosts(),this.$nextTick((function(){s.refreshVal=!0}))))},addFollow:function(e){var s=this;this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode());var i=this.$store.getters["jv/get"]("users/".concat(e.id)),o={_jv:{type:"follow"},type:"user_follow",to_user_id:e.id};this.$store.dispatch("jv/post",o).then((function(t){0==t.is_mutual?(s.thread.user.follow=1,i.follow=1,s.followStatus=1):(s.thread.user.follow=2,i.follow=2,s.followStatus=2)}))},deleteFollow:function(t){var e=this,i=this.$store.getters["jv/get"]("users/".concat(t.id));this.$store.dispatch("jv/delete","follow/".concat(t.id,"/1")).then((function(){e.thread.user.follow=0,i.follow=0,e.followStatus=0})),s},moreClick:function(){this.$store.getters["session/get"]("isLogin")||(t.setStorage({key:"page",data:(0,d.getCurUrl)()}),this.mpLoginMode()),this.$refs.morePopup.open()},moreContent:function(e,s){this.moreCancel(),"0"===e.type?(this.$,t.redirectTo({url:"/topic/post?type=".concat(this.thread.type,"&operating=edit&threadId=").concat(this.thread._jv.id)})):"2"===e.type||"3"===e.type?this.threadOpera(this.threadId,e.canOpera,e.isStatus,e.type):"4"===e.type&&(this.$refs.deletePopup.open(),this.deleteType="4",this.deleteId=this.threadId,this.deletePostCanStatus=e.canOpera,this.deletePostIsStatus=e.status,this.deletePostType=e.type,this.deleteTip=this.i18n.t("core.deleteContentSure")),"report"===e.name&&this.reportClick(),"collection"===e.name&&this.threadCollectionClick(s._jv.id,s.canFavorite,s.isFavorite,"1"),"share"===e.name&&this.shareClick(),"poster"===e.name&&this.shareContent(0)},moreCancel:function(){this.$refs.morePopup.close()},reportClose:function(t){this.$refs.reportPopup.close()},reportClick:function(){this.moreCancel(),this.$refs.reportPopup.open()},buyGood:function(){6===this.thread.type&&this.copy(this.thread.firstPost.postGoods.detail_content)},copy:function(e){var s=this;(0,p.default)({content:e,success:function(e){t.showToast({title:s.thread.firstPost.postGoods.type_name+e,icon:"none"})},error:function(e){t.showToast({title:e,icon:"none",duration:3e3})}})}})};e.default=C}).call(this,i("543d")["default"])},"212b":function(t,e,s){"use strict";s.r(e);var i=s("097b"),o=s.n(i);for(var a in i)"default"!==a&&function(t){s.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},7612:function(t,e,s){"use strict";var i=s("f7cd"),o=s.n(i);o.a},"97b3":function(t,e,s){"use strict";s.d(e,"b",(function(){return o})),s.d(e,"c",(function(){return a})),s.d(e,"a",(function(){return i}));var i={quiPage:function(){return Promise.all([s.e("common/vendor"),s.e("components/qui-page/qui-page")]).then(s.bind(null,"2bf0"))},quiTopicContent:function(){return Promise.all([s.e("common/vendor"),s.e("components/qui-topic-content/qui-topic-content")]).then(s.bind(null,"ab17"))},quiIcon:function(){return s.e("components/qui-icon/qui-icon").then(s.bind(null,"5d1d"))},quiPersonList:function(){return s.e("components/qui-person-list/qui-person-list").then(s.bind(null,"36ba"))},quiBeAsk:function(){return s.e("components/qui-be-ask/qui-be-ask").then(s.bind(null,"affa"))},quiAnswer:function(){return Promise.all([s.e("common/vendor"),s.e("components/qui-answer/qui-answer")]).then(s.bind(null,"20ba"))},quiPaymentVisible:function(){return s.e("components/qui-payment-visible/qui-payment-visible").then(s.bind(null,"d391"))},quiDropDown:function(){return s.e("components/qui-drop-down/qui-drop-down").then(s.bind(null,"c2f5"))},quiTopicComment:function(){return Promise.all([s.e("common/vendor"),s.e("components/qui-topic-comment/qui-topic-comment")]).then(s.bind(null,"91b9"))},quiLoadMore:function(){return s.e("components/qui-load-more/qui-load-more").then(s.bind(null,"80d7"))},uniPopup:function(){return s.e("components/uni-popup/uni-popup").then(s.bind(null,"f1be"))},quiButton:function(){return s.e("components/qui-button/qui-button").then(s.bind(null,"a67c"))},quiReport:function(){return s.e("components/qui-report/qui-report").then(s.bind(null,"b9b9"))},quiPay:function(){return Promise.all([s.e("common/vendor"),s.e("components/qui-pay/qui-pay")]).then(s.bind(null,"1802"))},quiLoadingCover:function(){return s.e("components/qui-loading-cover/qui-loading-cover").then(s.bind(null,"8633"))},quiToast:function(){return s.e("components/qui-toast/qui-toast").then(s.bind(null,"6512"))},quiEmoji:function(){return s.e("components/qui-emoji/qui-emoji").then(s.bind(null,"aa0f"))},quiUploader:function(){return Promise.all([s.e("common/vendor"),s.e("components/qui-uploader/qui-uploader")]).then(s.bind(null,"7fe4"))},uLoading:function(){return s.e("components/u-loading/u-loading").then(s.bind(null,"663e"))},quiPageMessage:function(){return Promise.all([s.e("common/vendor"),s.e("components/qui-page-message/qui-page-message")]).then(s.bind(null,"f097"))}},o=function(){var t=this,e=t.$createElement,s=(t._self._c,t.loaded&&t.answerPay?t.handleGroup(t.thread.question.beUser.groups&&t.thread.question.beUser.groups):null),i=t.loaded?{contentdown:t.c.contentdown,contentrefresh:t.c.contentrefresh,contentnomore:t.contentnomoreVal}:null,o=t.loaded&&t.footerShow?t.detectionModel():null,a=t.loaded?t.i18n.t("discuzq.post.cancel"):null,n=t.loaded&&t.customAmountStatus?t.i18n.t("discuzq.close"):null,r=t.loaded&&t.customAmountStatus?t.i18n.t("discuzq.ok"):null,c=t.loaded&&t.payShowStatus?Number(t.user.walletBalance):null;t._isMounted||(t.e0=function(e){t.emojiShow=!t.emojiShow},t.e1=function(e){t.publishClickStatus&&t.publishClick()}),t.$mp.data=Object.assign({},{$root:{m0:s,a0:i,m1:o,g0:a,g1:n,g2:r,m2:c}})},a=[]},a066:function(t,e,s){"use strict";(function(t){s("3768");i(s("66fd"));var e=i(s("f732"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,s("543d")["createPage"])},f732:function(t,e,s){"use strict";s.r(e);var i=s("97b3"),o=s("212b");for(var a in o)"default"!==a&&function(t){s.d(e,t,(function(){return o[t]}))}(a);s("7612");var n,r=s("f0c5"),c=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"457adce6",null,!1,i["a"],n);e["default"]=c.exports},f7cd:function(t,e,s){}},[["a066","common/runtime","common/vendor"]]]);