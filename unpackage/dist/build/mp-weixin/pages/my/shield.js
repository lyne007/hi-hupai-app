(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/my/shield"],{"05ab":function(e,n,t){"use strict";t.r(n);var i=t("17f2"),u=t("25c4");for(var r in u)"default"!==r&&function(e){t.d(n,e,(function(){return u[e]}))}(r);t("6e67");var s,o=t("f0c5"),a=Object(o["a"])(u["default"],i["b"],i["c"],!1,null,"3e474a04",null,!1,i["a"],s);n["default"]=a.exports},"17f2":function(e,n,t){"use strict";t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return r})),t.d(n,"a",(function(){return i}));var i={quiPage:function(){return Promise.all([t.e("common/vendor"),t.e("components/qui-page/qui-page")]).then(t.bind(null,"2bf0"))},quiIcon:function(){return t.e("components/qui-icon/qui-icon").then(t.bind(null,"5d1d"))},quiAvatar:function(){return Promise.all([t.e("common/vendor"),t.e("components/qui-avatar/qui-avatar")]).then(t.bind(null,"ce3f"))},quiCellItem:function(){return t.e("components/qui-cell-item/qui-cell-item").then(t.bind(null,"bd3e"))},quiLoadMore:function(){return t.e("components/qui-load-more/qui-load-more").then(t.bind(null,"80d7"))},quiNoData:function(){return t.e("components/qui-no-data/qui-no-data").then(t.bind(null,"9e27"))},uniPopup:function(){return t.e("components/uni-popup/uni-popup").then(t.bind(null,"f1be"))}},u=function(){var e=this,n=e.$createElement,t=(e._self._c,e.i18n.t("profile.addshielduser")),i=e.i18n.t("search.searchusers"),u=e.searchValue?e.i18n.t("search.cancel"):null,r=!e.searchValue&&e.shieldTotal?e.__map(e.shieldList,(function(n,t){var i=e.__get_orig(n),u=e.unbundlingID(n.id),r=u?e.i18n.t("profile.shield"):null,s=u?null:e.i18n.t("profile.unbundling");return{$orig:i,m0:u,g3:r,g4:s}})):null,s=e.searchValue||0!=e.shieldTotal?null:e.i18n.t("profile.noshield"),o=e.i18n.t("profile.shield"),a=e.searchValue?e.__map(e.userList,(function(n,t){var i=e.__get_orig(n),u=e.handleGroups(n);return{$orig:i,m1:u}})):null,l=e.i18n.t("profile.shieldusersure");e.$mp.data=Object.assign({},{$root:{g0:t,g1:i,g2:u,l0:r,g5:s,g6:o,l1:a,g7:l}})},r=[]},"25c4":function(e,n,t){"use strict";t.r(n);var i=t("261a"),u=t.n(i);for(var r in i)"default"!==r&&function(e){t.d(n,e,(function(){return i[e]}))}(r);n["default"]=u.a},"261a":function(e,n,t){"use strict";(function(e){function i(e){return o(e)||s(e)||r(e)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,n){if(e){if("string"===typeof e)return a(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(e,n):void 0}}function s(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function o(e){if(Array.isArray(e))return a(e)}function a(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var l=function(){t.e("components/uni-popup/uni-popup-dialog").then(function(){return resolve(t("8b8a"))}.bind(null,t)).catch(t.oe)},c={components:{uniPopupDialog:l},data:function(){return{showSearchInput:!0,searchValue:"",uloadingType:"",userList:[],uPageNum:1,uPageSize:15,uid:0,sloadingType:"",shieldList:[],sPageNum:1,sPageSize:10,shieldTotal:null,unbundlingArry:[],unbundUserData:[],shieldType:"",isFocus:!1}},onLoad:function(){this.getShieldList(),this.getShieldData()},computed:{userId:function(){return this.$store.getters["session/get"]("userId")}},methods:{showSearch:function(){this.showSearchInput=!1,this.isFocus=!0},searchBlur:function(){this.isFocus=!1},searchInput:function(e){var n=this;this.searchValue=e.target.value,this.unbundlingArry=[],this.uTimeOut&&clearTimeout(this.uTimeOut),this.uTimeOut=setTimeout((function(){n.userList=[],n.uPageNum=1,n.getUserList(e.target.value)}),250)},cancelSearch:function(){this.searchValue="",this.uPageNum=1,this.getUserList("","clear"),this.sPageNum=1,this.shieldList=[],this.getShieldList(),this.isFocus=!1,this.showSearchInput=!0},getShieldData:function(){var e=this;this.$store.dispatch("jv/get","users/".concat(this.userId,"/deny")).then((function(n){n._jv&&delete n._jv,e.unbundUserData=[],e.unbundUserData.push(Number(e.userId)),n.forEach((function(t,i){e.unbundUserData.push(n[i].id)}))}))},getShieldList:function(){var e=this;this.sloadingType="loading";var n={"page[limit]":this.sPageSize,"page[number]":this.sPageNum};this.$store.dispatch("jv/get",["users/".concat(this.userId,"/deny"),{params:n}]).then((function(n){n._jv&&delete n._jv,e.shieldList=[].concat(i(e.shieldList),i(n)),e.shieldTotal=e.shieldList.length,e.sloadingType=n.length===e.sPageSize?"more":"nomore"}))},getUserList:function(e,n){var t=this;this.loadingType="loading";var u={include:"groups",sort:"createdAt","page[number]":this.uPageNum,"page[limit]":this.uPageSize,"filter[username]":"*".concat(e,"*")};this.$store.dispatch("jv/get",["users",{params:u}]).then((function(e){e._jv&&delete e._jv,e.forEach((function(n,t){e[t].groupName=n.groups[0]?n.groups[0].name:""})),t.uloadingType=e.length===t.uPageSize?"more":"nomore";var u=e.filter((function(e){return-1===t.unbundUserData.indexOf(e.id)}));t.userList=n&&"clear"===n?u:[].concat(i(t.userList),i(u))}))},shieldpullDown:function(){this.sPageNum+=1,this.getShieldList()},pullDownUsers:function(){"more"===this.uloadingType&&(this.uPageNum+=1,this.getUserList(this.searchValue))},shieldUser:function(e,n){this.uid=e,this.shieldType=n,this.$refs.popShield.open()},handleGroups:function(e){var n=[];return e.groups&&e.groups.length>0&&(n=e.groups.filter((function(e){return e.isDisplay}))),n.length>0?n[0].name:""},handleCancel:function(){this.$refs.popShield.close()},handleOk:function(){var e=this;this.$refs.popShield.close();var n={_jv:{type:"users/".concat(this.uid,"/deny")}};this.$store.dispatch("jv/post",n).then((function(){e.unbundlingID(e.uid)&&e.unbundlingArry.splice(e.unbundlingArry.findIndex((function(n){return n===e.uid})),1),e.shieldType&&"user"===e.shieldType?e.cancelSearch():(e.searchValue="",e.uPageNum=1,e.getUserList("","clear")),e.getShieldData()}))},unbundlingUser:function(n){var t=this;this.$store.dispatch("jv/delete","users/".concat(n,"/deny")).then((function(){t.unbundlingArry.push(n),e.showToast({icon:"none",title:t.i18n.t("profile.unboundsucceed")}),t.getShieldData()}))},unbundlingID:function(e){if(this.unbundlingArry&&this.unbundlingArry.includes(e))return!0}}};n.default=c}).call(this,t("543d")["default"])},"6e67":function(e,n,t){"use strict";var i=t("9fed"),u=t.n(i);u.a},"737a":function(e,n,t){"use strict";(function(e){t("3768");i(t("66fd"));var n=i(t("05ab"));function i(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},"9fed":function(e,n,t){}},[["737a","common/runtime","common/vendor"]]]);