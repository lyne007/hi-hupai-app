(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/modify/withdrawals"],{"0280":function(t,e,n){"use strict";var s=n("fcfe"),i=n.n(s);i.a},"0dca":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return s}));var s={quiPage:function(){return Promise.all([n.e("common/vendor"),n.e("components/qui-page/qui-page")]).then(n.bind(null,"2bf0"))},quiCellItem:function(){return n.e("components/qui-cell-item/qui-cell-item").then(n.bind(null,"bd3e"))},quiInputCode:function(){return n.e("components/qui-input-code/qui-input-code").then(n.bind(null,"554e"))},quiButton:function(){return n.e("components/qui-button/qui-button").then(n.bind(null,"a67c"))},uniPopup:function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"f1be"))},quiAuthPhone:function(){return Promise.all([n.e("common/vendor"),n.e("components/qui-auth-phone/qui-auth-phone")]).then(n.bind(null,"bc43"))}},i=function(){var t=this,e=t.$createElement,n=(t._self._c,t.wxpayMchpayClose?null:t.i18n.t("modify.collectionwechat")),s=t.wxpayMchpayClose?null:t.i18n.t("modify.withdrawalPhon"),i=t.wxpayMchpayClose?t.i18n.t("modify.payee"):null,a=t.i18n.t("modify.withdrawable"),o=t.i18n.t("modify.withdrawalamount"),c=t.i18n.t("modify.enteramount",{num:t.forums.set_cash.cash_min_sum?t.forums.set_cash.cash_min_sum:1}),u=t.i18n.t("modify.actualamout"),r=t.i18n.t("modify.servicechaege"),h=t.i18n.t("modify.percentage"),l=t.i18n.t("modify.percentagcon"),d=t.phon?t.i18n.t("modify.phonnumber"):null,f=t.phon&&!t.user.mobile?t.i18n.t("modify.nohasphon"):null,m=t.phon&&t.sun?t.i18n.t("modify.sendverificode"):null,p=t.phon&&!t.sun?t.i18n.t("modify.retransmission"):null,y=t.i18n.t("modify.placeentercode"),v=t.wxpayMchpayClose?null:t.i18n.t("modify.withdrawalTitle"),_=t.i18n.t("modify.submission");t.$mp.data=Object.assign({},{$root:{g0:n,g1:s,g2:i,g3:a,g4:o,g5:c,g6:u,g7:r,g8:h,g9:l,g10:d,g11:f,g12:m,g13:p,g14:y,g15:v,g16:_}})},a=[]},"89d7":function(t,e,n){"use strict";(function(t){n("3768");s(n("66fd"));var e=s(n("9f83"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},"9f83":function(t,e,n){"use strict";n.r(e);var s=n("0dca"),i=n("d3cd");for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n("0280");var o,c=n("f0c5"),u=Object(c["a"])(i["default"],s["b"],s["c"],!1,null,"6c033580",null,!1,s["a"],o);e["default"]=u.exports},d1fd:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n("db65"),i=a(n("8605"));function a(t){return t&&t.__esModule?t:{default:t}}var o={mixins:[i.default],data:function(){return{userid:"",second:60,num:5,cashmany:"",name:"",balance:"",userphon:"",usertestphon:"",code:"",test:"",test2:"",judge:!1,sun:!0,phon:!0,length:!1,contint:"",procedures:0,inshow:!1,inisIphone:!1,casherrotest:"",casherro:!1,disabtype:!1,percentage:0,cost:0,interval:"",captcha:null,ticket:"",randstr:"",captchaResult:{},withdrawalPhon:"",withdrawalNumber:"",cashType:0,wxpayMchpayClose:!0,forbiddenSpots:!0}},onLoad:function(){var e=this;console.log(this.forums),this.userid=this.usersid,this.setmydata(),this.wxpayMchpayClose=this.forums.paycenter.wxpay_mchpay_close,this.$nextTick((function(){e.cost=e.forums.set_cash.cash_rate;var t=100*e.forums.set_cash.cash_rate;e.percentage=t})),this.$u.event.$on("captchaResult",(function(t){e.ticket=t.ticket,e.randstr=t.randstr,e.btnButton()})),this.$u.event.$on("closeChaReault",(function(){t.hideLoading()})),this.forums.paycenter.wxpay_mchpay_close?this.cashType=1:this.cashType=0},computed:{forum:function(){return this.$store.getters["jv/get"]("forums/1")},usersid:function(){return this.$store.getters["session/get"]("userId")},user:function(){var t=this.$store.getters["jv/get"]("users/".concat(this.usersid));return t}},watch:{forum:function(t){if(t){this.cost=this.forum.set_cash.cash_rate;var e=100*this.forum.set_cash.cash_rate;this.percentage=e,this.wxpayMchpayClose=this.forum.paycenter.wxpay_mchpay_close,this.forum.paycenter.wxpay_mchpay_close?this.cashType=1:this.cashType=0}},deep:!0},methods:{fourse:function(){this.inshow=!0},btndata:function(t){this.code=t},btncash:function(){this.forums.paycenter.wxpay_mchpay_close?/^1(3|4|5|6|7|8|9)\d{9}$/.test(this.withdrawalPhon)?this.verifytitle():t.showToast({icon:"none",title:this.i18n.t("modify.changesphon"),duration:2e3}):this.verifytitle()},settlement:function(){var e=this;setTimeout((function(){if("."===e.cashmany[0]){var n=0,s=".";e.cashmany=n+s}if(e.cashmany=e.cashmany.replace(/[^\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(-)*(\d+)\.(\d\d).*$/,"$1$2.$3").replace(/^\./g,""),e.cashmany.length>=1&&e.forums&&e.forums.set_cash.cash_min_sum&&(Number(e.cashmany)<e.forums.set_cash.cash_min_sum?e.forbiddenSpots=!1:e.forbiddenSpots=!0),Number(e.cashmany)>Number(e.balance)&&(e.cashmany=e.cashmany.slice(0,e.cashmany.length-1),t.showToast({icon:"none",title:e.i18n.t("modify.greaterthan"),duration:2e3})),e.cashmany.length>0){e.length=!0;var i=e.cashmany-e.cashmany*e.cost;if(i){e.contint="¥".concat(i.toFixed(2));var a=e.cashmany*e.cost;e.procedures=a.toFixed(2)}else e.contint="",e.procedures=""}else if(e.cashmany.length<=0){e.contint="";var o=e.cashmany*e.cost;e.procedures=o.toFixed(2)}}),5)},loseFocus:function(){this.cashmany.length>=1&&this.forums.set_cash.cash_min_sum&&Number(this.cashmany)<this.forums.set_cash.cash_min_sum&&(this.cashmany="",this.settlement(),t.showToast({icon:"none",title:this.i18n.t("modify.enteramount",{num:this.forums.set_cash.cash_min_sum?this.forums.set_cash.cash_min_sum:1}),duration:2e3}))},setphonnumber:function(){var t=this;setTimeout((function(){t.withdrawalPhon=t.withdrawalPhon.replace(/[^\d]/g,"")}),30)},btnButton:function(){var e=this;if(!1===this.forums.qcloud.qcloud_sms)t.showToast({icon:"none",title:this.i18n.t("modify.NoteOpen"),duration:2e3});else{if(!this.user.mobile)return void t.showToast({icon:"none",title:this.i18n.t("modify.nohasphon"),duration:2e3});this.posttitle(),clearInterval(this.interval),this.sun=!1,this.interval=setInterval((function(){e.second-=1}),1e3),setTimeout((function(){clearInterval(e.interval),e.sun=!0,e.second=60}),6e4)}},setmydata:function(){var t=this,e={_jv:{type:"users",id:this.userid},include:["groups","wechat"]};this.$store.dispatch("jv/get",e).then((function(e){t.name=e.username,t.balance=e.walletBalance,t.usertestphon=e.mobile,t.userphon=e.originalMobile,t.withdrawalPhon=e.originalMobile,t.usertestphon||(t.disabtype=!0)}))},sendsms:function(){if(this.forums.qcloud.qcloud_captcha){if(!this.ticket||!this.randstr)return this.verification(),!1}else this.second=60,this.btnButton()},verification:function(){wx.navigateToMiniProgram({appId:"wx5a3a7366fd07e119",path:"/pages/captcha/index",envVersion:"release",extraData:{appId:this.forums.qcloud.qcloud_captcha_app_id},success:function(){console.log("验证码成功打开")},fail:function(){t.hideLoading()}})},posttitle:function(){var t=this,e={_jv:{type:"sms/send"},mobile:this.user.mobile,type:"verify",captcha_ticket:this.ticket,captcha_rand_str:this.randstr},n=s.status.run((function(){return t.$store.dispatch("jv/post",e)}));n.then((function(e){t.num-=1,t.second=e._jv.json.data.attributes.interval,t.ticket="",t.randstr=""}))},verifytitle:function(){var e=this,n={_jv:{type:"sms/verify"},code:this.code,type:"verify"};this.$store.dispatch("jv/post",n).then((function(t){t&&e.cashwithdrawal()})).catch((function(n){500===n.statusCode?(e.test=e.i18n.t("modify.validionerro")+e.num+e.i18n.t("modify.frequency"),e.judge=!0,e.empty(),e.num<=0&&(e.test=e.i18n.t("modify.lateron"))):422===n.statusCode&&(t.showToast({icon:e.icon,title:n.data.errors[0].detail,duration:2e3}),e.empty())}))},cashwithdrawal:function(){var e=this,n={};0===this.cashType?(this.withdrawalNumber=this.withdrawalPhon,n={_jv:{type:"wallet/cash",include:["user","userWallet"]},cash_apply_amount:this.cashmany,cash_type:this.cashType,cash_mobile:this.withdrawalPhon}):n={_jv:{type:"wallet/cash",include:["user","userWallet"]},cash_apply_amount:this.cashmany,cash_type:this.cashType};var i=s.status.run((function(){return e.$store.dispatch("jv/post",n)}));i.then((function(n){n&&(e.cashmany="",e.contint="",e.procedures=0,e.setmydata(),e.sun=!0,e.second=60,clearInterval(e.interval),t.showToast({title:e.i18n.t("modify.withdrawal"),duration:2e3}),setTimeout((function(){t.navigateBack({success:function(){var t=getCurrentPages();t[1].onLoad()}})}),1500))})).catch((function(n){422===n.statusCode?(t.showToast({icon:"none",title:n.data.errors[0].detail[0],duration:2e3}),e.empty()):500===n.statusCode&&(t.showToast({icon:"none",title:n.data.errors[0].detail,duration:2e3}),e.empty())}))},bandPhon:function(){this.user&&""===this.user.mobile&&this.$refs.authPhone.open()},toggleBox:function(){this.inshow=!1},empty:function(){var t=this.$refs.quiinput;t.deleat()},closeDialog:function(){this.$refs.authPhone.close()}},onUnload:function(){this.$u.event.$off("captchaResult"),this.$u.event.$off("closeChaReault"),this.captcha&&this.captcha.destroy()}};e.default=o}).call(this,n("543d")["default"])},d3cd:function(t,e,n){"use strict";n.r(e);var s=n("d1fd"),i=n.n(s);for(var a in s)"default"!==a&&function(t){n.d(e,t,(function(){return s[t]}))}(a);e["default"]=i.a},fcfe:function(t,e,n){}},[["89d7","common/runtime","common/vendor"]]]);