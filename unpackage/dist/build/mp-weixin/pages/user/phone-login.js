(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/phone-login"],{"44d5":function(t,e,i){"use strict";i.r(e);var n=i("e38e"),o=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e["default"]=o.a},acfa:function(t,e,i){"use strict";(function(t){i("3768");n(i("66fd"));var e=n(i("de3a"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},c9e5:function(t,e,i){"use strict";var n=i("cf0a"),o=i.n(n);o.a},cf0a:function(t,e,i){},de3a:function(t,e,i){"use strict";i.r(e);var n=i("df57"),o=i("44d5");for(var s in o)"default"!==s&&function(t){i.d(e,t,(function(){return o[t]}))}(s);i("c9e5");var a,r=i("f0c5"),u=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"1578df8c",null,!1,n["a"],a);e["default"]=u.exports},df57:function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){return n}));var n={quiPage:function(){return Promise.all([i.e("common/vendor"),i.e("components/qui-page/qui-page")]).then(i.bind(null,"2bf0"))},quiInputCode:function(){return i.e("components/qui-input-code/qui-input-code").then(i.bind(null,"554e"))},quiRegistrationAgreement:function(){return i.e("components/qui-registration-agreement/qui-registration-agreement").then(i.bind(null,"e80a"))}},o=function(){var t=this,e=t.$createElement,i=(t._self._c,t.i18n.t("user.phoneNumberLogin")),n=t.i18n.t("user.phoneNumber"),o=t.i18n.t("modify.placeentercode"),s=t.i18n.t("user.login"),a=t.forum&&t.forum.passport&&t.forum.passport.miniprogram_close||t.forum&&t.forum.ucenter&&t.forum.ucenter.ucenter&&t.isShow?t.i18n.t("user.otherLoginMode"):null,r=t.forum&&t.forum.qcloud&&t.forum.qcloud.qcloud_sms?t.i18n.t("user.forgetPassword"):null;t.$mp.data=Object.assign({},{$root:{g0:i,g1:n,g2:o,g3:s,g4:a,g5:r}})},s=[]},e38e:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(i("245a")),o=a(i("412c")),s=i("0301");function a(t){return t&&t.__esModule?t:{default:t}}var r={mixins:[n.default,o.default],data:function(){return{tit:!1,test:"",inshow:!1,inisIphone:!1,formeerro:"",btnContent:this.i18n.t("modify.sendverificode"),time:0,timer:"",disabled:!0,phoneNumber:"",verificationCode:"",isPaid:!1,captcha:null,captcha_ticket:"",captcha_rand_str:"",captchaResult:{},forum:{},isShow:!1}},onLoad:function(){var e=this;this.getForum(),this.$u.event.$on("captchaResult",(function(t){e.ticket=t.ticket,e.randstr=t.randstr,e.time=60,e.countdown(),e.sendSMS()})),this.$u.event.$on("closeChaReault",(function(){t.hideLoading()}))},onUnload:function(){this.$u.event.$off("captchaResult"),this.$u.event.$off("closeChaReault"),this.captcha&&this.captcha.destroy()},methods:{changeinput:function(){var t=this;setTimeout((function(){t.phoneNumber=t.phoneNumber.replace(/[^\d]/g,"")}),30),11===this.phoneNumber.length?this.disabled=!1:this.disabled=!0},fourse:function(){this.inshow=!0},btndata:function(t){this.verificationCode=t},sendVerificationCode:function(){if(this.forum&&this.forum.qcloud&&this.forum.qcloud.qcloud_captcha){if(!this.ticket||!this.randstr)return this.toTCaptcha(),!1}else this.time=60,this.countdown(),this.sendSMS()},toTCaptcha:function(){wx.navigateToMiniProgram({appId:"wx5a3a7366fd07e119",path:"/pages/captcha/index",envVersion:"release",extraData:{appId:this.forum.qcloud.qcloud_captcha_app_id},success:function(){console.log("验证码成功打开")},fail:function(){t.hideLoading()}})},countdown:function(){this.time>1?(this.time-=1,this.btnContent="".concat(this.time).concat(this.i18n.t("modify.retransmission")),this.disabled=!0,this.timer=setTimeout(this.countdown,1e3),this.isGray=!0):1===this.time&&(this.btnContent=this.i18n.t("modify.sendverificode"),clearTimeout(this.timer),this.disabled=!1,this.isGray=!1)},sendSMS:function(){var t=this,e={_jv:{type:"sms/send"},mobile:this.phoneNumber,type:"login",captcha_ticket:this.ticket,captcha_rand_str:this.randstr};this.$store.dispatch("jv/post",e).then((function(e){e&&(t.ticket="",t.randstr="")})).catch((function(t){console.log(t)}))},login:function(){""===this.phoneNumber?t.showToast({icon:"none",title:this.i18n.t("user.phonenumberEmpty"),duration:2e3}):""===this.verificationCode?t.showToast({icon:"none",title:this.i18n.t("user.verificationCodeEmpty"),duration:2e3}):(this.$store.dispatch("session/setPhone",this.phoneNumber),this.verifyPhoneNumber())},verifyPhoneNumber:function(){var e=this,i={data:{attributes:{mobile:this.phoneNumber,code:this.verificationCode,type:"login",register:0}}};this.$store.dispatch("session/verificationCodeh5Login",i).then((function(i){if(i&&i.access_token&&(e.logind(),e.forum&&e.forum.set_site&&e.forum.set_site.site_mode!==s.SITE_PAY&&t.getStorage({key:"page",success:function(e){t.redirectTo({url:e.data})}}),e.forum&&e.forum.set_site&&e.forum.set_site.site_mode===s.SITE_PAY&&e.user&&!e.user.paid&&t.redirectTo({url:"/pages/site/info"}),t.showToast({title:e.i18n.t("user.loginSuccess"),duration:2e3})),i&&i.data&&i.data.errors){if("401"===i.data.errors[0].status||"402"===i.data.errors[0].status||"500"===i.data.errors[0].status){var n=e.i18n.t("core.".concat(i.data.errors[0].code));t.showToast({icon:"none",title:n,duration:2e3})}if("403"===i.data.errors[0].status||"422"===i.data.errors[0].status){var o=e.i18n.t(i.data.errors[0].detail[0]);t.showToast({icon:"none",title:o,duration:2e3})}}})).catch((function(t){console.log(t)}))},toggleBox:function(){this.inshow=!1},jump2WechatLogin:function(){this.mpLogin()},jump2Login:function(){this.jump2LoginPage()},jump2UcLogin:function(){t.navigateTo({url:"/pages/user/uc-login"})},jump2findpwd:function(){this.jump2findpwdPage()}}};e.default=r}).call(this,i("543d")["default"])}},[["acfa","common/runtime","common/vendor"]]]);